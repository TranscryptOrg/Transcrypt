/*
 Fabric.js Copyright 2008-2015, Printio (Juriy Zaytsev, Maxim Chernyak) */
'use strict';var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(p,w,v){p!=Array.prototype&&p!=Object.prototype&&(p[w]=v.value)};$jscomp.getGlobal=function(p){return"undefined"!=typeof window&&window===p?p:"undefined"!=typeof global&&null!=global?global:p};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(p){return $jscomp.SYMBOL_PREFIX+(p||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var p=$jscomp.global.Symbol.iterator;p||(p=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[p]&&$jscomp.defineProperty(Array.prototype,p,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(p){var w=0;return $jscomp.iteratorPrototype(function(){return w<p.length?{done:!1,value:p[w++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(p){$jscomp.initSymbolIterator();p={next:p};p[$jscomp.global.Symbol.iterator]=function(){return this};return p};$jscomp.makeIterator=function(p){$jscomp.initSymbolIterator();$jscomp.initSymbol();$jscomp.initSymbolIterator();var w=p[Symbol.iterator];return w?w.call(p):$jscomp.arrayIterator(p)};$jscomp.arrayFromIterator=function(p){for(var w,v=[];!(w=p.next()).done;)v.push(w.value);return v};$jscomp.arrayFromIterable=function(p){return p instanceof Array?p:$jscomp.arrayFromIterator($jscomp.makeIterator(p))};
$jscomp.polyfill=function(p,w,v,x){if(w){v=$jscomp.global;p=p.split(".");for(x=0;x<p.length-1;x++){var J=p[x];J in v||(v[J]={});v=v[J]}p=p[p.length-1];x=v[p];w=w(x);w!=x&&null!=w&&$jscomp.defineProperty(v,p,{configurable:!0,writable:!0,value:w})}};$jscomp.polyfill("Object.getOwnPropertySymbols",function(p){return p?p:function(){return[]}},"es6","es5");
$jscomp.checkStringArgs=function(p,w,v){if(null==p)throw new TypeError("The 'this' value for String.prototype."+v+" must not be null or undefined");if(w instanceof RegExp)throw new TypeError("First argument to String.prototype."+v+" must not be a regular expression");return p+""};
$jscomp.polyfill("String.prototype.startsWith",function(p){return p?p:function(p,v){var w=$jscomp.checkStringArgs(this,p,"startsWith");p+="";var J=w.length,K=p.length;v=Math.max(0,Math.min(v|0,w.length));for(var C=0;C<K&&v<J;)if(w[v++]!=p[C++])return!1;return C>=K}},"es6","es3");
$jscomp.polyfill("Array.from",function(p){return p?p:function(p,v,x){$jscomp.initSymbolIterator();v=null!=v?v:function(p){return p};var w=[],K=p[Symbol.iterator];if("function"==typeof K)for(p=K.call(p);!(K=p.next()).done;)w.push(v.call(x,K.value));else{K=p.length;for(var C=0;C<K;C++)w.push(v.call(x,p[C]))}return w}},"es6","es3");
$jscomp.iteratorFromArray=function(p,w){$jscomp.initSymbolIterator();p instanceof String&&(p+="");var v=0,x={next:function(){if(v<p.length){var J=v++;return{value:w(J,p[J]),done:!1}}x.next=function(){return{done:!0,value:void 0}};return x.next()}};x[Symbol.iterator]=function(){return x};return x};$jscomp.polyfill("Array.prototype.keys",function(p){return p?p:function(){return $jscomp.iteratorFromArray(this,function(p){return p})}},"es6","es3");
$jscomp.polyfill("String.prototype.repeat",function(p){return p?p:function(p){var v=$jscomp.checkStringArgs(this,null,"repeat");if(0>p||1342177279<p)throw new RangeError("Invalid count value");p|=0;for(var w="";p;)if(p&1&&(w+=v),p>>>=1)v+=v;return w}},"es6","es3");
$jscomp.polyfill("Array.prototype.fill",function(p){return p?p:function(p,v,x){var w=this.length||0;0>v&&(v=Math.max(0,w+v));if(null==x||x>w)x=w;x=Number(x);0>x&&(x=Math.max(0,w+x));for(v=Number(v||0);v<x;v++)this[v]=p;return this}},"es6","es3");
function pong(){function p(b){return void 0===b||null===b?!1:0<=["boolean","number"].indexOf(typeof b)?b:b.__bool__ instanceof Function?b.__bool__()?b:!1:b.__len__ instanceof Function?0!==b.__len__()?b:!1:b instanceof Function?b:0!==N(b)?b:!1}function w(b){this.iterable=b;this.index=0}function v(b){this.iterable=b;this.index=0}function x(b,a,l){void 0==a&&(a=b,b=0);void 0==l&&(l=1);if(0<l&&b>=a||0>l&&b<=a)return[];for(var m=[];0<l?b<a:b>a;b+=l)m.push(b);return m}function J(b){if(null==b||"object"==
typeof b)return b;var a={},l;for(l in obj)b.hasOwnProperty(l)&&(a[l]=b[l]);return a}function K(b){if(null==b||"object"==typeof b)return b;var a={},l;for(l in obj)b.hasOwnProperty(l)&&(a[l]=K(b[l]));return a}function C(b){return b?Array.from(b):[]}function B(b){b=b?[].slice.apply(b):[];b.__class__=B;return b}function M(b){var a=[];if(b)for(var l=0;l<b.length;l++)a.add(b[l]);a.__class__=M;return a}function ea(b,a){if(void 0==b)return new Uint8Array(0);a=R(b);if(a==V)return new Uint8Array(b);if(a==L){a=
new Uint8Array(N(b));for(var l=0;l<N(b);l++)a[l]=b.charCodeAt(l);return a}if(a==C||a==B)return new Uint8Array(b);throw ha;}function L(b){try{return b.__str__()}catch(a){try{return W(b)}catch(l){return String(b)}}}function ia(){var b=[],a;for(a in this)S(a)||b.push(a);return b}function ja(){var b=[],a;for(a in this)S(a)||b.push([a,this[a]]);return b}function ka(b){delete this[b]}function la(){for(var b in this)delete this[b]}function ma(b,a){var l=this[b];void 0==l&&(l=this["py_"+b]);return void 0==
l?void 0==a?null:a:l}function na(b,a){var l=this[b];if(void 0!=l)return l;a=void 0==a?null:a;return this[b]=a}function oa(b,a){var l=this[b];if(void 0!=l)return delete this[b],l;if(void 0===a)throw fa(b,Error());return a}function pa(){var b=Object.keys(this)[0];if(null==b)throw fa("popitem(): dictionary is empty",Error());var a=B([b,this[b]]);delete this[b];return a}function qa(b){for(var a in b)this[a]=b[a]}function ra(){var b=[],a;for(a in this)S(a)||b.push(this[a]);return b}function sa(b){return this[b]}
function ta(b,a){this[b]=a}function E(b){var a={};if(!b||b instanceof Array){if(b)for(var l=0;l<b.length;l++){var m=b[l];if(!(m instanceof Array)||2!=m.length)throw Y("dict update sequence element #"+l+" has length "+m.length+"; 2 is required",Error());var r=m[0];m=m[1];!(b instanceof Array)&&b instanceof Object&&(Z(b,E)||(m=E(m)));a[r]=m}}else if(Z(b,E))for(m=b.py_keys(),l=0;l<m.length;l++)r=m[l],a[r]=b[r];else if(b instanceof Object)a=b;else throw Y("Invalid type of object for dict creation",Error());
F(a,"__class__",{value:E,enumerable:!1,writable:!0});F(a,"py_keys",{value:ia,enumerable:!1});F(a,"__iter__",{value:function(){new w(this.py_keys())},enumerable:!1});$jscomp.initSymbol();$jscomp.initSymbolIterator();F(a,Symbol.iterator,{value:function(){new v(this.py_keys())},enumerable:!1});F(a,"py_items",{value:ja,enumerable:!1});F(a,"py_del",{value:ka,enumerable:!1});F(a,"py_clear",{value:la,enumerable:!1});F(a,"py_get",{value:ma,enumerable:!1});F(a,"py_setdefault",{value:na,enumerable:!1});F(a,
"py_pop",{value:oa,enumerable:!1});F(a,"py_popitem",{value:pa,enumerable:!1});F(a,"py_update",{value:qa,enumerable:!1});F(a,"py_values",{value:ra,enumerable:!1});F(a,"__getitem__",{value:sa,enumerable:!1});F(a,"__setitem__",{value:ta,enumerable:!1});return a}var n={},T=function(b,a,l){if(""!=a){a=a.split(".");for(var m=a.length,r=0;r<a.length;r++){if(!b.hasOwnProperty(a[r])){m=r;break}b=b[a[r]]}for(r=m;r<a.length;r++)b[a[r]]={},b=b[a[r]]}for(var h in l)b[h]=l[h]};n.__nest__=T;var aa=function(b){b.__inited__||
(b.__all__.__init__(b.__all__),b.__inited__=!0);return b.__all__};n.__init__=aa;var t=function(b,a,l){return b&&(b.hasOwnProperty("__class__")||"string"==typeof b||b instanceof String)?(l&&Object.defineProperty(b,l,{value:function(){var m=[].slice.apply(arguments);return a.apply(null,[b].concat(m))},writable:!0,enumerable:!0,configurable:!0}),function(){var m=[].slice.apply(arguments);return a.apply(null,[b].concat(m))}):a};n.__get__=t;n.__getcm__=function(b,a,l){return b.hasOwnProperty("__class__")?
function(){var m=[].slice.apply(arguments);return a.apply(null,[b.__class__].concat(m))}:function(){var m=[].slice.apply(arguments);return a.apply(null,[b].concat(m))}};n.__getsm__=function(b,a,l){return a};var O={__name__:"type",__bases__:[],__new__:function(b,a,l,m){for(var r,h,k=function(){var d=[].slice.apply(arguments);return k.__new__(d)},g=l.length-1;0<=g;g--){var c=l[g],e;for(e in c)r=Object.getOwnPropertyDescriptor(c,e),Object.defineProperty(k,e,r);var f=$jscomp.makeIterator(Object.getOwnPropertySymbols(c));
for(r=f.next();!r.done;r=f.next())h=r.value,r=Object.getOwnPropertyDescriptor(c,h),Object.defineProperty(k,h,r)}k.__metaclass__=b;k.__name__=a.startsWith("py_")?a.slice(3):a;k.__bases__=l;for(e in m)r=Object.getOwnPropertyDescriptor(m,e),Object.defineProperty(k,e,r);b=$jscomp.makeIterator(Object.getOwnPropertySymbols(m));for(r=b.next();!r.done;r=b.next())h=r.value,r=Object.getOwnPropertyDescriptor(m,h),Object.defineProperty(k,h,r);return k}};O.__metaclass__=O;n.py_metatype=O;var P={__init__:function(b){},
__metaclass__:O,__name__:"object",__bases__:[],__new__:function(b){var a=Object.create(this,{__class__:{value:this,enumerable:!0}});if("__getattr__"in this||"__setattr__"in this)a=new Proxy(a,{get:function(b,a){var m=b[a];return void 0==m?b.__getattr__(a):m},set:function(b,a,r){try{b.__setattr__(a,r)}catch(h){b[a]=r}return!0}});this.__init__.apply(null,[a].concat(b));return a}};n.object=P;var A=function(b,a,l,m){void 0==m&&(m=a[0].__metaclass__);return m.__new__(m,b,a,l)};n.__class__=A;n.__pragma__=
function(){};T(n,"org.transcrypt.__base__",{__all__:{__inited__:!1,__init__:function(b){var a=A("__Envir__",[P],{__module__:"org.transcrypt.__base__",get __init__(){return t(this,function(b){b.interpreter_name="python";b.transpiler_name="transcrypt";b.transpiler_version="3.6.85";b.target_subdir="__javascript__"})}}),l=a();b.__Envir__=a;b.__envir__=l;b.__name__="org.transcrypt.__base__"}}});T(n,"org.transcrypt.__standard__",{__all__:{__inited__:!1,__init__:function(b){var a=A("Exception",[P],{__module__:"org.transcrypt.__standard__",
get __init__(){return t(this,function(d){var f=E();if(arguments.length){var c=arguments.length-1;if(arguments[c]&&arguments[c].hasOwnProperty("__kwargtrans__")){var e=arguments[c--],b;for(b in e)switch(b){case "self":d=e[b];break;default:f[b]=e[b]}delete f.__kwargtrans__}c=B([].slice.apply(arguments).slice(1,c+1))}else c=B();d.__args__=c;try{d.stack=f.error.stack}catch(ya){d.stack="No stack trace available"}})},get __repr__(){return t(this,function(d){return N(d.__args__)?"{}{}".format(d.__class__.__name__,
W(B(d.__args__))):"{}()".format(d.__class__.__name__)})},get __str__(){return t(this,function(d){return 1<N(d.__args__)?L(B(d.__args__)):N(d.__args__)?L(d.__args__[0]):""})}}),l=A("IterableError",[a],{__module__:"org.transcrypt.__standard__",get __init__(){return t(this,function(d,f){a.__init__(d,"Can't iterate over non-iterable",I({error:f}))})}}),m=A("StopIteration",[a],{__module__:"org.transcrypt.__standard__",get __init__(){return t(this,function(d,f){a.__init__(d,"Iterator exhausted",I({error:f}))})}}),
r=A("ValueError",[a],{__module__:"org.transcrypt.__standard__",get __init__(){return t(this,function(d,f,c){a.__init__(d,f,I({error:c}))})}}),h=A("KeyError",[a],{__module__:"org.transcrypt.__standard__",get __init__(){return t(this,function(d,f,c){a.__init__(d,f,I({error:c}))})}}),k=A("AssertionError",[a],{__module__:"org.transcrypt.__standard__",get __init__(){return t(this,function(d,f,c){f?a.__init__(d,f,I({error:c})):a.__init__(d,I({error:c}))})}}),g=A("NotImplementedError",[a],{__module__:"org.transcrypt.__standard__",
get __init__(){return t(this,function(d,f,c){a.__init__(d,f,I({error:c}))})}}),c=A("IndexError",[a],{__module__:"org.transcrypt.__standard__",get __init__(){return t(this,function(d,f,c){a.__init__(d,f,I({error:c}))})}}),e=A("AttributeError",[a],{__module__:"org.transcrypt.__standard__",get __init__(){return t(this,function(d,f,c){a.__init__(d,f,I({error:c}))})}}),f=A("py_TypeError",[a],{__module__:"org.transcrypt.__standard__",get __init__(){return t(this,function(d,f,c){a.__init__(d,f,I({error:c}))})}}),
d=A("Warning",[a],{__module__:"org.transcrypt.__standard__"}),q=A("UserWarning",[d],{__module__:"org.transcrypt.__standard__"}),u=A("DeprecationWarning",[d],{__module__:"org.transcrypt.__standard__"}),y=A("RuntimeWarning",[d],{__module__:"org.transcrypt.__standard__"}),D=function(d,f,c){if("undefined"==typeof f||null!=f&&f.hasOwnProperty("__kwargtrans__"))f=null;if("undefined"==typeof c||null!=c&&c.hasOwnProperty("__kwargtrans__"))c=!1;if(arguments.length){var e=arguments.length-1;if(arguments[e]&&
arguments[e].hasOwnProperty("__kwargtrans__")){e=arguments[e--];for(var b in e)switch(b){case "iterable":d=e[b];break;case "key":f=e[b];break;case "reverse":c=e[b]}}}f?d.sort(function(d,c){if(arguments.length){var e=arguments.length-1;if(arguments[e]&&arguments[e].hasOwnProperty("__kwargtrans__")){e=arguments[e--];for(var b in e)switch(b){case "a":d=e[b];break;case "b":c=e[b]}}}return f(d)>f(c)?1:-1}):d.sort();c&&d.reverse()},z=A("__Terminal__",[P],{__module__:"org.transcrypt.__standard__",get __init__(){return t(this,
function(d){d.buffer="";try{d.element=document.getElementById("__terminal__")}catch(ba){d.element=null}d.element&&(d.element.style.overflowX="auto",d.element.style.boxSizing="border-box",d.element.style.padding="5px",d.element.innerHTML="_")})},get print(){return t(this,function(d){var f=" ";var c="\n";if(arguments.length){var e=arguments.length-1;if(arguments[e]&&arguments[e].hasOwnProperty("__kwargtrans__")){var b=arguments[e--],g;for(g in b)switch(g){case "self":d=b[g];break;case "sep":f=b[g];
break;case "end":c=b[g]}}var h=B([].slice.apply(arguments).slice(1,e+1))}else h=B();d.buffer="{}{}{}".format(d.buffer,f.join(function(){for(var d=[],f=$jscomp.makeIterator(h),c=f.next();!c.done;c=f.next())d.append(L(c.value));return d}()),c).__getslice__(-4096,null,1);d.element?(d.element.innerHTML=d.buffer.py_replace("\n","<br>").py_replace(" ","&nbsp"),d.element.scrollTop=d.element.scrollHeight):console.log(f.join(function(){for(var d=[],f=$jscomp.makeIterator(h),c=f.next();!c.done;c=f.next())d.append(L(c.value));
return d}()))})},get input(){return t(this,function(d,f){if(arguments.length){var c=arguments.length-1;if(arguments[c]&&arguments[c].hasOwnProperty("__kwargtrans__")){c=arguments[c--];for(var e in c)switch(e){case "self":d=c[e];break;case "question":f=c[e]}}}d.print("{}".format(f),I({end:""}));e=window.prompt("\n".join(d.buffer.py_split("\n").__getslice__(-16,null,1)));d.print(e);return e})}}),G=z();b.AssertionError=k;b.AttributeError=e;b.DeprecationWarning=u;b.Exception=a;b.IndexError=c;b.IterableError=
l;b.KeyError=h;b.NotImplementedError=g;b.RuntimeWarning=y;b.StopIteration=m;b.py_TypeError=f;b.UserWarning=q;b.ValueError=r;b.Warning=d;b.__Terminal__=z;b.__name__="org.transcrypt.__standard__";b.__sort__=D;b.__terminal__=G;b.filter=function(d,f){null==d&&(d=Q);var c=[];f=$jscomp.makeIterator(f);for(var e=f.next();!e.done;e=f.next())e=e.value,d(e)&&c.append(e);return c};b.map=function(d,f){var c=[];f=$jscomp.makeIterator(f);for(var e=f.next();!e.done;e=f.next())c.append(d(e.value));return c};b.sorted=
function(d,f,c){if("undefined"==typeof f||null!=f&&f.hasOwnProperty("__kwargtrans__"))f=null;if("undefined"==typeof c||null!=c&&c.hasOwnProperty("__kwargtrans__"))c=!1;if(arguments.length){var e=arguments.length-1;if(arguments[e]&&arguments[e].hasOwnProperty("__kwargtrans__"))for(b in e=arguments[e--],e)switch(b){case "iterable":d=e[b];break;case "key":f=e[b];break;case "reverse":c=e[b]}}var b=R(d)==E?J(d.py_keys()):J(d);D(b,f,c);return b}}}});n.__call__=function(){var b=[].slice.apply(arguments);
return"object"==typeof b[0]&&"__call__"in b[0]?b[0].__call__.apply(b[1],b.slice(2)):b[0].apply(b[1],b.slice(2))};T(n,"",aa(n.org.transcrypt.__base__));O=n.__envir__;T(n,"",aa(n.org.transcrypt.__standard__));var ua=n.Exception,va=n.StopIteration,Y=n.ValueError,fa=n.KeyError,wa=n.AssertionError,ha=n.py_TypeError,xa=n.__sort__;n.print=n.__terminal__.print;n.input=n.__terminal__.input;O.executor_name=O.transpiler_name;n.main={__file__:""};n.__except__=null;var I=function(b){b.__kwargtrans__=null;b.constructor=
Object;return b};n.__kwargtrans__=I;n.__globals__=function(b){return Z(b,E)?b:E(b)};n.__super__=function(b,a){b=$jscomp.makeIterator(b.__bases__);for(var l=b.next();!l.done;l=b.next())if(l=l.value,a in l)return l[a];throw new ua("Superclass method not found");};n.property=function(b,a){a||(a=function(){});return{get:function(){return b(this)},set:function(b){a(this,b)},enumerable:!0}};var F=function(b,a,l){b.hasOwnProperty(a)||Object.defineProperty(b,a,l)};n.__setProperty__=F;n.assert=function(b,
a){if(!b)throw wa(a,Error());};n.__merge__=function(b,a){var l={},m;for(m in b)l[m]=b[m];for(m in a)l[m]=a[m];return l};n.dir=function(b){var a=[],l;for(l in b)a.push(l.startsWith("py_")?l.slice(3):l);a.sort();return a};n.setattr=function(b,a,l){b[a]=l};n.getattr=function(b,a){return a in b?b[a]:b["py_"+a]};n.hasattr=function(b,a){try{return a in b||"py_"+a in b}catch(l){return!1}};n.delattr=function(b,a){a in b?delete b[a]:delete b["py_"+a]};n.__in__=function(b,a){return R(a)==E?a.hasOwnProperty(b):
a.indexOf?-1<a.indexOf(b):a.hasOwnProperty(b)};var S=function(b){return b.startswith("__")&&b.endswith("__")||"constructor"==b||b.startswith("py_")};n.__specialattrib__=S;var N=function(b){if(void 0===b||null===b)return 0;if(b.__len__ instanceof Function)return b.__len__();if(void 0!==b.length)return b.length;var a=0,l;for(l in b)S(l)||a++;return a};n.len=N;n.__t__=p;var Q=function(b){return!!p(b)};Q.__name__="bool";n.bool=Q;var ca=function(b){if("inf"==b)return Infinity;if("-inf"==b)return-Infinity;
if(isNaN(parseFloat(b))){if(!1===b)return 0;if(!0===b)return 1;throw Y("could not convert string to float: '"+L(b)+"'",Error());}return+b};ca.__name__="float";n.float=ca;var V=function(b){return ca(b)|0};V.__name__="int";n.int=V;var R=function(b){var a=typeof b;if("object"==a)try{return b.__class__}catch(l){return a}else return"boolean"==a?Q:"string"==a?L:"number"==a?0==b%1?V:ca:null};n.py_typeof=R;var X=function(b,a){function l(b){if(b==a)return!0;for(var h=0;h<b.__bases__.length;h++)if(l(b.__bases__[h],
a))return!0;return!1}if(a instanceof Array){for(var m=$jscomp.makeIterator(a),r=m.next();!r.done;r=m.next())if(X(b,r.value))return!0;return!1}try{return l(b)}catch(h){return b==a||a==P||b==Q&&a==V}};n.issubclass=X;var Z=function(b,a){try{return"__class__"in b?X(b.__class__,a):X(R(b),a)}catch(l){return X(R(b),a)}};n.isinstance=Z;n.callable=function(b){return b&&"object"==typeof b&&"__call__"in b?!0:"function"===typeof b};var W=function(b){try{return b.__repr__()}catch(h){try{return b.__str__()}catch(k){try{if(null==
b)return"None";if(b.constructor==Object){var a="{",l=!1,m;for(m in b)if(!S(m)){var r=m.isnumeric()?m:"'"+m+"'";l?a+=", ":l=!0;a+=r+": "+W(b[m])}return a+"}"}return"boolean"==typeof b?b.toString().capitalize():b.toString()}catch(g){return"<object of type: "+typeof b+">"}}}};n.repr=W;n.chr=function(b){return String.fromCharCode(b)};var U=function(b){return b.charCodeAt(0)};n.ord=U;n.max=function(b){return 1==arguments.length?Math.max.apply(Math,[].concat($jscomp.arrayFromIterable(b))):Math.max.apply(Math,
[].concat($jscomp.arrayFromIterable(arguments)))};n.min=function(b){return 1==arguments.length?Math.min.apply(Math,[].concat($jscomp.arrayFromIterable(b))):Math.min.apply(Math,[].concat($jscomp.arrayFromIterable(arguments)))};n.abs=Math.abs;n.round=function(b,a){if(a){var l=Math.pow(10,a);b*=l}var m=Math.round(b);.5==m-b&&m%2&&--m;a&&(m/=l);return m};w.prototype.__next__=function(){if(this.index<this.iterable.length)return this.iterable[this.index++];throw va(Error());};v.prototype.next=function(){return this.index<
this.iterable.py_keys.length?{value:this.index++,done:!1}:{value:void 0,done:!0}};n.py_reversed=function(b){b=b.slice();b.reverse();return b};var da=function(){for(var b=[].slice.call(arguments),a=0;a<b.length;a++)"string"==typeof b[a]?b[a]=b[a].split(""):Array.isArray(b[a])||(b[a]=Array.from(b[a]));return(0==b.length?[]:b.reduce(function(b,a){return b.length<a.length?b:a})).map(function(a,m){return b.map(function(b){return b[m]})})};n.zip=da;n.range=x;n.any=function(b){b=$jscomp.makeIterator(b);
for(var a=b.next();!a.done;a=b.next())if(Q(a.value))return!0;return!1};n.all=function(b){b=$jscomp.makeIterator(b);for(var a=b.next();!a.done;a=b.next())if(!Q(a.value))return!1;return!0};n.sum=function(b){var a=0;b=$jscomp.makeIterator(b);for(var l=b.next();!l.done;l=b.next())a+=l.value;return a};n.enumerate=function(b){return da(x(N(b)),b)};n.copy=J;n.deepcopy=K;n.list=C;Array.prototype.__class__=C;C.__name__="list";Array.prototype.__iter__=function(){return new w(this)};Array.prototype.__getslice__=
function(b,a,l){0>b&&(b=this.length+b);null==a?a=this.length:0>a?a=this.length+a:a>this.length&&(a=this.length);for(var m=C([]);b<a;b+=l)m.push(this[b]);return m};Array.prototype.__setslice__=function(b,a,l,m){0>b&&(b=this.length+b);null==a?a=this.length:0>a&&(a=this.length+a);if(null==l)Array.prototype.splice.apply(this,[b,a-b].concat(m));else for(var r=0;b<a;b+=l)this[b]=m[r++]};Array.prototype.__repr__=function(){if(this.__class__==M&&!this.length)return"set()";for(var b=this.__class__&&this.__class__!=
C?this.__class__==B?"(":"{":"[",a=0;a<this.length;a++)a&&(b+=", "),b+=W(this[a]);this.__class__==B&&1==this.length&&(b+=",");return b+=this.__class__&&this.__class__!=C?this.__class__==B?")":"}":"]"};Array.prototype.__str__=Array.prototype.__repr__;Array.prototype.append=function(b){this.push(b)};Array.prototype.py_clear=function(){this.length=0};Array.prototype.extend=function(b){this.push.apply(this,b)};Array.prototype.insert=function(b,a){this.splice(b,0,a)};Array.prototype.remove=function(b){b=
this.indexOf(b);if(-1==b)throw Y("list.remove(x): x not in list",Error());this.splice(b,1)};Array.prototype.index=function(b){return this.indexOf(b)};Array.prototype.py_pop=function(b){return void 0==b?this.pop():this.splice(b,1)[0]};Array.prototype.py_sort=function(){xa.apply(null,[this].concat([].slice.apply(arguments)))};Array.prototype.__add__=function(b){return C(this.concat(b))};Array.prototype.__mul__=function(b){for(var a=this,l=1;l<b;l++)a=a.concat(this);return a};Array.prototype.__rmul__=
Array.prototype.__mul__;n.tuple=B;B.__name__="tuple";n.set=M;M.__name__="set";Array.prototype.__bindexOf__=function(b){b+="";for(var a=0,l=this.length-1;a<=l;){var m=(a+l)/2|0,r=this[m]+"";if(r<b)a=m+1;else if(r>b)l=m-1;else return m}return-1};Array.prototype.add=function(b){-1==this.indexOf(b)&&this.push(b)};Array.prototype.discard=function(b){b=this.indexOf(b);-1!=b&&this.splice(b,1)};Array.prototype.isdisjoint=function(b){this.sort();for(var a=0;a<b.length;a++)if(-1!=this.__bindexOf__(b[a]))return!1;
return!0};Array.prototype.issuperset=function(b){this.sort();for(var a=0;a<b.length;a++)if(-1==this.__bindexOf__(b[a]))return!1;return!0};Array.prototype.issubset=function(b){return M(b.slice()).issuperset(this)};Array.prototype.union=function(b){for(var a=M(this.slice().sort()),l=0;l<b.length;l++)-1==a.__bindexOf__(b[l])&&a.push(b[l]);return a};Array.prototype.intersection=function(b){this.sort();for(var a=M(),l=0;l<b.length;l++)-1!=this.__bindexOf__(b[l])&&a.push(b[l]);return a};Array.prototype.difference=
function(b){b=M(b.slice().sort());for(var a=M(),l=0;l<this.length;l++)-1==b.__bindexOf__(this[l])&&a.push(this[l]);return a};Array.prototype.symmetric_difference=function(b){return this.union(b).difference(this.intersection(b))};Array.prototype.py_update=function(){var b=[].concat.apply(this.slice(),arguments).sort();this.py_clear();for(var a=0;a<b.length;a++)b[a]!=b[a-1]&&this.push(b[a])};Array.prototype.__eq__=function(b){if(this.length!=b.length)return!1;this.__class__==M&&(this.sort(),b.sort());
for(var a=0;a<this.length;a++)if(this[a]!=b[a])return!1;return!0};Array.prototype.__ne__=function(b){return!this.__eq__(b)};Array.prototype.__le__=function(b){return this.issubset(b)};Array.prototype.__ge__=function(b){return this.issuperset(b)};Array.prototype.__lt__=function(b){return this.issubset(b)&&!this.issuperset(b)};Array.prototype.__gt__=function(b){return this.issuperset(b)&&!this.issubset(b)};n.bytearray=ea;n.bytes=ea;Uint8Array.prototype.__add__=function(b){var a=new Uint8Array(this.length+
b.length);a.set(this);a.set(b,this.length);return a};Uint8Array.prototype.__mul__=function(b){for(var a=new Uint8Array(b*this.length),l=0;l<b;l++)a.set(this,l*this.length);return a};Uint8Array.prototype.__rmul__=Uint8Array.prototype.__mul__;n.str=L;String.prototype.__class__=L;L.__name__="str";String.prototype.__iter__=function(){new w(this)};String.prototype.__repr__=function(){return(-1==this.indexOf("'")?"'"+this+"'":'"'+this+'"').py_replace("\t","\\t").py_replace("\n","\\n")};String.prototype.__str__=
function(){return this};String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};String.prototype.endswith=function(b){return""==b||this.slice(-b.length)==b};String.prototype.find=function(b,a){return this.indexOf(b,a)};String.prototype.__getslice__=function(b,a,l){0>b&&(b=this.length+b);null==a?a=this.length:0>a&&(a=this.length+a);var m="";if(1==l)m=this.substring(b,a);else for(;b<a;b+=l)m=m.concat(this.charAt(b));return m};F(String.prototype,"format",{get:function(){return t(this,
function(b){var a=B([].slice.apply(arguments).slice(1)),l=0;return b.replace(/\{(\w*)\}/g,function(b,r){""==r&&(r=l++);if(r==+r)return void 0==a[r]?b:L(a[r]);for(var h=0;h<a.length;h++)if("object"==typeof a[h]&&void 0!=a[h][r])return L(a[h][r]);return b})})},enumerable:!0});String.prototype.isalnum=function(){return/^[0-9a-zA-Z]{1,}$/.test(this)};String.prototype.isalpha=function(){return/^[a-zA-Z]{1,}$/.test(this)};String.prototype.isdecimal=function(){return/^[0-9]{1,}$/.test(this)};String.prototype.isdigit=
function(){return this.isdecimal()};String.prototype.islower=function(){return/^[a-z]{1,}$/.test(this)};String.prototype.isupper=function(){return/^[A-Z]{1,}$/.test(this)};String.prototype.isspace=function(){return/^[\s]{1,}$/.test(this)};String.prototype.isnumeric=function(){return!isNaN(parseFloat(this))&&isFinite(this)};String.prototype.join=function(b){b=Array.from(b);return b.join(this)};String.prototype.lower=function(){return this.toLowerCase()};String.prototype.py_replace=function(b,a,l){return this.split(b,
l).join(a)};String.prototype.lstrip=function(){return this.replace(/^\s*/g,"")};String.prototype.rfind=function(b,a){return this.lastIndexOf(b,a)};String.prototype.rsplit=function(b,a){if(void 0==b||null==b){b=/\s+/;var l=this.strip()}else l=this;if(void 0==a||-1==a)return l.split(b);l=l.split(b);return a<l.length?(a=l.length-a,[l.slice(0,a).join(b)].concat(l.slice(a))):l};String.prototype.rstrip=function(){return this.replace(/\s*$/g,"")};String.prototype.py_split=function(b,a){if(void 0==b||null==
b){b=/\s+/;var l=this.strip()}else l=this;if(void 0==a||-1==a)return l.split(b);l=l.split(b);return a<l.length?l.slice(0,a).concat([l.slice(a).join(b)]):l};String.prototype.startswith=function(b){return 0==this.indexOf(b)};String.prototype.strip=function(){return this.trim()};String.prototype.upper=function(){return this.toUpperCase()};String.prototype.__mul__=function(b){for(var a=this,l=1;l<b;l++)a+=this;return a};String.prototype.__rmul__=String.prototype.__mul__;n.dict=E;E.__name__="dict";F(Function.prototype,
"__setdoc__",{value:function(b){this.__doc__=b;return this},enumerable:!1});n.__jsmod__=function(b,a){return"object"==typeof b&&"__mod__"in b?b.__mod__(a):"object"==typeof a&&"__rpow__"in a?a.__rmod__(b):b%a};n.mod=function(b,a){return"object"==typeof b&&"__mod__"in b?b.__mod__(a):"object"==typeof a&&"__rmod__"in a?a.__rmod__(b):(b%a+a)%a};n.pow=function(b,a){return"object"==typeof b&&"__pow__"in b?b.__pow__(a):"object"==typeof a&&"__rpow__"in a?a.__rpow__(b):Math.pow(b,a)};n.__neg__=function(b){return"object"==
typeof b&&"__neg__"in b?b.__neg__():-b};n.__matmul__=function(b,a){return b.__matmul__(a)};n.__mul__=function(b,a){return"object"==typeof b&&"__mul__"in b?b.__mul__(a):"object"==typeof a&&"__rmul__"in a?a.__rmul__(b):"string"==typeof b?b.__mul__(a):"string"==typeof a?a.__rmul__(b):b*a};n.__truediv__=function(b,a){return"object"==typeof b&&"__truediv__"in b?b.__truediv__(a):"object"==typeof a&&"__rtruediv__"in a?a.__rtruediv__(b):"object"==typeof b&&"__div__"in b?b.__div__(a):"object"==typeof a&&"__rdiv__"in
a?a.__rdiv__(b):b/a};n.__floordiv__=function(b,a){return"object"==typeof b&&"__floordiv__"in b?b.__floordiv__(a):"object"==typeof a&&"__rfloordiv__"in a?a.__rfloordiv__(b):"object"==typeof b&&"__div__"in b?b.__div__(a):"object"==typeof a&&"__rdiv__"in a?a.__rdiv__(b):Math.floor(b/a)};n.__add__=function(b,a){return"object"==typeof b&&"__add__"in b?b.__add__(a):"object"==typeof a&&"__radd__"in a?a.__radd__(b):b+a};n.__sub__=function(b,a){return"object"==typeof b&&"__sub__"in b?b.__sub__(a):"object"==
typeof a&&"__rsub__"in a?a.__rsub__(b):b-a};n.__lshift__=function(b,a){return"object"==typeof b&&"__lshift__"in b?b.__lshift__(a):"object"==typeof a&&"__rlshift__"in a?a.__rlshift__(b):b<<a};n.__rshift__=function(b,a){return"object"==typeof b&&"__rshift__"in b?b.__rshift__(a):"object"==typeof a&&"__rrshift__"in a?a.__rrshift__(b):b>>a};n.__or__=function(b,a){return"object"==typeof b&&"__or__"in b?b.__or__(a):"object"==typeof a&&"__ror__"in a?a.__ror__(b):b|a};n.__xor__=function(b,a){return"object"==
typeof b&&"__xor__"in b?b.__xor__(a):"object"==typeof a&&"__rxor__"in a?a.__rxor__(b):b^a};n.__and__=function(b,a){return"object"==typeof b&&"__and__"in b?b.__and__(a):"object"==typeof a&&"__rand__"in a?a.__rand__(b):b&a};n.__eq__=function(b,a){return"object"==typeof b&&"__eq__"in b?b.__eq__(a):b==a};n.__ne__=function(b,a){return"object"==typeof b&&"__ne__"in b?b.__ne__(a):b!=a};n.__lt__=function(b,a){return"object"==typeof b&&"__lt__"in b?b.__lt__(a):b<a};n.__le__=function(b,a){return"object"==typeof b&&
"__le__"in b?b.__le__(a):b<=a};n.__gt__=function(b,a){return"object"==typeof b&&"__gt__"in b?b.__gt__(a):b>a};n.__ge__=function(b,a){return"object"==typeof b&&"__ge__"in b?b.__ge__(a):b>=a};n.__imatmul__=function(b,a){return"__imatmul__"in b?b.__imatmul__(a):b.__matmul__(a)};n.ipow=function(b,a){return"object"==typeof b&&"__pow__"in b?b.__ipow__(a):"object"==typeof b&&"__ipow__"in b?b.__pow__(a):"object"==typeof a&&"__rpow__"in a?a.__rpow__(b):Math.pow(b,a)};n.ijsmod__=function(b,a){return"object"==
typeof b&&"__imod__"in b?b.__ismod__(a):"object"==typeof b&&"__mod__"in b?b.__mod__(a):"object"==typeof a&&"__rpow__"in a?a.__rmod__(b):b%a};n.imod=function(b,a){return"object"==typeof b&&"__imod__"in b?b.__imod__(a):"object"==typeof b&&"__mod__"in b?b.__mod__(a):"object"==typeof a&&"__rpow__"in a?a.__rmod__(b):(b%a+a)%a};n.__imul__=function(b,a){return"object"==typeof b&&"__imul__"in b?b.__imul__(a):"object"==typeof b&&"__mul__"in b?b.__mul__(a):"object"==typeof a&&"__rmul__"in a?a.__rmul__(b):"string"==
typeof b?b.__mul__(a):"string"==typeof a?a.__rmul__(b):b*a};n.__idiv__=function(b,a){return"object"==typeof b&&"__idiv__"in b?b.__idiv__(a):"object"==typeof b&&"__div__"in b?b.__div__(a):"object"==typeof a&&"__rdiv__"in a?a.__rdiv__(b):b/a};n.__iadd__=function(b,a){return"object"==typeof b&&"__iadd__"in b?b.__iadd__(a):"object"==typeof b&&"__add__"in b?b.__add__(a):"object"==typeof a&&"__radd__"in a?a.__radd__(b):b+a};n.__isub__=function(b,a){return"object"==typeof b&&"__isub__"in b?b.__isub__(a):
"object"==typeof b&&"__sub__"in b?b.__sub__(a):"object"==typeof a&&"__rsub__"in a?a.__rsub__(b):b-a};n.__ilshift__=function(b,a){return"object"==typeof b&&"__ilshift__"in b?b.__ilshift__(a):"object"==typeof b&&"__lshift__"in b?b.__lshift__(a):"object"==typeof a&&"__rlshift__"in a?a.__rlshift__(b):b<<a};n.__irshift__=function(b,a){return"object"==typeof b&&"__irshift__"in b?b.__irshift__(a):"object"==typeof b&&"__rshift__"in b?b.__rshift__(a):"object"==typeof a&&"__rrshift__"in a?a.__rrshift__(b):
b>>a};n.__ior__=function(b,a){return"object"==typeof b&&"__ior__"in b?b.__ior__(a):"object"==typeof b&&"__or__"in b?b.__or__(a):"object"==typeof a&&"__ror__"in a?a.__ror__(b):b|a};n.__ixor__=function(b,a){return"object"==typeof b&&"__ixor__"in b?b.__ixor__(a):"object"==typeof b&&"__xor__"in b?b.__xor__(a):"object"==typeof a&&"__rxor__"in a?a.__rxor__(b):b^a};n.__iand__=function(b,a){return"object"==typeof b&&"__iand__"in b?b.__iand__(a):"object"==typeof b&&"__and__"in b?b.__and__(a):"object"==typeof a&&
"__rand__"in a?a.__rand__(b):b&a};n.__getitem__=function(b,a){return"object"==typeof b&&"__getitem__"in b?b.__getitem__(a):("string"==typeof b||b instanceof Array)&&0>a?b[b.length+a]:b[a]};n.__setitem__=function(b,a,l){"object"==typeof b&&"__setitem__"in b?b.__setitem__(a,l):("string"==typeof b||b instanceof Array)&&0>a?b[b.length+a]=l:b[a]=l};n.__getslice__=function(b,a,l,m){return"object"==typeof b&&"__getitem__"in b?b.__getitem__([a,l,m]):b.__getslice__(a,l,m)};n.__setslice__=function(b,a,l,m,
r){"object"==typeof b&&"__setitem__"in b?b.__setitem__([a,l,m],r):b.__setslice__(a,l,m,r)};T(n,"com.fabricjs",{__all__:{__inited__:!1,__init__:function(b){var a=function(){var b={},a=a||{version:"1.5.0"};"undefined"!==typeof b&&(b.fabric=a);"undefined"!==typeof document&&"undefined"!==typeof window?(a.document=document,a.window=window,window.fabric=a):(a.document=require("jsdom").jsdom("<!DOCTYPE html><html><head></head><body></body></html>"),a.window=a.document.createWindow?a.document.createWindow():
a.document.parentWindow);a.isTouchSupported="ontouchstart"in a.document.documentElement;a.isLikelyNode="undefined"!==typeof Buffer&&"undefined"===typeof window;a.SHARED_ATTRIBUTES="display transform fill fill-opacity fill-rule opacity stroke stroke-dasharray stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width".split(" ");a.DPI=96;a.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?)";(function(){function b(c,e){this.__eventListeners[c]&&(e?a.util.removeFromArray(this.__eventListeners[c],
e):this.__eventListeners[c].length=0)}function h(c,e){this.__eventListeners||(this.__eventListeners={});if(1===arguments.length)for(var f in c)this.on(f,c[f]);else this.__eventListeners[c]||(this.__eventListeners[c]=[]),this.__eventListeners[c].push(e);return this}function k(c,e){if(this.__eventListeners){if(0===arguments.length)this.__eventListeners={};else if(1===arguments.length&&"object"===typeof arguments[0])for(var f in c)b.call(this,f,c[f]);else b.call(this,c,e);return this}}function g(c,e){if(this.__eventListeners&&
(c=this.__eventListeners[c])){for(var f=0,d=c.length;f<d;f++)c[f].call(this,e||{});return this}}a.Observable={observe:h,stopObserving:k,fire:g,on:h,off:k,trigger:g}})();a.Collection={add:function(){this._objects.push.apply(this._objects,arguments);for(var a=0,b=arguments.length;a<b;a++)this._onObjectAdded(arguments[a]);this.renderOnAddRemove&&this.renderAll();return this},insertAt:function(a,b,k){var g=this.getObjects();k?g[b]=a:g.splice(b,0,a);this._onObjectAdded(a);this.renderOnAddRemove&&this.renderAll();
return this},remove:function(){for(var a=this.getObjects(),b,k=0,g=arguments.length;k<g;k++)b=a.indexOf(arguments[k]),-1!==b&&(a.splice(b,1),this._onObjectRemoved(arguments[k]));this.renderOnAddRemove&&this.renderAll();return this},forEachObject:function(a,b){for(var h=this.getObjects(),g=h.length;g--;)a.call(b,h[g],g,h);return this},getObjects:function(a){return"undefined"===typeof a?this._objects:this._objects.filter(function(b){return b.type===a})},item:function(a){return this.getObjects()[a]},
isEmpty:function(){return 0===this.getObjects().length},size:function(){return this.getObjects().length},contains:function(a){return-1<this.getObjects().indexOf(a)},complexity:function(){return this.getObjects().reduce(function(a,b){return a+=b.complexity?b.complexity():0},0)}};(function(b){var h=Math.sqrt,k=Math.atan2,g=Math.PI/180;a.util={removeFromArray:function(c,e){e=c.indexOf(e);-1!==e&&c.splice(e,1);return c},getRandomInt:function(c,e){return Math.floor(Math.random()*(e-c+1))+c},degreesToRadians:function(c){return c*
g},radiansToDegrees:function(c){return c/g},rotatePoint:function(c,e,f){var d=Math.sin(f);f=Math.cos(f);c.subtractEquals(e);return(new a.Point(c.x*f-c.y*d,c.x*d+c.y*f)).addEquals(e)},transformPoint:function(c,e,f){return f?new a.Point(e[0]*c.x+e[2]*c.y,e[1]*c.x+e[3]*c.y):new a.Point(e[0]*c.x+e[2]*c.y+e[4],e[1]*c.x+e[3]*c.y+e[5])},invertTransform:function(c){c.slice();var e=1/(c[0]*c[3]-c[1]*c[2]);e=[e*c[3],-e*c[1],-e*c[2],e*c[0],0,0];c=a.util.transformPoint({x:c[4],y:c[5]},e);e[4]=-c.x;e[5]=-c.y;
return e},toFixed:function(c,e){return parseFloat(Number(c).toFixed(e))},parseUnit:function(c,e){var f=/\D{0,2}$/.exec(c);c=parseFloat(c);e||(e=a.Text.DEFAULT_SVG_FONT_SIZE);switch(f[0]){case "mm":return c*a.DPI/25.4;case "cm":return c*a.DPI/2.54;case "in":return c*a.DPI;case "pt":return c*a.DPI/72;case "pc":return c*a.DPI/72*12;case "em":return c*e;default:return c}},falseFunction:function(){return!1},getKlass:function(c,e){c=a.util.string.camelize(c.charAt(0).toUpperCase()+c.slice(1));return a.util.resolveNamespace(e)[c]},
resolveNamespace:function(c){if(!c)return a;c=c.split(".");for(var e=c.length,f=b||a.window,d=0;d<e;++d)f=f[c[d]];return f},loadImage:function(c,e,f,d){if(c){var b=a.util.createImage();b.onload=function(){e&&e.call(f,b);b=b.onload=b.onerror=null};b.onerror=function(){a.log("Error loading "+b.src);e&&e.call(f,null,!0);b=b.onload=b.onerror=null};0!==c.indexOf("data")&&"undefined"!==typeof d&&(b.crossOrigin=d);b.src=c}else e&&e.call(f,c)},enlivenObjects:function(c,e,f,d){function b(){++h===k&&e&&e(g)}
c=c||[];var g=[],h=0,k=c.length;k?c.forEach(function(c,e){if(c&&c.type){var h=a.util.getKlass(c.type,f);h.async?h.fromObject(c,function(f,a){a||(g[e]=f,d&&d(c,g[e]));b()}):(g[e]=h.fromObject(c),d&&d(c,g[e]),b())}else b()}):e&&e(g)},groupSVGElements:function(c,e,f){c=new a.PathGroup(c,e);"undefined"!==typeof f&&c.setSourcePath(f);return c},populateWithProperties:function(c,e,f){if(f&&"[object Array]"===Object.prototype.toString.call(f))for(var d=0,a=f.length;d<a;d++)f[d]in c&&(e[f[d]]=c[f[d]])},drawDashedLine:function(c,
e,f,d,a,b){d-=e;var g=a-f;a=h(d*d+g*g);d=k(g,d);g=b.length;var q=0,u=!0;c.save();c.translate(e,f);c.moveTo(0,0);c.rotate(d);for(e=0;a>e;)e+=b[q++%g],e>a&&(e=a),c[u?"lineTo":"moveTo"](e,0),u=!u;c.restore()},createCanvasElement:function(c){c||(c=a.document.createElement("canvas"));c.getContext||"undefined"===typeof G_vmlCanvasManager||G_vmlCanvasManager.initElement(c);return c},createImage:function(){return a.isLikelyNode?new (require("canvas").Image):a.document.createElement("img")},createAccessors:function(c){c=
c.prototype;for(var e=c.stateProperties.length;e--;){var f=c.stateProperties[e],d=f.charAt(0).toUpperCase()+f.slice(1),a="set"+d;d="get"+d;c[d]||(c[d]=new Function('return this.get("'+f+'")'));c[a]||(c[a]=new Function("value",'return this.set("'+f+'", value)'))}},clipContext:function(c,e){e.save();e.beginPath();c.clipTo(e);e.clip()},multiplyTransformMatrices:function(c,e){return[c[0]*e[0]+c[2]*e[1],c[1]*e[0]+c[3]*e[1],c[0]*e[2]+c[2]*e[3],c[1]*e[2]+c[3]*e[3],c[0]*e[4]+c[2]*e[5]+c[4],c[1]*e[4]+c[3]*
e[5]+c[5]]},getFunctionBody:function(c){return(String(c).match(/function[^{]*\{([\s\S]*)\}/)||{})[1]},isTransparent:function(c,e,f,d){0<d&&(e=e>d?e-d:0,f=f>d?f-d:0);var a=!0;c=c.getImageData(e,f,2*d||1,2*d||1);e=3;for(f=c.data.length;e<f&&(a=0>=c.data[e],!1!==a);e+=4);return a}}})("undefined"!==typeof b?b:this);(function(){function b(f,e,a,b,g,r,l){var q=d.call(arguments);if(c[q])return c[q];var u=Math.PI,y=l*u/180,D=Math.sin(y);y=Math.cos(y);var G=0,H=0;a=Math.abs(a);b=Math.abs(b);var n=-y*f*.5-
D*e*.5,z=-y*e*.5+D*f*.5,p=a*a,m=b*b,t=z*z,v=n*n,w=p*m-p*t-m*v,x=0;0>w?(p=Math.sqrt(1-w/(p*m)),a*=p,b*=p):x=(g===r?-1:1)*Math.sqrt(w/(p*t+m*v));t=x*a*z/b;v=-x*b*n/a;x=y*t-D*v+.5*f;p=D*t+y*v+.5*e;m=k(1,0,(n-t)/a,(z-v)/b);z=k((n-t)/a,(z-v)/b,(-n-t)/a,(-z-v)/b);0===r&&0<z?z-=2*u:1===r&&0>z&&(z+=2*u);u=Math.ceil(Math.abs(z/u*2));n=[];z/=u;t=8/3*Math.sin(z/4)*Math.sin(z/4)/Math.sin(z/2);v=m+z;for(w=0;w<u;w++)n[w]=h(m,v,y,D,a,b,x,p,t,G,H),G=n[w][4],H=n[w][5],m=v,v+=z;return c[q]=n}function h(f,c,a,b,g,h,
k,r,l,n,p){var q=d.call(arguments);if(e[q])return e[q];var u=Math.cos(f),y=Math.sin(f),D=Math.cos(c),G=Math.sin(c),H=a*g*D-b*h*G+k,z=b*g*D+a*h*G+r;e[q]=[n+l*(-a*g*y-b*h*u),p+l*(-b*g*y+a*h*u),H+l*(a*g*G+b*h*D),z+l*(b*g*G-a*h*D),H,z];return e[q]}function k(d,f,c,e){d=Math.atan2(f,d);c=Math.atan2(e,c);return c>=d?c-d:2*Math.PI-(d-c)}function g(c,e,a,b,g,h,k,r){var q=d.call(arguments);if(f[q])return f[q];var u=Math.sqrt,y=Math.min,D=Math.max,G=Math.abs,l=[],H=[[],[]];var n=6*c-12*a+6*g;var z=-3*c+9*a-
9*g+3*k;var ba=3*a-3*c;for(var p=0;2>p;++p)if(0<p&&(n=6*e-12*b+6*h,z=-3*e+9*b-9*h+3*r,ba=3*b-3*e),1E-12>G(z)){if(!(1E-12>G(n))){var m=-ba/n;0<m&&1>m&&l.push(m)}}else if(m=n*n-4*ba*z,!(0>m)){var t=u(m);m=(-n+t)/(2*z);0<m&&1>m&&l.push(m);m=(-n-t)/(2*z);0<m&&1>m&&l.push(m)}for(G=u=l.length;u--;)m=l[u],n=1-m,z=n*n*n*c+3*n*n*m*a+3*n*m*m*g+m*m*m*k,H[0][u]=z,z=n*n*n*e+3*n*n*m*b+3*n*m*m*h+m*m*m*r,H[1][u]=z;H[0][G]=c;H[1][G]=e;H[0][G+1]=k;H[1][G+1]=r;y=[{x:y.apply(null,H[0]),y:y.apply(null,H[1])},{x:D.apply(null,
H[0]),y:D.apply(null,H[1])}];return f[q]=y}var c={},e={},f={},d=Array.prototype.join;a.util.drawArc=function(d,f,c,e){var a=[[],[],[],[]];e=b(e[5]-f,e[6]-c,e[0],e[1],e[3],e[4],e[2]);for(var g=0,h=e.length;g<h;g++)a[g][0]=e[g][0]+f,a[g][1]=e[g][1]+c,a[g][2]=e[g][2]+f,a[g][3]=e[g][3]+c,a[g][4]=e[g][4]+f,a[g][5]=e[g][5]+c,d.bezierCurveTo.apply(d,a[g])};a.util.getBoundsOfArc=function(d,f,c,e,a,h,k,r,l){var q=0,u=0,y=[];c=b(r-d,l-f,c,e,h,k,a);e=[[],[]];a=0;for(h=c.length;a<h;a++)q=g(q,u,c[a][0],c[a][1],
c[a][2],c[a][3],c[a][4],c[a][5]),e[0].x=q[0].x+d,e[0].y=q[0].y+f,e[1].x=q[1].x+d,e[1].y=q[1].y+f,y.push(e[0]),y.push(e[1]),q=c[a][4],u=c[a][5];return y};a.util.getBoundsOfCurve=g})();(function(){function b(a,b,c){if(a&&0!==a.length){var e=a.length-1,f=b?a[e][b]:a[e];if(b)for(;e--;)c(a[e][b],f)&&(f=a[e][b]);else for(;e--;)c(a[e],f)&&(f=a[e]);return f}}var h=Array.prototype.slice;Array.prototype.indexOf||(Array.prototype.indexOf=function(a){if(void 0===this||null===this)throw new TypeError;var b=Object(this),
c=b.length>>>0;if(0===c)return-1;var e=0;0<arguments.length&&(e=Number(arguments[1]),e!==e?e=0:0!==e&&e!==Number.POSITIVE_INFINITY&&e!==Number.NEGATIVE_INFINITY&&(e=(0<e||-1)*Math.floor(Math.abs(e))));if(e>=c)return-1;for(e=0<=e?e:Math.max(c-Math.abs(e),0);e<c;e++)if(e in b&&b[e]===a)return e;return-1});Array.prototype.forEach||(Array.prototype.forEach=function(a,b){for(var c=0,e=this.length>>>0;c<e;c++)c in this&&a.call(b,this[c],c,this)});Array.prototype.map||(Array.prototype.map=function(a,b){for(var c=
[],e=0,f=this.length>>>0;e<f;e++)e in this&&(c[e]=a.call(b,this[e],e,this));return c});Array.prototype.every||(Array.prototype.every=function(a,b){for(var c=0,e=this.length>>>0;c<e;c++)if(c in this&&!a.call(b,this[c],c,this))return!1;return!0});Array.prototype.some||(Array.prototype.some=function(a,b){for(var c=0,e=this.length>>>0;c<e;c++)if(c in this&&a.call(b,this[c],c,this))return!0;return!1});Array.prototype.filter||(Array.prototype.filter=function(a,b){for(var c=[],e,f=0,d=this.length>>>0;f<
d;f++)f in this&&(e=this[f],a.call(b,e,f,this)&&c.push(e));return c});Array.prototype.reduce||(Array.prototype.reduce=function(a){var b=this.length>>>0,c=0;if(1<arguments.length)var e=arguments[1];else{do{if(c in this){e=this[c++];break}if(++c>=b)throw new TypeError;}while(1)}for(;c<b;c++)c in this&&(e=a.call(null,e,this[c],c,this));return e});a.util.array={invoke:function(a,b){for(var c=h.call(arguments,2),e=[],f=0,d=a.length;f<d;f++)e[f]=c.length?a[f][b].apply(a[f],c):a[f][b].call(a[f]);return e},
min:function(a,g){return b(a,g,function(c,a){return c<a})},max:function(a,g){return b(a,g,function(c,a){return c>=a})}}})();(function(){function b(a,b){for(var g in b)a[g]=b[g];return a}a.util.object={extend:b,clone:function(a){return b({},a)}}})();(function(){String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\xA0]+/,"").replace(/[\s\xA0]+$/,"")});a.util.string={camelize:function(a){return a.replace(/-+(.)?/g,function(a,b){return b?b.toUpperCase():""})},capitalize:function(a,
b){return a.charAt(0).toUpperCase()+(b?a.slice(1):a.slice(1).toLowerCase())},escapeXml:function(a){return a.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}}})();(function(){var a=Array.prototype.slice,b=Function.prototype.apply,k=function(){};Function.prototype.bind||(Function.prototype.bind=function(g){var c=this,e=a.call(arguments,1);var f=e.length?function(){return b.call(c,this instanceof k?this:g,e.concat(a.call(arguments)))}:function(){return b.call(c,
this instanceof k?this:g,arguments)};k.prototype=this.prototype;f.prototype=new k;return f})})();(function(){function b(){}function h(f){var d=this.constructor.superclass.prototype[f];return 1<arguments.length?d.apply(this,k.call(arguments,1)):d.call(this)}var k=Array.prototype.slice,g=function(){},c=function(){for(var f in{toString:1})if("toString"===f)return!1;return!0}(),e=function(f,d,a){for(var e in d)e in f.prototype&&"function"===typeof f.prototype[e]&&-1<(d[e]+"").indexOf("callSuper")?f.prototype[e]=
function(f){return function(){var c=this.constructor.superclass;this.constructor.superclass=a;var e=d[f].apply(this,arguments);this.constructor.superclass=c;if("initialize"!==f)return e}}(e):f.prototype[e]=d[e],c&&(d.toString!==Object.prototype.toString&&(f.prototype.toString=d.toString),d.valueOf!==Object.prototype.valueOf&&(f.prototype.valueOf=d.valueOf))};a.util.createClass=function(){function f(){this.initialize.apply(this,arguments)}var d=null,c=k.call(arguments,0);"function"===typeof c[0]&&
(d=c.shift());f.superclass=d;f.subclasses=[];d&&(b.prototype=d.prototype,f.prototype=new b,d.subclasses.push(f));for(var a=0,r=c.length;a<r;a++)e(f,c[a],d);f.prototype.initialize||(f.prototype.initialize=g);f.prototype.constructor=f;f.prototype.callSuper=h;return f}})();(function(){function b(d){var f=Array.prototype.slice.call(arguments,1),c,a=f.length;for(c=0;c<a;c++){var e=typeof d[f[c]];if(!/^(?:function|object|unknown)$/.test(e))return!1}return!0}function h(d,f){return function(e){f.call(c(d),
e||a.window.event)}}function k(d,f){return function(c){if(y[d]&&y[d][f])for(var e=y[d][f],b=0,g=e.length;b<g;b++)e[b].call(this,c||a.window.event)}}function g(d,f,c){var a="touchend"===d.type?"changedTouches":"touches";return d[a]&&d[a][0]?d[a][0][f]-(d[a][0][f]-d[a][0][c])||d[c]:d[c]}var c,e,f=function(){var d=0;return function(f){return f.__uniqueID||(f.__uniqueID="uniqueID__"+d++)}}();(function(){var d={};c=function(f){return d[f]};e=function(f,c){d[f]=c}})();var d=b(a.document.documentElement,
"addEventListener","removeEventListener")&&b(a.window,"addEventListener","removeEventListener"),q=b(a.document.documentElement,"attachEvent","detachEvent")&&b(a.window,"attachEvent","detachEvent"),u={},y={};d?(d=function(d,f,c){d.addEventListener(f,c,!1)},q=function(d,f,c){d.removeEventListener(f,c,!1)}):q?(d=function(d,c,a){var b=f(d);e(b,d);u[b]||(u[b]={});u[b][c]||(u[b][c]=[]);a={handler:a,wrappedHandler:h(b,a)};u[b][c].push(a);d.attachEvent("on"+c,a.wrappedHandler)},q=function(d,c,a){var e=f(d),
b;if(u[e]&&u[e][c])for(var g=0,h=u[e][c].length;g<h;g++)(b=u[e][c][g])&&b.handler===a&&(d.detachEvent("on"+c,b.wrappedHandler),u[e][c][g]=null)}):(d=function(d,c,a){var e=f(d);y[e]||(y[e]={});if(!y[e][c]){y[e][c]=[];var b=d["on"+c];b&&y[e][c].push(b);d["on"+c]=k(e,c)}y[e][c].push(a)},q=function(d,c,a){d=f(d);if(y[d]&&y[d][c]){c=y[d][c];d=0;for(var e=c.length;d<e;d++)c[d]===a&&c.splice(d,1)}});a.util.addListener=d;a.util.removeListener=q;var D=function(d){return"unknown"!==typeof d.clientX?d.clientX:
0},l=function(d){return"unknown"!==typeof d.clientY?d.clientY:0};a.isTouchSupported&&(D=function(d){return g(d,"pageX","clientX")},l=function(d){return g(d,"pageY","clientY")});a.util.getPointer=function(d,f){d||(d=a.window.event);f=a.util.getScrollLeftTop(d.target||("unknown"!==typeof d.srcElement?d.srcElement:null),f);return{x:D(d)+f.left,y:l(d)+f.top}};a.util.object.extend(a.util,a.Observable)})();(function(){var b=a.document.createElement("div"),h="string"===typeof b.style.filter,k=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,
g=function(c){return c};"string"===typeof b.style.opacity?g=function(c,a){c.style.opacity=a;return c}:h&&(g=function(c,a){var f=c.style;c.currentStyle&&!c.currentStyle.hasLayout&&(f.zoom=1);k.test(f.filter)?f.filter=f.filter.replace(k,.9999<=a?"":"alpha(opacity="+100*a+")"):f.filter+=" alpha(opacity="+100*a+")";return c});a.util.setStyle=function(c,a){var f=c.style;if(!f)return c;if("string"===typeof a)return c.style.cssText+=";"+a,-1<a.indexOf("opacity")?g(c,a.match(/opacity:\s*(\d?\.?\d*)/)[1]):
c;for(var d in a)"opacity"===d?g(c,a[d]):f["float"===d||"cssFloat"===d?"undefined"===typeof f.styleFloat?"cssFloat":"styleFloat":d]=a[d];return c}})();(function(){function b(c,f){c=a.document.createElement(c);for(var d in f)"class"===d?c.className=f[d]:"for"===d?c.htmlFor=f[d]:c.setAttribute(d,f[d]);return c}var h=Array.prototype.slice,k=function(c){return h.call(c,0)};try{var g=k(a.document.childNodes)instanceof Array}catch(e){}g||(k=function(c){for(var f=Array(c.length),d=c.length;d--;)f[d]=c[d];
return f});var c=a.document.defaultView&&a.document.defaultView.getComputedStyle?function(c,f){return(c=a.document.defaultView.getComputedStyle(c,null))?c[f]:void 0}:function(c,f){var d=c.style[f];!d&&c.currentStyle&&(d=c.currentStyle[f]);return d};(function(){var c=a.document.documentElement.style,f="userSelect"in c?"userSelect":"MozUserSelect"in c?"MozUserSelect":"WebkitUserSelect"in c?"WebkitUserSelect":"KhtmlUserSelect"in c?"KhtmlUserSelect":"";a.util.makeElementUnselectable=function(d){"undefined"!==
typeof d.onselectstart&&(d.onselectstart=a.util.falseFunction);f?d.style[f]="none":"string"===typeof d.unselectable&&(d.unselectable="on");return d};a.util.makeElementSelectable=function(d){"undefined"!==typeof d.onselectstart&&(d.onselectstart=null);f?d.style[f]="":"string"===typeof d.unselectable&&(d.unselectable="");return d}})();(function(){a.util.getScript=function(c,f){var d=a.document.getElementsByTagName("head")[0],b=a.document.createElement("script"),e=!0;b.onload=b.onreadystatechange=function(d){!e||
"string"===typeof this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(e=!1,f(d||a.window.event),b=b.onload=b.onreadystatechange=null)};b.src=c;d.appendChild(b)}})();a.util.getById=function(c){return"string"===typeof c?a.document.getElementById(c):c};a.util.toArray=k;a.util.makeElement=b;a.util.addClass=function(c,f){c&&-1===(" "+c.className+" ").indexOf(" "+f+" ")&&(c.className+=(c.className?" ":"")+f)};a.util.wrapElement=function(c,f,d){"string"===typeof f&&(f=b(f,d));c.parentNode&&
c.parentNode.replaceChild(f,c);f.appendChild(c);return f};a.util.getScrollLeftTop=function(c,f){var d,b,e=0,g=0,h=a.document.documentElement,k=a.document.body||{scrollLeft:0,scrollTop:0};for(b=c;c&&c.parentNode&&!d;)c=c.parentNode,1===c.nodeType&&"fixed"===a.util.getElementStyle(c,"position")&&(d=c),1===c.nodeType&&b!==f&&"absolute"===a.util.getElementStyle(c,"position")?g=e=0:c===a.document?(e=k.scrollLeft||h.scrollLeft||0,g=k.scrollTop||h.scrollTop||0):(e+=c.scrollLeft||0,g+=c.scrollTop||0);return{left:e,
top:g}};a.util.getElementOffset=function(b){var f=b&&b.ownerDocument;var d={left:0,top:0},e={left:0,top:0},g={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!f)return{left:0,top:0};for(var h in g)e[g[h]]+=parseInt(c(b,h),10)||0;f=f.documentElement;"undefined"!==typeof b.getBoundingClientRect&&(d=b.getBoundingClientRect());b=a.util.getScrollLeftTop(b,null);return{left:d.left+b.left-(f.clientLeft||0)+e.left,top:d.top+b.top-(f.clientTop||0)+e.top}};a.util.getElementStyle=
c})();(function(){function b(a,c){return a+(/\?/.test(a)?"&":"?")+c}function h(){}var k=function(){for(var a=[function(){return new ActiveXObject("Microsoft.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP.3.0")},function(){return new XMLHttpRequest}],c=a.length;c--;)try{if(a[c]())return a[c]}catch(e){}}();a.util.request=function(a,c){c||(c={});var e=c.method?c.method.toUpperCase():"GET",f=c.onComplete||function(){},d=k();d.onreadystatechange=
function(){4===d.readyState&&(f(d),d.onreadystatechange=h)};if("GET"===e){var g=null;"string"===typeof c.parameters&&(a=b(a,c.parameters))}d.open(e,a,!0);"POST"!==e&&"PUT"!==e||d.setRequestHeader("Content-Type","application/x-www-form-urlencoded");d.send(g);return d}})();a.log=function(){};a.warn=function(){};"undefined"!==typeof console&&["log","warn"].forEach(function(b){"undefined"!==typeof console[b]&&"function"===typeof console[b].apply&&(a[b]=function(){return console[b].apply(console,arguments)})});
(function(a){function b(a,b){this.x=a;this.y=b}a=a.fabric||(a.fabric={});a.Point?a.warn("fabric.Point is already defined"):(a.Point=b,b.prototype={constructor:b,add:function(a){return new b(this.x+a.x,this.y+a.y)},addEquals:function(a){this.x+=a.x;this.y+=a.y;return this},scalarAdd:function(a){return new b(this.x+a,this.y+a)},scalarAddEquals:function(a){this.x+=a;this.y+=a;return this},subtract:function(a){return new b(this.x-a.x,this.y-a.y)},subtractEquals:function(a){this.x-=a.x;this.y-=a.y;return this},
scalarSubtract:function(a){return new b(this.x-a,this.y-a)},scalarSubtractEquals:function(a){this.x-=a;this.y-=a;return this},multiply:function(a){return new b(this.x*a,this.y*a)},multiplyEquals:function(a){this.x*=a;this.y*=a;return this},divide:function(a){return new b(this.x/a,this.y/a)},divideEquals:function(a){this.x/=a;this.y/=a;return this},eq:function(a){return this.x===a.x&&this.y===a.y},lt:function(a){return this.x<a.x&&this.y<a.y},lte:function(a){return this.x<=a.x&&this.y<=a.y},gt:function(a){return this.x>
a.x&&this.y>a.y},gte:function(a){return this.x>=a.x&&this.y>=a.y},lerp:function(a,g){return new b(this.x+(a.x-this.x)*g,this.y+(a.y-this.y)*g)},distanceFrom:function(a){var b=this.x-a.x;a=this.y-a.y;return Math.sqrt(b*b+a*a)},midPointFrom:function(a){return new b(this.x+(a.x-this.x)/2,this.y+(a.y-this.y)/2)},min:function(a){return new b(Math.min(this.x,a.x),Math.min(this.y,a.y))},max:function(a){return new b(Math.max(this.x,a.x),Math.max(this.y,a.y))},toString:function(){return this.x+","+this.y},
setXY:function(a,b){this.x=a;this.y=b},setFromPoint:function(a){this.x=a.x;this.y=a.y},swap:function(a){var b=this.x,c=this.y;this.x=a.x;this.y=a.y;a.x=b;a.y=c}})})("undefined"!==typeof b?b:this);(function(a){function b(a){this.status=a;this.points=[]}var k=a.fabric||(a.fabric={});k.Intersection?k.warn("fabric.Intersection is already defined"):(k.Intersection=b,k.Intersection.prototype={appendPoint:function(a){this.points.push(a)},appendPoints:function(a){this.points=this.points.concat(a)}},k.Intersection.intersectLineLine=
function(a,c,e,f){var d=(f.x-e.x)*(a.y-e.y)-(f.y-e.y)*(a.x-e.x);var g=(c.x-a.x)*(a.y-e.y)-(c.y-a.y)*(a.x-e.x);e=(f.y-e.y)*(c.x-a.x)-(f.x-e.x)*(c.y-a.y);0!==e?(d/=e,g/=e,0<=d&&1>=d&&0<=g&&1>=g?(g=new b("Intersection"),g.points.push(new k.Point(a.x+d*(c.x-a.x),a.y+d*(c.y-a.y)))):g=new b):g=0===d||0===g?new b("Coincident"):new b("Parallel");return g},k.Intersection.intersectLinePolygon=function(a,c,e){for(var f=new b,d=e.length,g=0;g<d;g++){var h=b.intersectLineLine(a,c,e[g],e[(g+1)%d]);f.appendPoints(h.points)}0<
f.points.length&&(f.status="Intersection");return f},k.Intersection.intersectPolygonPolygon=function(a,c){for(var e=new b,f=a.length,d=0;d<f;d++){var g=b.intersectLinePolygon(a[d],a[(d+1)%f],c);e.appendPoints(g.points)}0<e.points.length&&(e.status="Intersection");return e},k.Intersection.intersectPolygonRectangle=function(a,c,e){var f=c.min(e),d=c.max(e);e=new k.Point(d.x,f.y);var g=new k.Point(f.x,d.y);c=b.intersectLinePolygon(f,e,a);e=b.intersectLinePolygon(e,d,a);d=b.intersectLinePolygon(d,g,a);
a=b.intersectLinePolygon(g,f,a);f=new b;f.appendPoints(c.points);f.appendPoints(e.points);f.appendPoints(d.points);f.appendPoints(a.points);0<f.points.length&&(f.status="Intersection");return f})})("undefined"!==typeof b?b:this);(function(a){function b(c){c?this._tryParsingColor(c):this.setSource([0,0,0,1])}function k(c,a,f){0>f&&(f+=1);1<f&&--f;return f<1/6?c+6*(a-c)*f:.5>f?a:f<2/3?c+(a-c)*(2/3-f)*6:c}var g=a.fabric||(a.fabric={});g.Color?g.warn("fabric.Color is already defined."):(g.Color=b,g.Color.prototype=
{_tryParsingColor:function(c){var a;c in b.colorNameMap&&(c=b.colorNameMap[c]);"transparent"===c?this.setSource([255,255,255,0]):((a=b.sourceFromHex(c))||(a=b.sourceFromRgb(c)),a||(a=b.sourceFromHsl(c)),a&&this.setSource(a))},_rgbToHsl:function(c,a,f){c/=255;a/=255;f/=255;var d=g.util.array.max([c,a,f]);var b=g.util.array.min([c,a,f]);var e=(d+b)/2;if(d===b)var h=b=0;else{var k=d-b;b=.5<e?k/(2-d-b):k/(d+b);switch(d){case c:h=(a-f)/k+(a<f?6:0);break;case a:h=(f-c)/k+2;break;case f:h=(c-a)/k+4}h/=6}return[Math.round(360*
h),Math.round(100*b),Math.round(100*e)]},getSource:function(){return this._source},setSource:function(c){this._source=c},toRgb:function(){var c=this.getSource();return"rgb("+c[0]+","+c[1]+","+c[2]+")"},toRgba:function(){var c=this.getSource();return"rgba("+c[0]+","+c[1]+","+c[2]+","+c[3]+")"},toHsl:function(){var c=this.getSource();c=this._rgbToHsl(c[0],c[1],c[2]);return"hsl("+c[0]+","+c[1]+"%,"+c[2]+"%)"},toHsla:function(){var c=this.getSource(),a=this._rgbToHsl(c[0],c[1],c[2]);return"hsla("+a[0]+
","+a[1]+"%,"+a[2]+"%,"+c[3]+")"},toHex:function(){var c=this.getSource();var a=c[0].toString(16);a=1===a.length?"0"+a:a;var f=c[1].toString(16);f=1===f.length?"0"+f:f;c=c[2].toString(16);c=1===c.length?"0"+c:c;return a.toUpperCase()+f.toUpperCase()+c.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(c){var a=this.getSource();a[3]=c;this.setSource(a);return this},toGrayscale:function(){var c=this.getSource(),a=parseInt((.3*c[0]+.59*c[1]+.11*c[2]).toFixed(0),10);this.setSource([a,
a,a,c[3]]);return this},toBlackWhite:function(c){var a=this.getSource(),f=(.3*a[0]+.59*a[1]+.11*a[2]).toFixed(0);a=a[3];f=Number(f)<Number(c||127)?0:255;this.setSource([f,f,f,a]);return this},overlayWith:function(c){c instanceof b||(c=new b(c));var a=[],f=this.getAlpha(),d=this.getSource();c=c.getSource();for(var g=0;3>g;g++)a.push(Math.round(.5*d[g]+.5*c[g]));a[3]=f;this.setSource(a);return this}},g.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/,
g.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/,g.Color.reHex=/^#?([0-9a-f]{6}|[0-9a-f]{3})$/i,g.Color.colorNameMap={aqua:"#00FFFF",black:"#000000",blue:"#0000FF",fuchsia:"#FF00FF",gray:"#808080",green:"#008000",lime:"#00FF00",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#FFA500",purple:"#800080",red:"#FF0000",silver:"#C0C0C0",teal:"#008080",white:"#FFFFFF",yellow:"#FFFF00"},g.Color.fromRgb=function(c){return b.fromSource(b.sourceFromRgb(c))},
g.Color.sourceFromRgb=function(c){if(c=c.match(b.reRGBa)){var a=parseInt(c[1],10)/(/%$/.test(c[1])?100:1)*(/%$/.test(c[1])?255:1),f=parseInt(c[2],10)/(/%$/.test(c[2])?100:1)*(/%$/.test(c[2])?255:1),d=parseInt(c[3],10)/(/%$/.test(c[3])?100:1)*(/%$/.test(c[3])?255:1);return[parseInt(a,10),parseInt(f,10),parseInt(d,10),c[4]?parseFloat(c[4]):1]}},g.Color.fromRgba=b.fromRgb,g.Color.fromHsl=function(c){return b.fromSource(b.sourceFromHsl(c))},g.Color.sourceFromHsl=function(c){if(c=c.match(b.reHSLa)){var a=
(parseFloat(c[1])%360+360)%360/360,f=parseFloat(c[2])/(/%$/.test(c[2])?100:1),d=parseFloat(c[3])/(/%$/.test(c[3])?100:1);if(0===f)d=f=a=d;else{var g=.5>=d?d*(f+1):d+f-d*f,h=2*d-g;d=k(h,g,a+1/3);f=k(h,g,a);a=k(h,g,a-1/3)}return[Math.round(255*d),Math.round(255*f),Math.round(255*a),c[4]?parseFloat(c[4]):1]}},g.Color.fromHsla=b.fromHsl,g.Color.fromHex=function(c){return b.fromSource(b.sourceFromHex(c))},g.Color.sourceFromHex=function(c){if(c.match(b.reHex)){var a=c.slice(c.indexOf("#")+1),f=3===a.length;
c=f?a.charAt(0)+a.charAt(0):a.substring(0,2);var d=f?a.charAt(1)+a.charAt(1):a.substring(2,4);a=f?a.charAt(2)+a.charAt(2):a.substring(4,6);return[parseInt(c,16),parseInt(d,16),parseInt(a,16),1]}},g.Color.fromSource=function(c){var a=new b;a.setSource(c);return a})})("undefined"!==typeof b?b:this);(function(){if(a.StaticCanvas)a.warn("fabric.StaticCanvas is already defined.");else{var b=a.util.object.extend,h=a.util.getElementOffset,k=a.util.removeFromArray,g=Error("Could not initialize `canvas` element");
a.StaticCanvas=a.util.createClass({initialize:function(c,b){b||(b={});this._initStatic(c,b);a.StaticCanvas.activeInstance=this},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!0,renderOnAddRemove:!0,clipTo:null,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,preserveObjectStacking:!1,viewportTransform:[1,0,0,1,0,0],onBeforeScaleRotate:function(){},_initStatic:function(c,a){this._objects=[];this._createLowerCanvas(c);
this._initOptions(a);this._setImageSmoothing();a.overlayImage&&this.setOverlayImage(a.overlayImage,this.renderAll.bind(this));a.backgroundImage&&this.setBackgroundImage(a.backgroundImage,this.renderAll.bind(this));a.backgroundColor&&this.setBackgroundColor(a.backgroundColor,this.renderAll.bind(this));a.overlayColor&&this.setOverlayColor(a.overlayColor,this.renderAll.bind(this));this.calcOffset()},calcOffset:function(){this._offset=h(this.lowerCanvasEl);return this},setOverlayImage:function(c,a,f){return this.__setBgOverlayImage("overlayImage",
c,a,f)},setBackgroundImage:function(c,a,f){return this.__setBgOverlayImage("backgroundImage",c,a,f)},setOverlayColor:function(c,a){return this.__setBgOverlayColor("overlayColor",c,a)},setBackgroundColor:function(c,a){return this.__setBgOverlayColor("backgroundColor",c,a)},_setImageSmoothing:function(){var c=this.getContext();c.imageSmoothingEnabled=this.imageSmoothingEnabled;c.webkitImageSmoothingEnabled=this.imageSmoothingEnabled;c.mozImageSmoothingEnabled=this.imageSmoothingEnabled;c.msImageSmoothingEnabled=
this.imageSmoothingEnabled;c.oImageSmoothingEnabled=this.imageSmoothingEnabled},__setBgOverlayImage:function(c,b,f,d){"string"===typeof b?a.util.loadImage(b,function(b){this[c]=new a.Image(b,d);f&&f()},this,d&&d.crossOrigin):(d&&b.setOptions(d),this[c]=b,f&&f());return this},__setBgOverlayColor:function(c,b,f){if(b&&b.source){var d=this;a.util.loadImage(b.source,function(e){d[c]=new a.Pattern({source:e,repeat:b.repeat,offsetX:b.offsetX,offsetY:b.offsetY});f&&f()})}else this[c]=b,f&&f();return this},
_createCanvasElement:function(){var c=a.document.createElement("canvas");c.style||(c.style={});if(!c)throw g;this._initCanvasElement(c);return c},_initCanvasElement:function(c){a.util.createCanvasElement(c);if("undefined"===typeof c.getContext)throw g;},_initOptions:function(c){for(var a in c)this[a]=c[a];this.width=this.width||parseInt(this.lowerCanvasEl.width,10)||0;this.height=this.height||parseInt(this.lowerCanvasEl.height,10)||0;this.lowerCanvasEl.style&&(this.lowerCanvasEl.width=this.width,
this.lowerCanvasEl.height=this.height,this.lowerCanvasEl.style.width=this.width+"px",this.lowerCanvasEl.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(c){this.lowerCanvasEl=a.util.getById(c)||this._createCanvasElement();this._initCanvasElement(this.lowerCanvasEl);a.util.addClass(this.lowerCanvasEl,"lower-canvas");this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl);this.contextContainer=this.lowerCanvasEl.getContext("2d")},
getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(a,b){return this.setDimensions({width:a},b)},setHeight:function(a,b){return this.setDimensions({height:a},b)},setDimensions:function(a,b){b=b||{};for(var c in a){var d=a[c];b.cssOnly||(this._setBackstoreDimension(c,a[c]),d+="px");b.backstoreOnly||this._setCssDimension(c,d)}b.cssOnly||this.renderAll();this.calcOffset();return this},_setBackstoreDimension:function(a,b){this.lowerCanvasEl[a]=b;this.upperCanvasEl&&
(this.upperCanvasEl[a]=b);this.cacheCanvasEl&&(this.cacheCanvasEl[a]=b);this[a]=b;return this},_setCssDimension:function(a,b){this.lowerCanvasEl.style[a]=b;this.upperCanvasEl&&(this.upperCanvasEl.style[a]=b);this.wrapperEl&&(this.wrapperEl.style[a]=b);return this},getZoom:function(){return Math.sqrt(this.viewportTransform[0]*this.viewportTransform[3])},setViewportTransform:function(a){var c=this.getActiveGroup();this.viewportTransform=a;this.renderAll();a=0;for(var f=this._objects.length;a<f;a++)this._objects[a].setCoords();
c&&c.setCoords();return this},zoomToPoint:function(c,b){var f=c;c=a.util.transformPoint(c,a.util.invertTransform(this.viewportTransform));this.viewportTransform[0]=b;this.viewportTransform[3]=b;c=a.util.transformPoint(c,this.viewportTransform);this.viewportTransform[4]+=f.x-c.x;this.viewportTransform[5]+=f.y-c.y;this.renderAll();f=0;for(c=this._objects.length;f<c;f++)this._objects[f].setCoords();return this},setZoom:function(c){this.zoomToPoint(new a.Point(0,0),c);return this},absolutePan:function(a){this.viewportTransform[4]=
-a.x;this.viewportTransform[5]=-a.y;this.renderAll();a=0;for(var c=this._objects.length;a<c;a++)this._objects[a].setCoords();return this},relativePan:function(c){return this.absolutePan(new a.Point(-c.x-this.viewportTransform[4],-c.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},getActiveObject:function(){return null},getActiveGroup:function(){return null},_draw:function(a,b){if(b){a.save();var c=this.viewportTransform;a.transform(c[0],c[1],c[2],c[3],c[4],c[5]);this._shouldRenderObject(b)&&
b.render(a);a.restore();this.controlsAboveOverlay||b._renderControls(a)}},_shouldRenderObject:function(a){return a?a!==this.getActiveGroup()||!this.preserveObjectStacking:!1},_onObjectAdded:function(a){this.stateful&&a.setupState();a.canvas=this;a.setCoords();this.fire("object:added",{target:a});a.fire("added")},_onObjectRemoved:function(a){this.getActiveObject()===a&&(this.fire("before:selection:cleared",{target:a}),this._discardActiveObject(),this.fire("selection:cleared"));this.fire("object:removed",
{target:a});a.fire("removed")},clearContext:function(a){a.clearRect(0,0,this.width,this.height);return this},getContext:function(){return this.contextContainer},clear:function(){this._objects.length=0;this.discardActiveGroup&&this.discardActiveGroup();this.discardActiveObject&&this.discardActiveObject();this.clearContext(this.contextContainer);this.contextTop&&this.clearContext(this.contextTop);this.fire("canvas:cleared");this.renderAll();return this},renderAll:function(c){var b=this[!0===c&&this.interactive?
"contextTop":"contextContainer"],f=this.getActiveGroup();this.contextTop&&this.selection&&!this._groupSelector&&this.clearContext(this.contextTop);c||this.clearContext(b);this.fire("before:render");this.clipTo&&a.util.clipContext(this,b);this._renderBackground(b);this._renderObjects(b,f);this._renderActiveGroup(b,f);this.clipTo&&b.restore();this._renderOverlay(b);this.controlsAboveOverlay&&this.interactive&&this.drawControls(b);this.fire("after:render");return this},_renderObjects:function(a,b){var f;
if(!b||this.preserveObjectStacking){var d=0;for(f=this._objects.length;d<f;++d)this._draw(a,this._objects[d])}else for(d=0,f=this._objects.length;d<f;++d)this._objects[d]&&!b.contains(this._objects[d])&&this._draw(a,this._objects[d])},_renderActiveGroup:function(a,b){if(b){var f=[];this.forEachObject(function(d){b.contains(d)&&f.push(d)});b._set("objects",f);this._draw(a,b)}},_renderBackground:function(a){this.backgroundColor&&(a.fillStyle=this.backgroundColor.toLive?this.backgroundColor.toLive(a):
this.backgroundColor,a.fillRect(this.backgroundColor.offsetX||0,this.backgroundColor.offsetY||0,this.width,this.height));this.backgroundImage&&this._draw(a,this.backgroundImage)},_renderOverlay:function(a){this.overlayColor&&(a.fillStyle=this.overlayColor.toLive?this.overlayColor.toLive(a):this.overlayColor,a.fillRect(this.overlayColor.offsetX||0,this.overlayColor.offsetY||0,this.width,this.height));this.overlayImage&&this._draw(a,this.overlayImage)},renderTop:function(){var a=this.contextTop||this.contextContainer;
this.clearContext(a);this.selection&&this._groupSelector&&this._drawSelection();var b=this.getActiveGroup();b&&b.render(a);this._renderOverlay(a);this.fire("after:render");return this},getCenter:function(){return{top:this.getHeight()/2,left:this.getWidth()/2}},centerObjectH:function(c){this._centerObject(c,new a.Point(this.getCenter().left,c.getCenterPoint().y));this.renderAll();return this},centerObjectV:function(c){this._centerObject(c,new a.Point(c.getCenterPoint().x,this.getCenter().top));this.renderAll();
return this},centerObject:function(c){var b=this.getCenter();this._centerObject(c,new a.Point(b.left,b.top));this.renderAll();return this},_centerObject:function(a,b){a.setPositionByOrigin(b,"center","center");return this},toDatalessJSON:function(a){return this.toDatalessObject(a)},toObject:function(a){return this._toObjectMethod("toObject",a)},toDatalessObject:function(a){return this._toObjectMethod("toDatalessObject",a)},_toObjectMethod:function(c,e){c={objects:this._toObjects(c,e)};b(c,this.__serializeBgOverlay());
a.util.populateWithProperties(this,c,e);return c},_toObjects:function(a,b){return this.getObjects().map(function(f){return this._toObject(f,a,b)},this)},_toObject:function(a,b,f){if(!this.includeDefaultValues){var d=a.includeDefaultValues;a.includeDefaultValues=!1}var c=this._realizeGroupTransformOnObject(a);b=a[b](f);this.includeDefaultValues||(a.includeDefaultValues=d);this._unwindGroupTransformOnObject(a,c);return b},_realizeGroupTransformOnObject:function(a){var c="angle flipX flipY height left scaleX scaleY top width".split(" ");
if(a.group&&a.group===this.getActiveGroup()){var f={};c.forEach(function(d){f[d]=a[d]});this.getActiveGroup().realizeTransform(a);return f}return null},_unwindGroupTransformOnObject:function(a,b){b&&a.set(b)},__serializeBgOverlay:function(){var a={background:this.backgroundColor&&this.backgroundColor.toObject?this.backgroundColor.toObject():this.backgroundColor};this.overlayColor&&(a.overlay=this.overlayColor.toObject?this.overlayColor.toObject():this.overlayColor);this.backgroundImage&&(a.backgroundImage=
this.backgroundImage.toObject());this.overlayImage&&(a.overlayImage=this.overlayImage.toObject());return a},svgViewportTransformation:!0,toSVG:function(a,b){a||(a={});var f=[];this._setSVGPreamble(f,a);this._setSVGHeader(f,a);this._setSVGBgOverlayColor(f,"backgroundColor");this._setSVGBgOverlayImage(f,"backgroundImage");this._setSVGObjects(f,b);this._setSVGBgOverlayColor(f,"overlayColor");this._setSVGBgOverlayImage(f,"overlayImage");f.push("</svg>");return f.join("")},_setSVGPreamble:function(a,b){b.suppressPreamble||
a.push('<?xml version="1.0" encoding="',b.encoding||"UTF-8",'" standalone="no" ?>','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ','"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n')},_setSVGHeader:function(c,b){if(b.viewBox){var f=b.viewBox.width;var d=b.viewBox.height}else if(f=this.width,d=this.height,!this.svgViewportTransformation){var e=this.viewportTransform;f/=e[0];d/=e[3]}c.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ',
'width="',f,'" ','height="',d,'" ',this.backgroundColor&&!this.backgroundColor.toLive?'style="background-color: '+this.backgroundColor+'" ':null,b.viewBox?'viewBox="'+b.viewBox.x+" "+b.viewBox.y+" "+b.viewBox.width+" "+b.viewBox.height+'" ':null,'xml:space="preserve">',"<desc>Created with Fabric.js ",a.version,"</desc>","<defs>",a.createSVGFontFacesMarkup(this.getObjects()),a.createSVGRefElementsMarkup(this),"</defs>")},_setSVGObjects:function(a,b){for(var f=0,d=this.getObjects(),c=d.length;f<c;f++){var e=
d[f],g=this._realizeGroupTransformOnObject(e);a.push(e.toSVG(b));this._unwindGroupTransformOnObject(e,g)}},_setSVGBgOverlayImage:function(a,b){this[b]&&this[b].toSVG&&a.push(this[b].toSVG())},_setSVGBgOverlayColor:function(a,b){this[b]&&this[b].source?a.push('<rect x="',this[b].offsetX,'" y="',this[b].offsetY,'" ','width="',"repeat-y"===this[b].repeat||"no-repeat"===this[b].repeat?this[b].source.width:this.width,'" height="',"repeat-x"===this[b].repeat||"no-repeat"===this[b].repeat?this[b].source.height:
this.height,'" fill="url(#'+b+'Pattern)"',"></rect>"):this[b]&&"overlayColor"===b&&a.push('<rect x="0" y="0" ','width="',this.width,'" height="',this.height,'" fill="',this[b],'"',"></rect>")},sendToBack:function(a){k(this._objects,a);this._objects.unshift(a);return this.renderAll&&this.renderAll()},bringToFront:function(a){k(this._objects,a);this._objects.push(a);return this.renderAll&&this.renderAll()},sendBackwards:function(a,b){var f=this._objects.indexOf(a);0!==f&&(b=this._findNewLowerIndex(a,
f,b),k(this._objects,a),this._objects.splice(b,0,a),this.renderAll&&this.renderAll());return this},_findNewLowerIndex:function(a,b,f){if(f)for(f=b,--b;0<=b;--b){if(a.intersectsWithObject(this._objects[b])||a.isContainedWithinObject(this._objects[b])||this._objects[b].isContainedWithinObject(a)){f=b;break}}else f=b-1;return f},bringForward:function(a,b){var f=this._objects.indexOf(a);f!==this._objects.length-1&&(b=this._findNewUpperIndex(a,f,b),k(this._objects,a),this._objects.splice(b,0,a),this.renderAll&&
this.renderAll());return this},_findNewUpperIndex:function(a,b,f){if(f)for(f=b,b+=1;b<this._objects.length;++b){if(a.intersectsWithObject(this._objects[b])||a.isContainedWithinObject(this._objects[b])||this._objects[b].isContainedWithinObject(a)){f=b;break}}else f=b+1;return f},moveTo:function(a,b){k(this._objects,a);this._objects.splice(b,0,a);return this.renderAll&&this.renderAll()},dispose:function(){this.clear();this.interactive&&this.removeListeners();return this},toString:function(){return"#<fabric.Canvas ("+
this.complexity()+"): { objects: "+this.getObjects().length+" }>"}});b(a.StaticCanvas.prototype,a.Observable);b(a.StaticCanvas.prototype,a.Collection);b(a.StaticCanvas.prototype,a.DataURLExporter);b(a.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(b){var c=a.util.createCanvasElement();if(!c||!c.getContext)return null;var f=c.getContext("2d");if(!f)return null;switch(b){case "getImageData":return"undefined"!==typeof f.getImageData;case "setLineDash":return"undefined"!==
typeof f.setLineDash;case "toDataURL":return"undefined"!==typeof c.toDataURL;case "toDataURLWithQuality":try{return c.toDataURL("image/jpeg",0),!0}catch(d){}return!1;default:return null}}});a.StaticCanvas.prototype.toJSON=a.StaticCanvas.prototype.toObject}})();(function(){var b=a.util.getPointer,h=a.util.degreesToRadians,k=a.util.radiansToDegrees,g=Math.atan2,c=Math.abs;a.Canvas=a.util.createClass(a.StaticCanvas,{initialize:function(b,d){d||(d={});this._initStatic(b,d);this._initInteractive();this._createCacheCanvas();
a.Canvas.activeInstance=this},uniScaleTransform:!1,centeredScaling:!1,centeredRotation:!1,interactive:!0,selection:!0,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",rotationCursor:"crosshair",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,_initInteractive:function(){this._groupSelector=
this._currentTransform=null;this._initWrapperElement();this._createUpperCanvas();this._initEventListeners();this.freeDrawingBrush=a.PencilBrush&&new a.PencilBrush(this);this.calcOffset()},_resetCurrentTransform:function(a){var d=this._currentTransform;d.target.set({scaleX:d.original.scaleX,scaleY:d.original.scaleY,left:d.original.left,top:d.original.top});this._shouldCenterTransform(a,d.target)?"rotate"===d.action?this._setOriginToCenter(d.target):("center"!==d.originX&&(d.mouseXSign="right"===d.originX?
-1:1),"center"!==d.originY&&(d.mouseYSign="bottom"===d.originY?-1:1),d.originX="center",d.originY="center"):(d.originX=d.original.originX,d.originY=d.original.originY)},containsPoint:function(a,d){a=this.getPointer(a,!0);var b=this._normalizePointer(d,a);return d.containsPoint(b)||d._findTargetCorner(a)},_normalizePointer:function(b,d){var f=this.getActiveGroup(),c=d.x;d=d.y;f&&"group"!==b.type&&f.contains(b)&&(b=new a.Point(f.left,f.top),b=a.util.transformPoint(b,this.viewportTransform,!0),c-=b.x,
d-=b.y);return{x:c,y:d}},isTargetTransparent:function(b,d,c){var f=b.hasBorders,e=b.transparentCorners;b.hasBorders=b.transparentCorners=!1;this._draw(this.contextCache,b);b.hasBorders=f;b.transparentCorners=e;b=a.util.isTransparent(this.contextCache,d,c,this.targetFindTolerance);this.clearContext(this.contextCache);return b},_shouldClearSelection:function(a,d){var b=this.getActiveGroup(),f=this.getActiveObject();return!d||d&&b&&!b.contains(d)&&b!==d&&!a.shiftKey||d&&!d.evented||d&&!d.selectable&&
f&&f!==d},_shouldCenterTransform:function(a,d){if(d){var b=this._currentTransform,f;"scale"===b.action||"scaleX"===b.action||"scaleY"===b.action?f=this.centeredScaling||d.centeredScaling:"rotate"===b.action&&(f=this.centeredRotation||d.centeredRotation);return f?!a.altKey:a.altKey}},_getOriginFromCorner:function(a,d){a={x:a.originX,y:a.originY};if("ml"===d||"tl"===d||"bl"===d)a.x="right";else if("mr"===d||"tr"===d||"br"===d)a.x="left";if("tl"===d||"mt"===d||"tr"===d)a.y="bottom";else if("bl"===d||
"mb"===d||"br"===d)a.y="top";return a},_getActionFromCorner:function(a,d){a="drag";d&&(a="ml"===d||"mr"===d?"scaleX":"mt"===d||"mb"===d?"scaleY":"mtr"===d?"rotate":"scale");return a},_setupCurrentTransform:function(a,d){if(d){var b=this.getPointer(a),f=d._findTargetCorner(this.getPointer(a,!0)),c=this._getActionFromCorner(d,f);f=this._getOriginFromCorner(d,f);this._currentTransform={target:d,action:c,scaleX:d.scaleX,scaleY:d.scaleY,offsetX:b.x-d.left,offsetY:b.y-d.top,originX:f.x,originY:f.y,ex:b.x,
ey:b.y,left:d.left,top:d.top,theta:h(d.angle),width:d.width*d.scaleX,mouseXSign:1,mouseYSign:1};this._currentTransform.original={left:d.left,top:d.top,scaleX:d.scaleX,scaleY:d.scaleY,originX:f.x,originY:f.y};this._resetCurrentTransform(a)}},_translateObject:function(a,d){var b=this._currentTransform.target;b.get("lockMovementX")||b.set("left",a-this._currentTransform.offsetX);b.get("lockMovementY")||b.set("top",d-this._currentTransform.offsetY)},_scaleObject:function(b,d,c){var f=this._currentTransform,
e=f.target,g=e.get("lockScalingX"),h=e.get("lockScalingY"),k=e.get("lockScalingFlip");if(!g||!h){var q=e.translateToOriginPoint(e.getCenterPoint(),f.originX,f.originY);b=e.toLocalPoint(new a.Point(b,d),f.originX,f.originY);this._setLocalMouse(b,f);this._setObjectScale(b,f,g,h,c,k);e.setPositionByOrigin(q,f.originX,f.originY)}},_setObjectScale:function(a,d,b,c,e,g){var f=d.target,h=!1,k=!1,q=f.stroke?f.strokeWidth:0;d.newScaleX=a.x/(f.width+q/2);d.newScaleY=a.y/(f.height+q/2);g&&0>=d.newScaleX&&d.newScaleX<
f.scaleX&&(h=!0);g&&0>=d.newScaleY&&d.newScaleY<f.scaleY&&(k=!0);"equally"!==e||b||c?e?"x"!==e||f.get("lockUniScaling")?"y"!==e||f.get("lockUniScaling")||k||c||f.set("scaleY",d.newScaleY):h||b||f.set("scaleX",d.newScaleX):(h||b||f.set("scaleX",d.newScaleX),k||c||f.set("scaleY",d.newScaleY)):h||k||this._scaleObjectEqually(a,f,d);h||k||this._flipObject(d,e)},_scaleObjectEqually:function(a,d,b){a=a.y+a.x;var f=d.stroke?d.strokeWidth:0;f=(d.height+f/2)*b.original.scaleY+(d.width+f/2)*b.original.scaleX;
b.newScaleX=b.original.scaleX*a/f;b.newScaleY=b.original.scaleY*a/f;d.set("scaleX",b.newScaleX);d.set("scaleY",b.newScaleY)},_flipObject:function(a,d){0>a.newScaleX&&"y"!==d&&("left"===a.originX?a.originX="right":"right"===a.originX&&(a.originX="left"));0>a.newScaleY&&"x"!==d&&("top"===a.originY?a.originY="bottom":"bottom"===a.originY&&(a.originY="top"))},_setLocalMouse:function(a,d){var b=d.target;"right"===d.originX?a.x*=-1:"center"===d.originX&&(a.x=2*a.x*d.mouseXSign,0>a.x&&(d.mouseXSign=-d.mouseXSign));
"bottom"===d.originY?a.y*=-1:"center"===d.originY&&(a.y=2*a.y*d.mouseYSign,0>a.y&&(d.mouseYSign=-d.mouseYSign));c(a.x)>b.padding?a.x=0>a.x?a.x+b.padding:a.x-b.padding:a.x=0;c(a.y)>b.padding?a.y=0>a.y?a.y+b.padding:a.y-b.padding:a.y=0},_rotateObject:function(a,d){var b=this._currentTransform;if(!b.target.get("lockRotation")){var f=g(b.ey-b.top,b.ex-b.left);a=g(d-b.top,a-b.left);f=k(a-f+b.theta);0>f&&(f=360+f);b.target.angle=f%360}},setCursor:function(a){this.upperCanvasEl.style.cursor=a},_resetObjectTransform:function(a){a.scaleX=
1;a.scaleY=1;a.setAngle(0)},_drawSelection:function(){var b=this.contextTop,d=this._groupSelector,e=d.left,g=d.top,h=c(e),k=c(g);b.fillStyle=this.selectionColor;b.fillRect(d.ex-(0<e?0:-e),d.ey-(0<g?0:-g),h,k);b.lineWidth=this.selectionLineWidth;b.strokeStyle=this.selectionBorderColor;1<this.selectionDashArray.length?(e=d.ex+.5-(0<e?0:h),d=d.ey+.5-(0<g?0:k),b.beginPath(),a.util.drawDashedLine(b,e,d,e+h,d,this.selectionDashArray),a.util.drawDashedLine(b,e,d+k-1,e+h,d+k-1,this.selectionDashArray),a.util.drawDashedLine(b,
e,d,e,d+k,this.selectionDashArray),a.util.drawDashedLine(b,e+h-1,d,e+h-1,d+k,this.selectionDashArray),b.closePath(),b.stroke()):b.strokeRect(d.ex+.5-(0<e?0:h),d.ey+.5-(0<g?0:k),h,k)},_isLastRenderedObject:function(a){return this.controlsAboveOverlay&&this.lastRenderedObjectWithControlsAboveOverlay&&this.lastRenderedObjectWithControlsAboveOverlay.visible&&this.containsPoint(a,this.lastRenderedObjectWithControlsAboveOverlay)&&this.lastRenderedObjectWithControlsAboveOverlay._findTargetCorner(this.getPointer(a,
!0))},findTarget:function(a,d){if(!this.skipTargetFind){if(this._isLastRenderedObject(a))return this.lastRenderedObjectWithControlsAboveOverlay;var b=this.getActiveGroup();if(b&&!d&&this.containsPoint(a,b))return b;a=this._searchPossibleTargets(a);this._fireOverOutEvents(a);return a}},_fireOverOutEvents:function(a){a?this._hoveredTarget!==a&&(this.fire("mouse:over",{target:a}),a.fire("mouseover"),this._hoveredTarget&&(this.fire("mouse:out",{target:this._hoveredTarget}),this._hoveredTarget.fire("mouseout")),
this._hoveredTarget=a):this._hoveredTarget&&(this.fire("mouse:out",{target:this._hoveredTarget}),this._hoveredTarget.fire("mouseout"),this._hoveredTarget=null)},_checkTarget:function(a,d,b){if(d&&d.visible&&d.evented&&this.containsPoint(a,d)&&(!this.perPixelTargetFind&&!d.perPixelTargetFind||d.isEditing||!this.isTargetTransparent(d,b.x,b.y)))return!0},_searchPossibleTargets:function(a){for(var d,b=this.getPointer(a,!0),c=this._objects.length;c--;)if(!this._objects[c].group&&this._checkTarget(a,this._objects[c],
b)){this.relatedTarget=this._objects[c];d=this._objects[c];break}return d},getPointer:function(c,d,e){e||(e=this.upperCanvasEl);c=b(c,e);var f=e.getBoundingClientRect(),g=f.width||0,h=f.height||0;g&&h||("top"in f&&"bottom"in f&&(h=Math.abs(f.top-f.bottom)),"right"in f&&"left"in f&&(g=Math.abs(f.right-f.left)));this.calcOffset();c.x-=this._offset.left;c.y-=this._offset.top;d||(c=a.util.transformPoint(c,a.util.invertTransform(this.viewportTransform)));0===g||0===h?e=d=1:(d=e.width/g,e=e.height/h);return{x:c.x*
d,y:c.y*e}},_createUpperCanvas:function(){var b=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,"");this.upperCanvasEl=this._createCanvasElement();a.util.addClass(this.upperCanvasEl,"upper-canvas "+b);this.wrapperEl.appendChild(this.upperCanvasEl);this._copyCanvasStyle(this.lowerCanvasEl,this.upperCanvasEl);this._applyCanvasStyle(this.upperCanvasEl);this.contextTop=this.upperCanvasEl.getContext("2d")},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement();this.cacheCanvasEl.setAttribute("width",
this.width);this.cacheCanvasEl.setAttribute("height",this.height);this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=a.util.wrapElement(this.lowerCanvasEl,"div",{"class":this.containerClass});a.util.setStyle(this.wrapperEl,{width:this.getWidth()+"px",height:this.getHeight()+"px",position:"relative"});a.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(b){var d=this.getWidth()||b.width,c=this.getHeight()||b.height;a.util.setStyle(b,
{position:"absolute",width:d+"px",height:c+"px",left:0,top:0});b.width=d;b.height=c;a.util.makeElementUnselectable(b)},_copyCanvasStyle:function(a,d){d.style.cssText=a.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},_setActiveObject:function(a){this._activeObject&&this._activeObject.set("active",!1);this._activeObject=a;a.set("active",!0)},setActiveObject:function(a,d){this._setActiveObject(a);this.renderAll();this.fire("object:selected",
{target:a,e:d});a.fire("selected",{e:d});return this},getActiveObject:function(){return this._activeObject},_discardActiveObject:function(){this._activeObject&&this._activeObject.set("active",!1);this._activeObject=null},discardActiveObject:function(a){this._discardActiveObject();this.renderAll();this.fire("selection:cleared",{e:a});return this},_setActiveGroup:function(a){(this._activeGroup=a)&&a.set("active",!0)},setActiveGroup:function(a,d){this._setActiveGroup(a);a&&(this.fire("object:selected",
{target:a,e:d}),a.fire("selected",{e:d}));return this},getActiveGroup:function(){return this._activeGroup},_discardActiveGroup:function(){var a=this.getActiveGroup();a&&a.destroy();this.setActiveGroup(null)},discardActiveGroup:function(a){this._discardActiveGroup();this.fire("selection:cleared",{e:a});return this},deactivateAll:function(){for(var a=this.getObjects(),d=0,b=a.length;d<b;d++)a[d].set("active",!1);this._discardActiveGroup();this._discardActiveObject();return this},deactivateAllWithDispatch:function(a){var d=
this.getActiveGroup()||this.getActiveObject();d&&this.fire("before:selection:cleared",{target:d,e:a});this.deactivateAll();d&&this.fire("selection:cleared",{e:a});return this},drawControls:function(a){var d=this.getActiveGroup();d?this._drawGroupControls(a,d):this._drawObjectsControls(a)},_drawGroupControls:function(a,d){d._renderControls(a)},_drawObjectsControls:function(a){for(var d=0,b=this._objects.length;d<b;++d)this._objects[d]&&this._objects[d].active&&(this._objects[d]._renderControls(a),
this.lastRenderedObjectWithControlsAboveOverlay=this._objects[d])}});for(var e in a.StaticCanvas)"prototype"!==e&&(a.Canvas[e]=a.StaticCanvas[e]);a.isTouchSupported&&(a.Canvas.prototype._setCursorFromEvent=function(){});a.Element=a.Canvas})();(function(){var b={mt:0,tr:1,mr:2,br:3,mb:4,bl:5,ml:6,tl:7},h=a.util.addListener,k=a.util.removeListener;a.util.object.extend(a.Canvas.prototype,{cursorMap:"n-resize ne-resize e-resize se-resize s-resize sw-resize w-resize nw-resize".split(" "),_initEventListeners:function(){this._bindEvents();
h(a.window,"resize",this._onResize);h(this.upperCanvasEl,"mousedown",this._onMouseDown);h(this.upperCanvasEl,"mousemove",this._onMouseMove);h(this.upperCanvasEl,"mousewheel",this._onMouseWheel);h(this.upperCanvasEl,"touchstart",this._onMouseDown);h(this.upperCanvasEl,"touchmove",this._onMouseMove);"undefined"!==typeof eventjs&&"add"in eventjs&&(eventjs.add(this.upperCanvasEl,"gesture",this._onGesture),eventjs.add(this.upperCanvasEl,"drag",this._onDrag),eventjs.add(this.upperCanvasEl,"orientation",
this._onOrientationChange),eventjs.add(this.upperCanvasEl,"shake",this._onShake),eventjs.add(this.upperCanvasEl,"longpress",this._onLongPress))},_bindEvents:function(){this._onMouseDown=this._onMouseDown.bind(this);this._onMouseMove=this._onMouseMove.bind(this);this._onMouseUp=this._onMouseUp.bind(this);this._onResize=this._onResize.bind(this);this._onGesture=this._onGesture.bind(this);this._onDrag=this._onDrag.bind(this);this._onShake=this._onShake.bind(this);this._onLongPress=this._onLongPress.bind(this);
this._onOrientationChange=this._onOrientationChange.bind(this);this._onMouseWheel=this._onMouseWheel.bind(this)},removeListeners:function(){k(a.window,"resize",this._onResize);k(this.upperCanvasEl,"mousedown",this._onMouseDown);k(this.upperCanvasEl,"mousemove",this._onMouseMove);k(this.upperCanvasEl,"mousewheel",this._onMouseWheel);k(this.upperCanvasEl,"touchstart",this._onMouseDown);k(this.upperCanvasEl,"touchmove",this._onMouseMove);"undefined"!==typeof eventjs&&"remove"in eventjs&&(eventjs.remove(this.upperCanvasEl,
"gesture",this._onGesture),eventjs.remove(this.upperCanvasEl,"drag",this._onDrag),eventjs.remove(this.upperCanvasEl,"orientation",this._onOrientationChange),eventjs.remove(this.upperCanvasEl,"shake",this._onShake),eventjs.remove(this.upperCanvasEl,"longpress",this._onLongPress))},_onGesture:function(a,b){this.__onTransformGesture&&this.__onTransformGesture(a,b)},_onDrag:function(a,b){this.__onDrag&&this.__onDrag(a,b)},_onMouseWheel:function(a,b){this.__onMouseWheel&&this.__onMouseWheel(a,b)},_onOrientationChange:function(a,
b){this.__onOrientationChange&&this.__onOrientationChange(a,b)},_onShake:function(a,b){this.__onShake&&this.__onShake(a,b)},_onLongPress:function(a,b){this.__onLongPress&&this.__onLongPress(a,b)},_onMouseDown:function(b){this.__onMouseDown(b);h(a.document,"touchend",this._onMouseUp);h(a.document,"touchmove",this._onMouseMove);k(this.upperCanvasEl,"mousemove",this._onMouseMove);k(this.upperCanvasEl,"touchmove",this._onMouseMove);"touchstart"===b.type?k(this.upperCanvasEl,"mousedown",this._onMouseDown):
(h(a.document,"mouseup",this._onMouseUp),h(a.document,"mousemove",this._onMouseMove))},_onMouseUp:function(b){this.__onMouseUp(b);k(a.document,"mouseup",this._onMouseUp);k(a.document,"touchend",this._onMouseUp);k(a.document,"mousemove",this._onMouseMove);k(a.document,"touchmove",this._onMouseMove);h(this.upperCanvasEl,"mousemove",this._onMouseMove);h(this.upperCanvasEl,"touchmove",this._onMouseMove);if("touchend"===b.type){var c=this;setTimeout(function(){h(c.upperCanvasEl,"mousedown",c._onMouseDown)},
400)}},_onMouseMove:function(a){!this.allowTouchScrolling&&a.preventDefault&&a.preventDefault();this.__onMouseMove(a)},_onResize:function(){this.calcOffset()},_shouldRender:function(a,b){var c=this.getActiveGroup()||this.getActiveObject();return!!(a&&(a.isMoving||a!==c)||!a&&c||!a&&!c&&!this._groupSelector||b&&this._previousPointer&&this.selection&&(b.x!==this._previousPointer.x||b.y!==this._previousPointer.y))},__onMouseUp:function(a){if(this.isDrawingMode&&this._isCurrentlyDrawing)this._onMouseUpInDrawingMode(a);
else{if(this._currentTransform){this._finalizeCurrentTransform();var b=this._currentTransform.target}else b=this.findTarget(a,!0);var e=this._shouldRender(b,this.getPointer(a));this._maybeGroupObjects(a);b&&(b.isMoving=!1);e&&this.renderAll();this._handleCursorAndEvent(a,b)}},_handleCursorAndEvent:function(a,b){this._setCursorFromEvent(a,b);var c=this;setTimeout(function(){c._setCursorFromEvent(a,b)},50);this.fire("mouse:up",{target:b,e:a});b&&b.fire("mouseup",{e:a})},_finalizeCurrentTransform:function(){var a=
this._currentTransform.target;a._scaling&&(a._scaling=!1);a.setCoords();this.stateful&&a.hasStateChanged()&&(this.fire("object:modified",{target:a}),a.fire("modified"));this._restoreOriginXY(a)},_restoreOriginXY:function(a){if(this._previousOriginX&&this._previousOriginY){var b=a.translateToOriginPoint(a.getCenterPoint(),this._previousOriginX,this._previousOriginY);a.originX=this._previousOriginX;a.originY=this._previousOriginY;a.left=b.x;a.top=b.y;this._previousOriginY=this._previousOriginX=null}},
_onMouseDownInDrawingMode:function(b){this._isCurrentlyDrawing=!0;this.discardActiveObject(b).renderAll();this.clipTo&&a.util.clipContext(this,this.contextTop);var c=a.util.invertTransform(this.viewportTransform);c=a.util.transformPoint(this.getPointer(b,!0),c);this.freeDrawingBrush.onMouseDown(c);this.fire("mouse:down",{e:b});c=this.findTarget(b);"undefined"!==typeof c&&c.fire("mousedown",{e:b,target:c})},_onMouseMoveInDrawingMode:function(b){if(this._isCurrentlyDrawing){var c=a.util.invertTransform(this.viewportTransform);
c=a.util.transformPoint(this.getPointer(b,!0),c);this.freeDrawingBrush.onMouseMove(c)}this.setCursor(this.freeDrawingCursor);this.fire("mouse:move",{e:b});c=this.findTarget(b);"undefined"!==typeof c&&c.fire("mousemove",{e:b,target:c})},_onMouseUpInDrawingMode:function(a){this._isCurrentlyDrawing=!1;this.clipTo&&this.contextTop.restore();this.freeDrawingBrush.onMouseUp();this.fire("mouse:up",{e:a});var b=this.findTarget(a);"undefined"!==typeof b&&b.fire("mouseup",{e:a,target:b})},__onMouseDown:function(b){if(("which"in
b?1===b.which:1===b.button)||a.isTouchSupported)if(this.isDrawingMode)this._onMouseDownInDrawingMode(b);else if(!this._currentTransform){var c=this.findTarget(b),e=this.getPointer(b,!0);this._previousPointer=e;var f=this._shouldRender(c,e),d=this._shouldGroup(b,c);this._shouldClearSelection(b,c)?this._clearSelection(b,c,e):d&&(this._handleGrouping(b,c),c=this.getActiveGroup());c&&c.selectable&&!d&&(this._beforeTransform(b,c),this._setupCurrentTransform(b,c));f&&this.renderAll();this.fire("mouse:down",
{target:c,e:b});c&&c.fire("mousedown",{e:b})}},_beforeTransform:function(a,b){this.stateful&&b.saveState();if(b._findTargetCorner(this.getPointer(a)))this.onBeforeScaleRotate(b);b!==this.getActiveGroup()&&b!==this.getActiveObject()&&(this.deactivateAll(),this.setActiveObject(b,a))},_clearSelection:function(a,b,e){this.deactivateAllWithDispatch(a);b&&b.selectable?this.setActiveObject(b,a):this.selection&&(this._groupSelector={ex:e.x,ey:e.y,top:0,left:0})},_setOriginToCenter:function(a){this._previousOriginX=
this._currentTransform.target.originX;this._previousOriginY=this._currentTransform.target.originY;var b=a.getCenterPoint();a.originX="center";a.originY="center";a.left=b.x;a.top=b.y;this._currentTransform.left=a.left;this._currentTransform.top=a.top},_setCenterToOrigin:function(a){var b=a.translateToOriginPoint(a.getCenterPoint(),this._previousOriginX,this._previousOriginY);a.originX=this._previousOriginX;a.originY=this._previousOriginY;a.left=b.x;a.top=b.y;this._previousOriginY=this._previousOriginX=
null},__onMouseMove:function(a){if(this.isDrawingMode)this._onMouseMoveInDrawingMode(a);else if(!("undefined"!==typeof a.touches&&1<a.touches.length)){var b=this._groupSelector;if(b){var e=this.getPointer(a,!0);b.left=e.x-b.ex;b.top=e.y-b.ey;this.renderTop()}else if(this._currentTransform)this._transformObject(a);else{var f=this.findTarget(a);!f||f&&!f.selectable?this.setCursor(this.defaultCursor):this._setCursorFromEvent(a,f)}this.fire("mouse:move",{target:f,e:a});f&&f.fire("mousemove",{e:a})}},
_transformObject:function(a){var b=this.getPointer(a),e=this._currentTransform;e.reset=!1;e.target.isMoving=!0;this._beforeScaleTransform(a,e);this._performTransformAction(a,e,b);this.renderAll()},_performTransformAction:function(a,b,e){var c=e.x;e=e.y;var d=b.target,h=b.action;"rotate"===h?(this._rotateObject(c,e),this._fire("rotating",d,a)):"scale"===h?(this._onScale(a,b,c,e),this._fire("scaling",d,a)):"scaleX"===h?(this._scaleObject(c,e,"x"),this._fire("scaling",d,a)):"scaleY"===h?(this._scaleObject(c,
e,"y"),this._fire("scaling",d,a)):(this._translateObject(c,e),this._fire("moving",d,a),this.setCursor(this.moveCursor))},_fire:function(a,b,e){this.fire("object:"+a,{target:b,e:e});b.fire(a,{e:e})},_beforeScaleTransform:function(a,b){if("scale"===b.action||"scaleX"===b.action||"scaleY"===b.action){var c=this._shouldCenterTransform(a,b.target);if(c&&("center"!==b.originX||"center"!==b.originY)||!c&&"center"===b.originX&&"center"===b.originY)this._resetCurrentTransform(a),b.reset=!0}},_onScale:function(a,
b,e,f){!a.shiftKey&&!this.uniScaleTransform||b.target.get("lockUniScaling")?(b.reset||"scale"!==b.currentAction||this._resetCurrentTransform(a,b.target),b.currentAction="scaleEqually",this._scaleObject(e,f,"equally")):(b.currentAction="scale",this._scaleObject(e,f))},_setCursorFromEvent:function(a,b){if(b&&b.selectable){var c=this.getActiveGroup();(a=b._findTargetCorner&&(!c||!c.contains(b))&&b._findTargetCorner(this.getPointer(a,!0)))?this._setCornerCursor(a,b):this.setCursor(b.hoverCursor||this.hoverCursor)}else return this.setCursor(this.defaultCursor),
!1;return!0},_setCornerCursor:function(a,c){if(a in b)this.setCursor(this._getRotatedCornerCursor(a,c));else if("mtr"===a&&c.hasRotatingPoint)this.setCursor(this.rotationCursor);else return this.setCursor(this.defaultCursor),!1},_getRotatedCornerCursor:function(a,c){c=Math.round(c.getAngle()%360/45);0>c&&(c+=8);c+=b[a];return this.cursorMap[c%8]}})})();(function(){var b=Math.min,h=Math.max;a.util.object.extend(a.Canvas.prototype,{_shouldGroup:function(a,b){var c=this.getActiveObject();return a.shiftKey&&
(this.getActiveGroup()||c&&c!==b)&&this.selection},_handleGrouping:function(a,b){if(b===this.getActiveGroup()&&(b=this.findTarget(a,!0),!b||b.isType("group")))return;this.getActiveGroup()?this._updateActiveGroup(b,a):this._createActiveGroup(b,a);this._activeGroup&&this._activeGroup.saveCoords()},_updateActiveGroup:function(a,b){var c=this.getActiveGroup();if(c.contains(a)){if(c.removeWithUpdate(a),this._resetObjectTransform(c),a.set("active",!1),1===c.size()){this.discardActiveGroup(b);this.setActiveObject(c.item(0));
return}}else c.addWithUpdate(a),this._resetObjectTransform(c);this.fire("selection:created",{target:c,e:b});c.set("active",!0)},_createActiveGroup:function(a,b){if(this._activeObject&&a!==this._activeObject){var c=this._createGroup(a);c.addWithUpdate();this.setActiveGroup(c);this._activeObject=null;this.fire("selection:created",{target:c,e:b})}a.set("active",!0)},_createGroup:function(b){var h=this.getObjects();b=h.indexOf(this._activeObject)<h.indexOf(b)?[this._activeObject,b]:[b,this._activeObject];
return new a.Group(b,{canvas:this})},_groupSelectedObjects:function(b){var h=this._collectObjects();1===h.length?this.setActiveObject(h[0],b):1<h.length&&(h=new a.Group(h.reverse(),{canvas:this}),h.addWithUpdate(),this.setActiveGroup(h,b),h.saveCoords(),this.fire("selection:created",{target:h}),this.renderAll())},_collectObjects:function(){var k=[];var g=this._groupSelector.ex;var c=this._groupSelector.ey,e=g+this._groupSelector.left,f=c+this._groupSelector.top,d=new a.Point(b(g,e),b(c,f)),q=new a.Point(h(g,
e),h(c,f));c=g===e&&c===f;for(e=this._objects.length;e--&&!((g=this._objects[e])&&g.selectable&&g.visible&&(g.intersectsWithRect(d,q)||g.isContainedWithinRect(d,q)||g.containsPoint(d)||g.containsPoint(q))&&(g.set("active",!0),k.push(g),c)););return k},_maybeGroupObjects:function(a){this.selection&&this._groupSelector&&this._groupSelectedObjects(a);if(a=this.getActiveGroup())a.setObjectsCoords().setCoords(),a.isMoving=!1,this.setCursor(this.defaultCursor);this._currentTransform=this._groupSelector=
null}})})();a.util.object.extend(a.StaticCanvas.prototype,{toDataURL:function(a){a||(a={});var b=a.format||"png",k=a.quality||1,g=a.multiplier||1;a={left:a.left,top:a.top,width:a.width,height:a.height};return 1!==g?this.__toDataURLWithMultiplier(b,k,a,g):this.__toDataURL(b,k,a)},__toDataURL:function(b,h,k){this.renderAll(!0);var g=this.upperCanvasEl||this.lowerCanvasEl;k=this.__getCroppedCanvas(g,k);"jpg"===b&&(b="jpeg");b=a.StaticCanvas.supports("toDataURLWithQuality")?(k||g).toDataURL("image/"+
b,h):(k||g).toDataURL("image/"+b);this.contextTop&&this.clearContext(this.contextTop);this.renderAll();return b},__getCroppedCanvas:function(b,h){if("left"in h||"top"in h||"width"in h||"height"in h){var k=a.util.createCanvasElement();var g=k.getContext("2d");k.width=h.width||this.width;k.height=h.height||this.height;g.drawImage(b,-h.left||0,-h.top||0)}return k},__toDataURLWithMultiplier:function(a,b,k,g){var c=this.getWidth(),e=this.getHeight(),f=c*g,d=e*g,h=this.getActiveObject(),u=this.getActiveGroup(),
l=this.contextTop||this.contextContainer;1<g&&this.setWidth(f).setHeight(d);l.scale(g,g);k.left&&(k.left*=g);k.top&&(k.top*=g);k.width?k.width*=g:1>g&&(k.width=f);k.height?k.height*=g:1>g&&(k.height=d);u?this._tempRemoveBordersControlsFromGroup(u):h&&this.deactivateAll&&this.deactivateAll();this.renderAll(!0);a=this.__toDataURL(a,b,k);this.width=c;this.height=e;l.scale(1/g,1/g);this.setWidth(c).setHeight(e);u?this._restoreBordersControlsOnGroup(u):h&&this.setActiveObject&&this.setActiveObject(h);
this.contextTop&&this.clearContext(this.contextTop);this.renderAll();return a},toDataURLWithMultiplier:function(a,b,k){return this.toDataURL({format:a,multiplier:b,quality:k})},_tempRemoveBordersControlsFromGroup:function(a){a.origHasControls=a.hasControls;a.origBorderColor=a.borderColor;a.hasControls=!0;a.borderColor="rgba(0,0,0,0)";a.forEachObject(function(a){a.origBorderColor=a.borderColor;a.borderColor="rgba(0,0,0,0)"})},_restoreBordersControlsOnGroup:function(a){a.hideControls=a.origHideControls;
a.borderColor=a.origBorderColor;a.forEachObject(function(a){a.borderColor=a.origBorderColor;delete a.origBorderColor})}});(function(a){var b=a.fabric||(a.fabric={});a=b.util.object.extend;var k=b.util.toFixed,g=b.util.string.capitalize,c=b.util.degreesToRadians,e=b.StaticCanvas.supports("setLineDash");b.Object||(b.Object=b.util.createClass({type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,cornerSize:12,transparentCorners:!0,
hoverCursor:null,padding:0,borderColor:"rgba(102,153,255,0.75)",cornerColor:"rgba(102,153,255,0.5)",centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:10,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,transformMatrix:null,minScaleLimit:.01,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,
hasRotatingPoint:!0,rotatingPointOffset:40,perPixelTargetFind:!1,includeDefaultValues:!0,clipTo:null,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockUniScaling:!1,lockScalingFlip:!1,stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeLineJoin strokeMiterLimit angle opacity fill fillRule globalCompositeOperation shadow clipTo visible backgroundColor".split(" "),
initialize:function(a){a&&this.setOptions(a)},_initGradient:function(a){!a.fill||!a.fill.colorStops||a.fill instanceof b.Gradient||this.set("fill",new b.Gradient(a.fill))},_initPattern:function(a){!a.fill||!a.fill.source||a.fill instanceof b.Pattern||this.set("fill",new b.Pattern(a.fill));!a.stroke||!a.stroke.source||a.stroke instanceof b.Pattern||this.set("stroke",new b.Pattern(a.stroke))},_initClipping:function(a){a.clipTo&&"string"===typeof a.clipTo&&(a=b.util.getFunctionBody(a.clipTo),"undefined"!==
typeof a&&(this.clipTo=new Function("ctx",a)))},setOptions:function(a){for(var b in a)this.set(b,a[b]);this._initGradient(a);this._initPattern(a);this._initClipping(a)},transform:function(a,b){b=b?this._getLeftTopCoords():this.getCenterPoint();a.translate(b.x,b.y);a.rotate(c(this.angle));a.scale(this.scaleX*(this.flipX?-1:1),this.scaleY*(this.flipY?-1:1))},toObject:function(a){var d=b.Object.NUM_FRACTION_DIGITS;d={type:this.type,originX:this.originX,originY:this.originY,left:k(this.left,d),top:k(this.top,
d),width:k(this.width,d),height:k(this.height,d),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:k(this.strokeWidth,d),strokeDashArray:this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:k(this.strokeMiterLimit,d),scaleX:k(this.scaleX,d),scaleY:k(this.scaleY,d),angle:k(this.getAngle(),d),flipX:this.flipX,flipY:this.flipY,opacity:k(this.opacity,
d),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,clipTo:this.clipTo&&String(this.clipTo),backgroundColor:this.backgroundColor,fillRule:this.fillRule,globalCompositeOperation:this.globalCompositeOperation};this.includeDefaultValues||(d=this._removeDefaultValues(d));b.util.populateWithProperties(this,d,a);return d},toDatalessObject:function(a){return this.toObject(a)},_removeDefaultValues:function(a){var d=b.util.getKlass(a.type).prototype;d.stateProperties.forEach(function(b){a[b]===
d[b]&&delete a[b]});return a},toString:function(){return"#<fabric."+g(this.type)+">"},get:function(a){return this[a]},_setObject:function(a){for(var b in a)this._set(b,a[b])},set:function(a,b){"object"===typeof a?this._setObject(a):"function"===typeof b&&"clipTo"!==a?this._set(a,b(this.get(a))):this._set(a,b);return this},_set:function(a,d){if("scaleX"===a||"scaleY"===a)d=this._constrainScale(d);"scaleX"===a&&0>d?(this.flipX=!this.flipX,d*=-1):"scaleY"===a&&0>d?(this.flipY=!this.flipY,d*=-1):"width"===
a||"height"===a?this.minScaleLimit=k(Math.min(.1,1/Math.max(this.width,this.height)),2):"shadow"!==a||!d||d instanceof b.Shadow||(d=new b.Shadow(d));this[a]=d;return this},toggle:function(a){var b=this.get(a);"boolean"===typeof b&&this.set(a,!b);return this},setSourcePath:function(a){this.sourcePath=a;return this},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:[1,0,0,1,0,0]},render:function(a,d){0===this.width&&0===this.height||!this.visible||
(a.save(),this._setupCompositeOperation(a),d||this.transform(a),this._setStrokeStyles(a),this._setFillStyles(a),this.transformMatrix&&a.transform.apply(a,this.transformMatrix),this._setOpacity(a),this._setShadow(a),this.clipTo&&b.util.clipContext(this,a),this._render(a,d),this.clipTo&&a.restore(),this._removeShadow(a),this._restoreCompositeOperation(a),a.restore())},_setOpacity:function(a){this.group&&this.group._setOpacity(a);a.globalAlpha*=this.opacity},_setStrokeStyles:function(a){this.stroke&&
(a.lineWidth=this.strokeWidth,a.lineCap=this.strokeLineCap,a.lineJoin=this.strokeLineJoin,a.miterLimit=this.strokeMiterLimit,a.strokeStyle=this.stroke.toLive?this.stroke.toLive(a,this):this.stroke)},_setFillStyles:function(a){this.fill&&(a.fillStyle=this.fill.toLive?this.fill.toLive(a,this):this.fill)},_renderControls:function(a,d){if(this.active&&!d){d=this.getViewportTransform();a.save();if(this.group){var f=b.util.transformPoint(this.group.getCenterPoint(),d);a.translate(f.x,f.y);a.rotate(c(this.group.angle))}f=
b.util.transformPoint(this.getCenterPoint(),d,null!=this.group);this.group&&(f.x*=this.group.scaleX,f.y*=this.group.scaleY);a.translate(f.x,f.y);a.rotate(c(this.angle));this.drawBorders(a);this.drawControls(a);a.restore()}},_setShadow:function(a){if(this.shadow){var b=this.canvas&&this.canvas.viewportTransform[0]||1,c=this.canvas&&this.canvas.viewportTransform[3]||1;a.shadowColor=this.shadow.color;a.shadowBlur=this.shadow.blur*(b+c)*(this.scaleX+this.scaleY)/4;a.shadowOffsetX=this.shadow.offsetX*
b*this.scaleX;a.shadowOffsetY=this.shadow.offsetY*c*this.scaleY}},_removeShadow:function(a){this.shadow&&(a.shadowColor="",a.shadowBlur=a.shadowOffsetX=a.shadowOffsetY=0)},_renderFill:function(a){this.fill&&(a.save(),this.fill.gradientTransform&&a.transform.apply(a,this.fill.gradientTransform),this.fill.toLive&&a.translate(-this.width/2+this.fill.offsetX||0,-this.height/2+this.fill.offsetY||0),"evenodd"===this.fillRule?a.fill("evenodd"):a.fill(),a.restore(),this.shadow&&!this.shadow.affectStroke&&
this._removeShadow(a))},_renderStroke:function(a){this.stroke&&0!==this.strokeWidth&&(a.save(),this.strokeDashArray?(1&this.strokeDashArray.length&&this.strokeDashArray.push.apply(this.strokeDashArray,this.strokeDashArray),e?(a.setLineDash(this.strokeDashArray),this._stroke&&this._stroke(a)):this._renderDashedStroke&&this._renderDashedStroke(a),a.stroke()):(this.stroke.gradientTransform&&a.transform.apply(a,this.stroke.gradientTransform),this._stroke?this._stroke(a):a.stroke()),this._removeShadow(a),
a.restore())},clone:function(a,d){return this.constructor.fromObject?this.constructor.fromObject(this.toObject(d),a):new b.Object(this.toObject(d))},cloneAsImage:function(a){var d=this.toDataURL();b.util.loadImage(d,function(d){a&&a(new b.Image(d))});return this},toDataURL:function(a){a||(a={});var d=b.util.createCanvasElement(),c=this.getBoundingRect();d.width=c.width;d.height=c.height;b.util.wrapElement(d,"div");c=new b.StaticCanvas(d);"jpg"===a.format&&(a.format="jpeg");"jpeg"===a.format&&(c.backgroundColor=
"#fff");var f={active:this.get("active"),left:this.getLeft(),top:this.getTop()};this.set("active",!1);this.setPositionByOrigin(new b.Point(d.width/2,d.height/2),"center","center");d=this.canvas;c.add(this);a=c.toDataURL(a);this.set(f).setCoords();this.canvas=d;c.dispose();return a},isType:function(a){return this.type===a},complexity:function(){return 0},toJSON:function(a){return this.toObject(a)},setGradient:function(a,d){d||(d={});var c={colorStops:[]};c.type=d.type||(d.r1||d.r2?"radial":"linear");
c.coords={x1:d.x1,y1:d.y1,x2:d.x2,y2:d.y2};if(d.r1||d.r2)c.coords.r1=d.r1,c.coords.r2=d.r2;for(var f in d.colorStops){var e=new b.Color(d.colorStops[f]);c.colorStops.push({offset:f,color:e.toRgb(),opacity:e.getAlpha()})}return this.set(a,b.Gradient.forObject(this,c))},setPatternFill:function(a){return this.set("fill",new b.Pattern(a))},setShadow:function(a){return this.set("shadow",a?new b.Shadow(a):null)},setColor:function(a){this.set("fill",a);return this},setAngle:function(a){var b=("center"!==
this.originX||"center"!==this.originY)&&this.centeredRotation;b&&this._setOriginToCenter();this.set("angle",a);b&&this._resetOrigin();return this},centerH:function(){this.canvas.centerObjectH(this);return this},centerV:function(){this.canvas.centerObjectV(this);return this},center:function(){this.canvas.centerObject(this);return this},remove:function(){this.canvas.remove(this);return this},getLocalPointer:function(a,b){b=b||this.canvas.getPointer(a);a=this.translateToOriginPoint(this.getCenterPoint(),
"left","top");return{x:b.x-a.x,y:b.y-a.y}},_setupCompositeOperation:function(a){this.globalCompositeOperation&&(this._prevGlobalCompositeOperation=a.globalCompositeOperation,a.globalCompositeOperation=this.globalCompositeOperation)},_restoreCompositeOperation:function(a){this.globalCompositeOperation&&this._prevGlobalCompositeOperation&&(a.globalCompositeOperation=this._prevGlobalCompositeOperation)}}),b.util.createAccessors(b.Object),b.Object.prototype.rotate=b.Object.prototype.setAngle,a(b.Object.prototype,
b.Observable),b.Object.NUM_FRACTION_DIGITS=2,b.Object.__uid=0)})("undefined"!==typeof b?b:this);(function(){var b=a.util.degreesToRadians;a.util.object.extend(a.Object.prototype,{translateToCenterPoint:function(h,k,g){var c=h.x,e=h.y,f=this.stroke?this.strokeWidth:0;"left"===k?c=h.x+(this.getWidth()+f*this.scaleX)/2:"right"===k&&(c=h.x-(this.getWidth()+f*this.scaleX)/2);"top"===g?e=h.y+(this.getHeight()+f*this.scaleY)/2:"bottom"===g&&(e=h.y-(this.getHeight()+f*this.scaleY)/2);return a.util.rotatePoint(new a.Point(c,
e),h,b(this.angle))},translateToOriginPoint:function(h,k,g){var c=h.x,e=h.y,f=this.stroke?this.strokeWidth:0;"left"===k?c=h.x-(this.getWidth()+f*this.scaleX)/2:"right"===k&&(c=h.x+(this.getWidth()+f*this.scaleX)/2);"top"===g?e=h.y-(this.getHeight()+f*this.scaleY)/2:"bottom"===g&&(e=h.y+(this.getHeight()+f*this.scaleY)/2);return a.util.rotatePoint(new a.Point(c,e),h,b(this.angle))},getCenterPoint:function(){var b=new a.Point(this.left,this.top);return this.translateToCenterPoint(b,this.originX,this.originY)},
getPointByOrigin:function(a,b){var h=this.getCenterPoint();return this.translateToOriginPoint(h,a,b)},toLocalPoint:function(h,k,g){var c=this.getCenterPoint(),e=this.stroke?this.strokeWidth:0;k&&g?(k="left"===k?c.x-(this.getWidth()+e*this.scaleX)/2:"right"===k?c.x+(this.getWidth()+e*this.scaleX)/2:c.x,g="top"===g?c.y-(this.getHeight()+e*this.scaleY)/2:"bottom"===g?c.y+(this.getHeight()+e*this.scaleY)/2:c.y):(k=this.left,g=this.top);return a.util.rotatePoint(new a.Point(h.x,h.y),c,-b(this.angle)).subtractEquals(new a.Point(k,
g))},setPositionByOrigin:function(a,b,g){a=this.translateToCenterPoint(a,b,g);a=this.translateToOriginPoint(a,this.originX,this.originY);this.set("left",a.x);this.set("top",a.y)},adjustPosition:function(a){var h=b(this.angle),g=this.getWidth()/2,c=Math.cos(h)*g;g*=Math.sin(h);var e=this.getWidth(),f=Math.cos(h)*e;h=Math.sin(h)*e;"center"===this.originX&&"left"===a||"right"===this.originX&&"center"===a?(this.left-=c,this.top-=g):"left"===this.originX&&"center"===a||"center"===this.originX&&"right"===
a?(this.left+=c,this.top+=g):"left"===this.originX&&"right"===a?(this.left+=f,this.top+=h):"right"===this.originX&&"left"===a&&(this.left-=f,this.top-=h);this.setCoords();this.originX=a},_setOriginToCenter:function(){this._originalOriginX=this.originX;this._originalOriginY=this.originY;var a=this.getCenterPoint();this.originY=this.originX="center";this.left=a.x;this.top=a.y},_resetOrigin:function(){var a=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);
this.originX=this._originalOriginX;this.originY=this._originalOriginY;this.left=a.x;this.top=a.y;this._originalOriginY=this._originalOriginX=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","center")}})})();(function(){var b=a.util.degreesToRadians;a.util.object.extend(a.Object.prototype,{oCoords:null,intersectsWithRect:function(b,k){var h=this.oCoords,c=new a.Point(h.tl.x,h.tl.y),e=new a.Point(h.tr.x,h.tr.y),f=new a.Point(h.bl.x,h.bl.y);h=new a.Point(h.br.x,
h.br.y);return"Intersection"===a.Intersection.intersectPolygonRectangle([c,e,h,f],b,k).status},intersectsWithObject:function(b){function h(b){return{tl:new a.Point(b.tl.x,b.tl.y),tr:new a.Point(b.tr.x,b.tr.y),bl:new a.Point(b.bl.x,b.bl.y),br:new a.Point(b.br.x,b.br.y)}}var g=h(this.oCoords);b=h(b.oCoords);return"Intersection"===a.Intersection.intersectPolygonPolygon([g.tl,g.tr,g.br,g.bl],[b.tl,b.tr,b.br,b.bl]).status},isContainedWithinObject:function(b){var h=b.getBoundingRect();b=new a.Point(h.left,
h.top);h=new a.Point(h.left+h.width,h.top+h.height);return this.isContainedWithinRect(b,h)},isContainedWithinRect:function(a,b){var h=this.getBoundingRect();return h.left>=a.x&&h.left+h.width<=b.x&&h.top>=a.y&&h.top+h.height<=b.y},containsPoint:function(a){var b=this._getImageLines(this.oCoords);a=this._findCrossPoints(a,b);return 0!==a&&1===a%2},_getImageLines:function(a){return{topline:{o:a.tl,d:a.tr},rightline:{o:a.tr,d:a.br},bottomline:{o:a.br,d:a.bl},leftline:{o:a.bl,d:a.tl}}},_findCrossPoints:function(a,
b){var h=0,c;for(c in b){var e=b[c];if(!(e.o.y<a.y&&e.d.y<a.y||e.o.y>=a.y&&e.d.y>=a.y)){if(e.o.x===e.d.x&&e.o.x>=a.x)var f=e.o.x;else{f=(e.d.y-e.o.y)/(e.d.x-e.o.x);var d=a.y-0*a.x;e=e.o.y-f*e.o.x;f=-(d-e)/(0-f)}f>=a.x&&(h+=1);if(2===h)break}}return h},getBoundingRectWidth:function(){return this.getBoundingRect().width},getBoundingRectHeight:function(){return this.getBoundingRect().height},getBoundingRect:function(){this.oCoords||this.setCoords();var b=[this.oCoords.tl.x,this.oCoords.tr.x,this.oCoords.br.x,
this.oCoords.bl.x],k=a.util.array.min(b);b=a.util.array.max(b);b=Math.abs(k-b);var g=[this.oCoords.tl.y,this.oCoords.tr.y,this.oCoords.br.y,this.oCoords.bl.y],c=a.util.array.min(g);g=a.util.array.max(g);return{left:k,top:c,width:b,height:Math.abs(c-g)}},getWidth:function(){return this.width*this.scaleX},getHeight:function(){return this.height*this.scaleY},_constrainScale:function(a){return Math.abs(a)<this.minScaleLimit?0>a?-this.minScaleLimit:this.minScaleLimit:a},scale:function(a){a=this._constrainScale(a);
0>a&&(this.flipX=!this.flipX,this.flipY=!this.flipY,a*=-1);this.scaleY=this.scaleX=a;this.setCoords();return this},scaleToWidth:function(a){var b=this.getBoundingRectWidth()/this.getWidth();return this.scale(a/this.width/b)},scaleToHeight:function(a){var b=this.getBoundingRectHeight()/this.getHeight();return this.scale(a/this.height/b)},setCoords:function(){var h=b(this.angle),k=this.getViewportTransform(),g=this._calculateCurrentDimensions(!1),c=g.x,e=g.y;0>c&&(c=Math.abs(c));g=Math.sqrt(Math.pow(c/
2,2)+Math.pow(e/2,2));var f=Math.atan(isFinite(e/c)?e/c:0),d=Math.cos(f+h)*g;f=Math.sin(f+h)*g;g=Math.sin(h);h=Math.cos(h);var q=this.getCenterPoint();e=new a.Point(c,e);q=new a.Point(q.x-d,q.y-f);f=new a.Point(q.x+e.x*h,q.y+e.x*g);c=a.util.transformPoint(new a.Point(q.x-e.y*g,q.y+e.y*h),k);d=a.util.transformPoint(new a.Point(f.x-e.y*g,f.y+e.y*h),k);e=a.util.transformPoint(q,k);k=a.util.transformPoint(f,k);f=new a.Point((e.x+c.x)/2,(e.y+c.y)/2);q=new a.Point((k.x+e.x)/2,(k.y+e.y)/2);var u=new a.Point((d.x+
k.x)/2,(d.y+k.y)/2),l=new a.Point((d.x+c.x)/2,(d.y+c.y)/2);g=new a.Point(q.x+g*this.rotatingPointOffset,q.y-h*this.rotatingPointOffset);this.oCoords={tl:e,tr:k,br:d,bl:c,ml:f,mt:q,mr:u,mb:l,mtr:g};this._setCornerCoords&&this._setCornerCoords();return this}})})();a.util.object.extend(a.Object.prototype,{sendToBack:function(){this.group?a.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas.sendToBack(this);return this},bringToFront:function(){this.group?a.StaticCanvas.prototype.bringToFront.call(this.group,
this):this.canvas.bringToFront(this);return this},sendBackwards:function(b){this.group?a.StaticCanvas.prototype.sendBackwards.call(this.group,this,b):this.canvas.sendBackwards(this,b);return this},bringForward:function(b){this.group?a.StaticCanvas.prototype.bringForward.call(this.group,this,b):this.canvas.bringForward(this,b);return this},moveTo:function(b){this.group?a.StaticCanvas.prototype.moveTo.call(this.group,this,b):this.canvas.moveTo(this,b);return this}});a.util.object.extend(a.Object.prototype,
{getSvgStyles:function(){var a=this.fill?this.fill.toLive?"url(#SVGID_"+this.fill.id+")":this.fill:"none",b=this.fillRule,k=this.stroke?this.stroke.toLive?"url(#SVGID_"+this.stroke.id+")":this.stroke:"none",g=this.strokeWidth?this.strokeWidth:"0",c=this.strokeDashArray?this.strokeDashArray.join(" "):"";return["stroke: ",k,"; stroke-width: ",g,"; stroke-dasharray: ",c,"; stroke-linecap: ",this.strokeLineCap?this.strokeLineCap:"butt","; stroke-linejoin: ",this.strokeLineJoin?this.strokeLineJoin:"miter",
"; stroke-miterlimit: ",this.strokeMiterLimit?this.strokeMiterLimit:"4","; fill: ",a,"; fill-rule: ",b,"; opacity: ","undefined"!==typeof this.opacity?this.opacity:"1",";",this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":"",this.visible?"":" visibility: hidden;"].join("")},getSvgTransform:function(){if(this.group&&"path-group"===this.group.type)return"";var b=a.util.toFixed,h=this.getAngle(),k=!this.canvas||this.canvas.svgViewportTransformation?this.getViewportTransform():[1,0,0,1,0,0],g=a.util.transformPoint(this.getCenterPoint(),
k),c=a.Object.NUM_FRACTION_DIGITS;g="path-group"===this.type?"":"translate("+b(g.x,c)+" "+b(g.y,c)+")";h=0!==h?" rotate("+b(h,c)+")":"";b=1===this.scaleX&&1===this.scaleY&&1===k[0]&&1===k[3]?"":" scale("+b(this.scaleX*k[0],c)+" "+b(this.scaleY*k[3],c)+")";c="path-group"===this.type?this.width*k[0]:0;k="path-group"===this.type?this.height*k[3]:0;return[g,h,b,this.flipX?" matrix(-1 0 0 1 "+c+" 0) ":"",this.flipY?" matrix(1 0 0 -1 0 "+k+")":""].join("")},getSvgTransformMatrix:function(){return this.transformMatrix?
" matrix("+this.transformMatrix.join(" ")+") ":""},_createBaseSVGMarkup:function(){var a=[];this.fill&&this.fill.toLive&&a.push(this.fill.toSVG(this,!1));this.stroke&&this.stroke.toLive&&a.push(this.stroke.toSVG(this,!1));this.shadow&&a.push(this.shadow.toSVG(this));return a}});a.util.object.extend(a.Object.prototype,{hasStateChanged:function(){return this.stateProperties.some(function(a){return this.get(a)!==this.originalState[a]},this)},saveState:function(a){this.stateProperties.forEach(function(a){this.originalState[a]=
this.get(a)},this);a&&a.stateProperties&&a.stateProperties.forEach(function(a){this.originalState[a]=this.get(a)},this);return this},setupState:function(){this.originalState={};this.saveState();return this}});(function(){var b=a.util.degreesToRadians;a.util.object.extend(a.Object.prototype,{_controlsVisibility:null,_findTargetCorner:function(a){if(!this.hasControls||!this.active)return!1;var b=a.x;a=a.y;var h;for(h in this.oCoords)if(this.isControlVisible(h)&&("mtr"!==h||this.hasRotatingPoint)&&(!this.get("lockUniScaling")||
"mt"!==h&&"mr"!==h&&"mb"!==h&&"ml"!==h)){var c=this._getImageLines(this.oCoords[h].corner);c=this._findCrossPoints({x:b,y:a},c);if(0!==c&&1===c%2)return this.__corner=h}return!1},_setCornerCoords:function(){var a=this.oCoords,k=b(45-this.angle),g=Math.sqrt(2*Math.pow(this.cornerSize,2))/2,c=g*Math.cos(k);k=g*Math.sin(k);var e;for(e in a){g=a[e].x;var f=a[e].y;a[e].corner={tl:{x:g-k,y:f-c},tr:{x:g+c,y:f-k},bl:{x:g-c,y:f+k},br:{x:g+k,y:f+c}}}},_calculateCurrentDimensions:function(b){var h=this.getViewportTransform(),
g=this.strokeWidth,c=this.width,e=this.height,f="round"===this.strokeLineCap||"square"===this.strokeLineCap,d="line"===this.type&&0===this.width,q="line"===this.type&&0===this.height,u=d||q;d?c=g:q&&(e=g);if(f&&q||!u)c+=0>c?-g:g;if(f&&d||!u)e+=0>e?-g:g;c=c*this.scaleX+2*this.padding;e=e*this.scaleY+2*this.padding;return b?a.util.transformPoint(new a.Point(c,e),h,!0):{x:c,y:e}},drawBorders:function(a){if(!this.hasBorders)return this;a.save();a.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:
1;a.strokeStyle=this.borderColor;a.lineWidth=1/this.borderScaleFactor;var b=this._calculateCurrentDimensions(!0),h=b.x;b=b.y;this.group&&(h*=this.group.scaleX,b*=this.group.scaleY);a.strokeRect(~~-(h/2)-.5,~~-(b/2)-.5,~~h+1,~~b+1);this.hasRotatingPoint&&this.isControlVisible("mtr")&&!this.get("lockRotation")&&this.hasControls&&(h=-b/2,a.beginPath(),a.moveTo(0,h),a.lineTo(0,h-this.rotatingPointOffset),a.closePath(),a.stroke());a.restore();return this},drawControls:function(a){if(!this.hasControls)return this;
var b=this._calculateCurrentDimensions(!0),h=b.x;b=b.y;var c=-(h/2),e=-(b/2),f=this.cornerSize/2,d=this.transparentCorners?"strokeRect":"fillRect";a.save();a.lineWidth=1;a.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;a.strokeStyle=a.fillStyle=this.cornerColor;this._drawControl("tl",a,d,c-f,e-f);this._drawControl("tr",a,d,c+h-f,e-f);this._drawControl("bl",a,d,c-f,e+b-f);this._drawControl("br",a,d,c+h-f,e+b-f);this.get("lockUniScaling")||(this._drawControl("mt",a,d,c+h/2-f,e-f),this._drawControl("mb",
a,d,c+h/2-f,e+b-f),this._drawControl("mr",a,d,c+h-f,e+b/2-f),this._drawControl("ml",a,d,c-f,e+b/2-f));this.hasRotatingPoint&&this._drawControl("mtr",a,d,c+h/2-f,e-this.rotatingPointOffset-f);a.restore();return this},_drawControl:function(a,b,g,c,e){this.isControlVisible(a)&&(a=this.cornerSize,"undefined"!==typeof G_vmlCanvasManager||this.transparentCorners||b.clearRect(c,e,a,a),b[g](c,e,a,a))},isControlVisible:function(a){return this._getControlsVisibility()[a]},setControlVisible:function(a,b){this._getControlsVisibility()[a]=
b;return this},setControlsVisibility:function(a){a||(a={});for(var b in a)this.setControlVisible(b,a[b]);return this},_getControlsVisibility:function(){this._controlsVisibility||(this._controlsVisibility={tl:!0,tr:!0,br:!0,bl:!0,ml:!0,mt:!0,mr:!0,mb:!0,mtr:!0});return this._controlsVisibility}})})();(function(a){function b(a,b){var d=a.origin,c=a.axis1,f=a.axis2,e=a.dimension,h=b.nearest,g=b.center,k=b.farthest;return function(){switch(this.get(d)){case h:return Math.min(this.get(c),this.get(f));
case g:return Math.min(this.get(c),this.get(f))+.5*this.get(e);case k:return Math.max(this.get(c),this.get(f))}}}var k=a.fabric||(a.fabric={}),g=k.util.object.extend,c={x1:1,x2:1,y1:1,y2:1},e=k.StaticCanvas.supports("setLineDash");k.Line?k.warn("fabric.Line is already defined"):(k.Line=k.util.createClass(k.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,initialize:function(a,b){b=b||{};a||(a=[0,0,0,0]);this.callSuper("initialize",b);this.set("x1",a[0]);this.set("y1",a[1]);this.set("x2",a[2]);this.set("y2",
a[3]);this._setWidthHeight(b)},_setWidthHeight:function(a){a||(a={});this.width=Math.abs(this.x2-this.x1);this.height=Math.abs(this.y2-this.y1);this.left="left"in a?a.left:this._getLeftToOriginX();this.top="top"in a?a.top:this._getTopToOriginY()},_set:function(a,b){this.callSuper("_set",a,b);"undefined"!==typeof c[a]&&this._setWidthHeight();return this},_getLeftToOriginX:b({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:b({origin:"originY",
axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(a,b){a.beginPath();b&&(b=this.getCenterPoint(),a.translate(b.x-this.strokeWidth/2,b.y-this.strokeWidth/2));if(!this.strokeDashArray||this.strokeDashArray&&e)b=this.calcLinePoints(),a.moveTo(b.x1,b.y1),a.lineTo(b.x2,b.y2);a.lineWidth=this.strokeWidth;b=a.strokeStyle;a.strokeStyle=this.stroke||a.fillStyle;this.stroke&&this._renderStroke(a);a.strokeStyle=b},_renderDashedStroke:function(a){var b=
this.calcLinePoints();a.beginPath();k.util.drawDashedLine(a,b.x1,b.y1,b.x2,b.y2,this.strokeDashArray);a.closePath()},toObject:function(a){return g(this.callSuper("toObject",a),this.calcLinePoints())},calcLinePoints:function(){var a=this.x1<=this.x2?-1:1,b=this.y1<=this.y2?-1:1;return{x1:a*this.width*.5,x2:a*this.width*-.5,y1:b*this.height*.5,y2:b*this.height*-.5}},toSVG:function(a){var b=this._createBaseSVGMarkup(),c={x1:this.x1,x2:this.x2,y1:this.y1,y2:this.y2};this.group&&"path-group"===this.group.type||
(c=this.calcLinePoints());b.push("<line ",'x1="',c.x1,'" y1="',c.y1,'" x2="',c.x2,'" y2="',c.y2,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"/>\n');return a?a(b.join("")):b.join("")},complexity:function(){return 1}}),k.Line.ATTRIBUTE_NAMES=k.SHARED_ATTRIBUTES.concat(["x1","y1","x2","y2"]),k.Line.fromElement=function(a,b){a=k.parseAttributes(a,k.Line.ATTRIBUTE_NAMES);return new k.Line([a.x1||0,a.y1||0,a.x2||0,a.y2||0],g(a,b))},k.Line.fromObject=
function(a){return new k.Line([a.x1,a.y1,a.x2,a.y2],a)})})("undefined"!==typeof b?b:this);(function(a){var b=a.fabric||(a.fabric={}),k=Math.PI,g=b.util.object.extend;b.Circle?b.warn("fabric.Circle is already defined."):(b.Circle=b.util.createClass(b.Object,{type:"circle",radius:0,startAngle:0,endAngle:2*k,initialize:function(a){a=a||{};this.callSuper("initialize",a);this.set("radius",a.radius||0);this.startAngle=a.startAngle||this.startAngle;this.endAngle=a.endAngle||this.endAngle},_set:function(a,
b){this.callSuper("_set",a,b);"radius"===a&&this.setRadius(b);return this},toObject:function(a){return g(this.callSuper("toObject",a),{radius:this.get("radius"),startAngle:this.startAngle,endAngle:this.endAngle})},toSVG:function(a){var b=this._createBaseSVGMarkup(),c=0,d=0,h=(this.endAngle-this.startAngle)%(2*k);0===h?(this.group&&"path-group"===this.group.type&&(c=this.left+this.radius,d=this.top+this.radius),b.push("<circle ",'cx="'+c+'" cy="'+d+'" ','r="',this.radius,'" style="',this.getSvgStyles(),
'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),'"/>\n')):b.push('<path d="M '+Math.cos(this.startAngle)*this.radius+" "+Math.sin(this.startAngle)*this.radius," A "+this.radius+" "+this.radius," 0 ",+(h>k?1:0)+" 1"," "+Math.cos(this.endAngle)*this.radius+" "+Math.sin(this.endAngle)*this.radius,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),'"/>\n');return a?a(b.join("")):b.join("")},_render:function(a,b){a.beginPath();
a.arc(b?this.left+this.radius:0,b?this.top+this.radius:0,this.radius,this.startAngle,this.endAngle,!1);this._renderFill(a);this._renderStroke(a)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(a){this.radius=a;this.set("width",2*a).set("height",2*a)},complexity:function(){return 1}}),b.Circle.ATTRIBUTE_NAMES=b.SHARED_ATTRIBUTES.concat(["cx","cy","r"]),b.Circle.fromElement=function(a,e){e||(e=
{});a=b.parseAttributes(a,b.Circle.ATTRIBUTE_NAMES);if(!("radius"in a&&0<=a.radius))throw Error("value of `r` attribute is required and can not be negative");a.left=a.left||0;a.top=a.top||0;e=new b.Circle(g(a,e));e.left-=e.radius;e.top-=e.radius;return e},b.Circle.fromObject=function(a){return new b.Circle(a)})})("undefined"!==typeof b?b:this);(function(a){var b=a.fabric||(a.fabric={});b.Triangle?b.warn("fabric.Triangle is already defined"):(b.Triangle=b.util.createClass(b.Object,{type:"triangle",
initialize:function(a){a=a||{};this.callSuper("initialize",a);this.set("width",a.width||100).set("height",a.height||100)},_render:function(a){var b=this.width/2,c=this.height/2;a.beginPath();a.moveTo(-b,c);a.lineTo(0,-c);a.lineTo(b,c);a.closePath();this._renderFill(a);this._renderStroke(a)},_renderDashedStroke:function(a){var h=this.width/2,c=this.height/2;a.beginPath();b.util.drawDashedLine(a,-h,c,0,-c,this.strokeDashArray);b.util.drawDashedLine(a,0,-c,h,c,this.strokeDashArray);b.util.drawDashedLine(a,
h,c,-h,c,this.strokeDashArray);a.closePath()},toSVG:function(a){var b=this._createBaseSVGMarkup(),c=this.width/2,e=this.height/2;c=[-c+" "+e,"0 "+-e,c+" "+e].join();b.push("<polygon ",'points="',c,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),'"/>');return a?a(b.join("")):b.join("")},complexity:function(){return 1}}),b.Triangle.fromObject=function(a){return new b.Triangle(a)})})("undefined"!==typeof b?b:this);(function(a){var b=a.fabric||(a.fabric={}),k=2*Math.PI,g=b.util.object.extend;
b.Ellipse?b.warn("fabric.Ellipse is already defined."):(b.Ellipse=b.util.createClass(b.Object,{type:"ellipse",rx:0,ry:0,initialize:function(a){a=a||{};this.callSuper("initialize",a);this.set("rx",a.rx||0);this.set("ry",a.ry||0)},_set:function(a,b){this.callSuper("_set",a,b);switch(a){case "rx":this.rx=b;this.set("width",2*b);break;case "ry":this.ry=b,this.set("height",2*b)}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},
toObject:function(a){return g(this.callSuper("toObject",a),{rx:this.get("rx"),ry:this.get("ry")})},toSVG:function(a){var b=this._createBaseSVGMarkup(),c=0,d=0;this.group&&"path-group"===this.group.type&&(c=this.left+this.rx,d=this.top+this.ry);b.push("<ellipse ",'cx="',c,'" cy="',d,'" ','rx="',this.rx,'" ry="',this.ry,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"/>\n');return a?a(b.join("")):b.join("")},_render:function(a,b){a.beginPath();a.save();
a.transform(1,0,0,this.ry/this.rx,0,0);a.arc(b?this.left+this.rx:0,b?(this.top+this.ry)*this.rx/this.ry:0,this.rx,0,k,!1);a.restore();this._renderFill(a);this._renderStroke(a)},complexity:function(){return 1}}),b.Ellipse.ATTRIBUTE_NAMES=b.SHARED_ATTRIBUTES.concat(["cx","cy","rx","ry"]),b.Ellipse.fromElement=function(a,e){e||(e={});a=b.parseAttributes(a,b.Ellipse.ATTRIBUTE_NAMES);a.left=a.left||0;a.top=a.top||0;e=new b.Ellipse(g(a,e));e.top-=e.ry;e.left-=e.rx;return e},b.Ellipse.fromObject=function(a){return new b.Ellipse(a)})})("undefined"!==
typeof b?b:this);(function(a){var b=a.fabric||(a.fabric={}),k=b.util.object.extend;b.Rect?console.warn("fabric.Rect is already defined"):(a=b.Object.prototype.stateProperties.concat(),a.push("rx","ry","x","y"),b.Rect=b.util.createClass(b.Object,{stateProperties:a,type:"rect",rx:0,ry:0,strokeDashArray:null,initialize:function(a){a=a||{};this.callSuper("initialize",a);this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(a,b){if(1===
this.width&&1===this.height)a.fillRect(0,0,1,1);else{var c=this.rx?Math.min(this.rx,this.width/2):0,f=this.ry?Math.min(this.ry,this.height/2):0,d=this.width,h=this.height,g=b?this.left:-this.width/2;b=b?this.top:-this.height/2;var k=0!==c||0!==f;a.beginPath();a.moveTo(g+c,b);a.lineTo(g+d-c,b);k&&a.bezierCurveTo(g+d-.4477152502*c,b,g+d,b+.4477152502*f,g+d,b+f);a.lineTo(g+d,b+h-f);k&&a.bezierCurveTo(g+d,b+h-.4477152502*f,g+d-.4477152502*c,b+h,g+d-c,b+h);a.lineTo(g+c,b+h);k&&a.bezierCurveTo(g+.4477152502*
c,b+h,g,b+h-.4477152502*f,g,b+h-f);a.lineTo(g,b+f);k&&a.bezierCurveTo(g,b+.4477152502*f,g+.4477152502*c,b,g+c,b);a.closePath();this._renderFill(a);this._renderStroke(a)}},_renderDashedStroke:function(a){var c=-this.width/2,e=-this.height/2,f=this.width,d=this.height;a.beginPath();b.util.drawDashedLine(a,c,e,c+f,e,this.strokeDashArray);b.util.drawDashedLine(a,c+f,e,c+f,e+d,this.strokeDashArray);b.util.drawDashedLine(a,c+f,e+d,c,e+d,this.strokeDashArray);b.util.drawDashedLine(a,c,e+d,c,e,this.strokeDashArray);
a.closePath()},toObject:function(a){a=k(this.callSuper("toObject",a),{rx:this.get("rx")||0,ry:this.get("ry")||0});this.includeDefaultValues||this._removeDefaultValues(a);return a},toSVG:function(a){var b=this._createBaseSVGMarkup(),e=this.left,f=this.top;this.group&&"path-group"===this.group.type||(e=-this.width/2,f=-this.height/2);b.push("<rect ",'x="',e,'" y="',f,'" rx="',this.get("rx"),'" ry="',this.get("ry"),'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'" transform="',
this.getSvgTransform(),this.getSvgTransformMatrix(),'"/>\n');return a?a(b.join("")):b.join("")},complexity:function(){return 1}}),b.Rect.ATTRIBUTE_NAMES=b.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),b.Rect.fromElement=function(a,c){if(!a)return null;c=c||{};a=b.parseAttributes(a,b.Rect.ATTRIBUTE_NAMES);a.left=a.left||0;a.top=a.top||0;c=new b.Rect(k(c?b.util.object.clone(c):{},a));c.visible=0<c.width&&0<c.height;return c},b.Rect.fromObject=function(a){return new b.Rect(a)})})("undefined"!==
typeof b?b:this);(function(a){var b=a.fabric||(a.fabric={});b.Polyline?b.warn("fabric.Polyline is already defined"):(b.Polyline=b.util.createClass(b.Object,{type:"polyline",points:null,minX:0,minY:0,initialize:function(a,h){return b.Polygon.prototype.initialize.call(this,a,h)},_calcDimensions:function(){return b.Polygon.prototype._calcDimensions.call(this)},_applyPointOffset:function(){return b.Polygon.prototype._applyPointOffset.call(this)},toObject:function(a){return b.Polygon.prototype.toObject.call(this,
a)},toSVG:function(a){return b.Polygon.prototype.toSVG.call(this,a)},_render:function(a){b.Polygon.prototype.commonRender.call(this,a)&&(this._renderFill(a),this._renderStroke(a))},_renderDashedStroke:function(a){a.beginPath();for(var h=0,c=this.points.length;h<c;h++){var e=this.points[h];var f=this.points[h+1]||e;b.util.drawDashedLine(a,e.x,e.y,f.x,f.y,this.strokeDashArray)}},complexity:function(){return this.get("points").length}}),b.Polyline.ATTRIBUTE_NAMES=b.SHARED_ATTRIBUTES.concat(),b.Polyline.fromElement=
function(a,h){if(!a)return null;h||(h={});var c=b.parsePointsAttribute(a.getAttribute("points"));a=b.parseAttributes(a,b.Polyline.ATTRIBUTE_NAMES);return new b.Polyline(c,b.util.object.extend(a,h))},b.Polyline.fromObject=function(a){return new b.Polyline(a.points,a,!0)})})("undefined"!==typeof b?b:this);(function(a){var b=a.fabric||(a.fabric={}),k=b.util.object.extend,g=b.util.array.min,c=b.util.array.max,e=b.util.toFixed;b.Polygon?b.warn("fabric.Polygon is already defined"):(b.Polygon=b.util.createClass(b.Object,
{type:"polygon",points:null,minX:0,minY:0,initialize:function(a,b){b=b||{};this.points=a||[];this.callSuper("initialize",b);this._calcDimensions();"top"in b||(this.top=this.minY);"left"in b||(this.left=this.minX)},_calcDimensions:function(){var a=this.points,b=g(a,"x"),e=g(a,"y"),h=c(a,"x");a=c(a,"y");this.width=h-b||0;this.height=a-e||0;this.minX=b||0;this.minY=e||0},_applyPointOffset:function(){this.points.forEach(function(a){a.x-=this.minX+this.width/2;a.y-=this.minY+this.height/2},this)},toObject:function(a){return k(this.callSuper("toObject",
a),{points:this.points.concat()})},toSVG:function(a){for(var b=[],c=this._createBaseSVGMarkup(),f=0,h=this.points.length;f<h;f++)b.push(e(this.points[f].x,2),",",e(this.points[f].y,2)," ");c.push("<",this.type," ",'points="',b.join(""),'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),'"/>\n');return a?a(c.join("")):c.join("")},_render:function(a){this.commonRender(a)&&(this._renderFill(a),this.stroke||this.strokeDashArray)&&(a.closePath(),this._renderStroke(a))},
commonRender:function(a){var b=this.points.length;if(!b||isNaN(this.points[b-1].y))return!1;a.beginPath();this._applyPointOffset&&(this.group&&"path-group"===this.group.type||this._applyPointOffset(),this._applyPointOffset=null);a.moveTo(this.points[0].x,this.points[0].y);for(var c=0;c<b;c++){var f=this.points[c];a.lineTo(f.x,f.y)}return!0},_renderDashedStroke:function(a){b.Polyline.prototype._renderDashedStroke.call(this,a);a.closePath()},complexity:function(){return this.points.length}}),b.Polygon.ATTRIBUTE_NAMES=
b.SHARED_ATTRIBUTES.concat(),b.Polygon.fromElement=function(a,d){if(!a)return null;d||(d={});var c=b.parsePointsAttribute(a.getAttribute("points"));a=b.parseAttributes(a,b.Polygon.ATTRIBUTE_NAMES);return new b.Polygon(c,k(a,d))},b.Polygon.fromObject=function(a){return new b.Polygon(a.points,a,!0)})})("undefined"!==typeof b?b:this);(function(a){var b=a.fabric||(a.fabric={}),k=b.util.array.min,g=b.util.array.max,c=b.util.object.extend,e=Object.prototype.toString,f=b.util.drawArc,d={m:2,l:2,h:1,v:1,
c:6,s:4,q:4,t:2,a:7},q={m:"l",M:"L"};b.Path?b.warn("fabric.Path is already defined"):(b.Path=b.util.createClass(b.Object,{type:"path",path:null,minX:0,minY:0,initialize:function(a,b){b=b||{};this.setOptions(b);if(!a)throw Error("`path` argument is required");var d="[object Array]"===e.call(a);if(this.path=d?a:a.match&&a.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi))d||(this.path=this._parsePath()),this._setPositionDimensions(),b.sourcePath&&this.setSourcePath(b.sourcePath)},_setPositionDimensions:function(){var a=
this._parseDimensions();this.minX=a.left;this.minY=a.top;this.width=a.width;this.height=a.height;a.left+="center"===this.originX?this.width/2:"right"===this.originX?this.width:0;a.top+="center"===this.originY?this.height/2:"bottom"===this.originY?this.height:0;this.top=this.top||a.top;this.left=this.left||a.left;this.pathOffset=this.pathOffset||{x:this.minX+this.width/2,y:this.minY+this.height/2}},_render:function(a){var b=null,d=0,c=0,e=0,g=0,h=0,k=0,q=-this.pathOffset.x,u=-this.pathOffset.y;this.group&&
"path-group"===this.group.type&&(u=q=0);a.beginPath();for(var l=0,n=this.path.length;l<n;++l){var m=this.path[l];switch(m[0]){case "l":e+=m[1];g+=m[2];a.lineTo(e+q,g+u);break;case "L":e=m[1];g=m[2];a.lineTo(e+q,g+u);break;case "h":e+=m[1];a.lineTo(e+q,g+u);break;case "H":e=m[1];a.lineTo(e+q,g+u);break;case "v":g+=m[1];a.lineTo(e+q,g+u);break;case "V":g=m[1];a.lineTo(e+q,g+u);break;case "m":e+=m[1];g+=m[2];d=e;c=g;a.moveTo(e+q,g+u);break;case "M":e=m[1];g=m[2];d=e;c=g;a.moveTo(e+q,g+u);break;case "c":var p=
e+m[5];var r=g+m[6];h=e+m[3];k=g+m[4];a.bezierCurveTo(e+m[1]+q,g+m[2]+u,h+q,k+u,p+q,r+u);e=p;g=r;break;case "C":e=m[5];g=m[6];h=m[3];k=m[4];a.bezierCurveTo(m[1]+q,m[2]+u,h+q,k+u,e+q,g+u);break;case "s":p=e+m[3];r=g+m[4];null===b[0].match(/[CcSs]/)?(h=e,k=g):(h=2*e-h,k=2*g-k);a.bezierCurveTo(h+q,k+u,e+m[1]+q,g+m[2]+u,p+q,r+u);h=e+m[1];k=g+m[2];e=p;g=r;break;case "S":p=m[3];r=m[4];null===b[0].match(/[CcSs]/)?(h=e,k=g):(h=2*e-h,k=2*g-k);a.bezierCurveTo(h+q,k+u,m[1]+q,m[2]+u,p+q,r+u);e=p;g=r;h=m[1];k=
m[2];break;case "q":p=e+m[3];r=g+m[4];h=e+m[1];k=g+m[2];a.quadraticCurveTo(h+q,k+u,p+q,r+u);e=p;g=r;break;case "Q":p=m[3];r=m[4];a.quadraticCurveTo(m[1]+q,m[2]+u,p+q,r+u);e=p;g=r;h=m[1];k=m[2];break;case "t":p=e+m[1];r=g+m[2];null===b[0].match(/[QqTt]/)?(h=e,k=g):(h=2*e-h,k=2*g-k);a.quadraticCurveTo(h+q,k+u,p+q,r+u);e=p;g=r;break;case "T":p=m[1];r=m[2];null===b[0].match(/[QqTt]/)?(h=e,k=g):(h=2*e-h,k=2*g-k);a.quadraticCurveTo(h+q,k+u,p+q,r+u);e=p;g=r;break;case "a":f(a,e+q,g+u,[m[1],m[2],m[3],m[4],
m[5],m[6]+e+q,m[7]+g+u]);e+=m[6];g+=m[7];break;case "A":f(a,e+q,g+u,[m[1],m[2],m[3],m[4],m[5],m[6]+q,m[7]+u]);e=m[6];g=m[7];break;case "z":case "Z":e=d,g=c,a.closePath()}b=m}this._renderFill(a);this._renderStroke(a)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(a){a=c(this.callSuper("toObject",a),{path:this.path.map(function(a){return a.slice()}),pathOffset:this.pathOffset});this.sourcePath&&(a.sourcePath=this.sourcePath);
this.transformMatrix&&(a.transformMatrix=this.transformMatrix);return a},toDatalessObject:function(a){a=this.toObject(a);this.sourcePath&&(a.path=this.sourcePath);delete a.sourcePath;return a},toSVG:function(a){for(var b=[],d=this._createBaseSVGMarkup(),c="",f=0,e=this.path.length;f<e;f++)b.push(this.path[f].join(" "));b=b.join(" ");this.group&&"path-group"===this.group.type||(c=" translate("+-this.pathOffset.x+", "+-this.pathOffset.y+") ");d.push("<path ",'d="',b,'" style="',this.getSvgStyles(),
'" transform="',this.getSvgTransform(),c,this.getSvgTransformMatrix(),'" stroke-linecap="round" ',"/>\n");return a?a(d.join("")):d.join("")},complexity:function(){return this.path.length},_parsePath:function(){for(var a=[],b=[],c,f,e=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/ig,g,h=0,k=this.path.length;h<k;h++){c=this.path[h];g=c.slice(1).trim();for(b.length=0;f=e.exec(g);)b.push(f[0]);c=[c.charAt(0)];g=0;for(var l=b.length;g<l;g++)f=parseFloat(b[g]),isNaN(f)||c.push(f);f=c[0];g=d[f.toLowerCase()];
l=q[f]||f;if(c.length-1>g)for(var m=1,n=c.length;m<n;m+=g)a.push([f].concat(c.slice(m,m+g))),f=l;else a.push(c)}return a},_parseDimensions:function(){for(var a=[],d=[],c,f=null,e=0,h=0,q=0,l=0,m=0,n=0,p,r,t,v=0,w=this.path.length;v<w;++v){c=this.path[v];switch(c[0]){case "l":q+=c[1];l+=c[2];t=[];break;case "L":q=c[1];l=c[2];t=[];break;case "h":q+=c[1];t=[];break;case "H":q=c[1];t=[];break;case "v":l+=c[1];t=[];break;case "V":l=c[1];t=[];break;case "m":q+=c[1];l+=c[2];e=q;h=l;t=[];break;case "M":q=
c[1];l=c[2];e=q;h=l;t=[];break;case "c":p=q+c[5];r=l+c[6];m=q+c[3];n=l+c[4];t=b.util.getBoundsOfCurve(q,l,q+c[1],l+c[2],m,n,p,r);q=p;l=r;break;case "C":q=c[5];l=c[6];m=c[3];n=c[4];t=b.util.getBoundsOfCurve(q,l,c[1],c[2],m,n,q,l);break;case "s":p=q+c[3];r=l+c[4];null===f[0].match(/[CcSs]/)?(m=q,n=l):(m=2*q-m,n=2*l-n);t=b.util.getBoundsOfCurve(q,l,m,n,q+c[1],l+c[2],p,r);m=q+c[1];n=l+c[2];q=p;l=r;break;case "S":p=c[3];r=c[4];null===f[0].match(/[CcSs]/)?(m=q,n=l):(m=2*q-m,n=2*l-n);t=b.util.getBoundsOfCurve(q,
l,m,n,c[1],c[2],p,r);q=p;l=r;m=c[1];n=c[2];break;case "q":p=q+c[3];r=l+c[4];m=q+c[1];n=l+c[2];t=b.util.getBoundsOfCurve(q,l,m,n,m,n,p,r);q=p;l=r;break;case "Q":m=c[1];n=c[2];t=b.util.getBoundsOfCurve(q,l,m,n,m,n,c[3],c[4]);q=c[3];l=c[4];break;case "t":p=q+c[1];r=l+c[2];null===f[0].match(/[QqTt]/)?(m=q,n=l):(m=2*q-m,n=2*l-n);t=b.util.getBoundsOfCurve(q,l,m,n,m,n,p,r);q=p;l=r;break;case "T":p=c[1];r=c[2];null===f[0].match(/[QqTt]/)?(m=q,n=l):(m=2*q-m,n=2*l-n);t=b.util.getBoundsOfCurve(q,l,m,n,m,n,p,
r);q=p;l=r;break;case "a":t=b.util.getBoundsOfArc(q,l,c[1],c[2],c[3],c[4],c[5],c[6]+q,c[7]+l);q+=c[6];l+=c[7];break;case "A":t=b.util.getBoundsOfArc(q,l,c[1],c[2],c[3],c[4],c[5],c[6],c[7]);q=c[6];l=c[7];break;case "z":case "Z":q=e,l=h}f=c;t.forEach(function(b){a.push(b.x);d.push(b.y)});a.push(q);d.push(l)}c=k(a);f=k(d);e=g(a);h=g(d);return{left:c,top:f,width:e-c,height:h-f}}}),b.Path.fromObject=function(a,d){"string"===typeof a.path?b.loadSVGFromURL(a.path,function(c){c=c[0];var f=a.path;delete a.path;
b.util.object.extend(c,a);c.setSourcePath(f);d(c)}):d(new b.Path(a.path,a))},b.Path.ATTRIBUTE_NAMES=b.SHARED_ATTRIBUTES.concat(["d"]),b.Path.fromElement=function(a,d,f){a=b.parseAttributes(a,b.Path.ATTRIBUTE_NAMES);d&&d(new b.Path(a.d,c(a,f)))},b.Path.async=!0)})("undefined"!==typeof b?b:this);(function(a){var b=a.fabric||(a.fabric={}),k=b.util.object.extend,g=b.util.array.invoke,c=b.Object.prototype.toObject;b.PathGroup?b.warn("fabric.PathGroup is already defined"):(b.PathGroup=b.util.createClass(b.Path,
{type:"path-group",fill:"",initialize:function(a,b){b=b||{};this.paths=a||[];for(a=this.paths.length;a--;)this.paths[a].group=this;b.toBeParsed&&(this.parseDimensionsFromPaths(b),delete b.toBeParsed);this.setOptions(b);this.setCoords();b.sourcePath&&this.setSourcePath(b.sourcePath)},parseDimensionsFromPaths:function(a){for(var c,d,e=[],g=[],h,k=this.transformMatrix,l=this.paths.length;l--;)for(c=this.paths[l],d=c.height+c.strokeWidth,h=c.width+c.strokeWidth,c=[{x:c.left,y:c.top},{x:c.left+h,y:c.top},
{x:c.left,y:c.top+d},{x:c.left+h,y:c.top+d}],h=0;h<c.length;h++)d=c[h],k&&(d=b.util.transformPoint(d,k,!1)),e.push(d.x),g.push(d.y);a.width=Math.max.apply(null,e);a.height=Math.max.apply(null,g)},render:function(a){if(this.visible){a.save();this.transformMatrix&&a.transform.apply(a,this.transformMatrix);this.transform(a);this._setShadow(a);this.clipTo&&b.util.clipContext(this,a);a.translate(-this.width/2,-this.height/2);for(var c=0,d=this.paths.length;c<d;++c)this.paths[c].render(a,!0);this.clipTo&&
a.restore();this._removeShadow(a);a.restore()}},_set:function(a,b){if("fill"===a&&b&&this.isSameColor())for(var d=this.paths.length;d--;)this.paths[d]._set(a,b);return this.callSuper("_set",a,b)},toObject:function(a){a=k(c.call(this,a),{paths:g(this.getObjects(),"toObject",a)});this.sourcePath&&(a.sourcePath=this.sourcePath);return a},toDatalessObject:function(a){a=this.toObject(a);this.sourcePath&&(a.paths=this.sourcePath);return a},toSVG:function(a){var b=this.getObjects(),d=this.getPointByOrigin("left",
"top");d="translate("+d.x+" "+d.y+")";d=["<g ",'style="',this.getSvgStyles(),'" ','transform="',this.getSvgTransformMatrix(),d,this.getSvgTransform(),'" ',">\n"];for(var c=0,e=b.length;c<e;c++)d.push(b[c].toSVG(a));d.push("</g>\n");return a?a(d.join("")):d.join("")},toString:function(){return"#<fabric.PathGroup ("+this.complexity()+"): { top: "+this.top+", left: "+this.left+" }>"},isSameColor:function(){var a=(this.getObjects()[0].get("fill")||"").toLowerCase();return this.getObjects().every(function(b){return(b.get("fill")||
"").toLowerCase()===a})},complexity:function(){return this.paths.reduce(function(a,b){return a+(b&&b.complexity?b.complexity():0)},0)},getObjects:function(){return this.paths}}),b.PathGroup.fromObject=function(a,c){"string"===typeof a.paths?b.loadSVGFromURL(a.paths,function(d){var f=a.paths;delete a.paths;d=b.util.groupSVGElements(d,a,f);c(d)}):b.util.enlivenObjects(a.paths,function(d){delete a.paths;c(new b.PathGroup(d,a))})},b.PathGroup.async=!0)})("undefined"!==typeof b?b:this);(function(a){var b=
a.fabric||(a.fabric={}),k=b.util.object.extend,g=b.util.array.min,c=b.util.array.max,e=b.util.array.invoke;if(!b.Group){var f={lockMovementX:!0,lockMovementY:!0,lockRotation:!0,lockScalingX:!0,lockScalingY:!0,lockUniScaling:!0};b.Group=b.util.createClass(b.Object,b.Collection,{type:"group",initialize:function(a,b){b=b||{};this._objects=a||[];for(a=this._objects.length;a--;)this._objects[a].group=this;this.originalState={};this.callSuper("initialize");b.originX&&(this.originX=b.originX);b.originY&&
(this.originY=b.originY);this._calcBounds();this._updateObjectsCoords();this.callSuper("initialize",b);this.setCoords();this.saveCoords()},_updateObjectsCoords:function(){this.forEachObject(this._updateObjectCoords,this)},_updateObjectCoords:function(a){var b=a.getLeft(),d=a.getTop(),c=this.getCenterPoint();a.set({originalLeft:b,originalTop:d,left:b-c.x,top:d-c.y});a.setCoords();a.__origHasControls=a.hasControls;a.hasControls=!1},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},
addWithUpdate:function(a){this._restoreObjectsState();a&&(this._objects.push(a),a.group=this);this.forEachObject(this._setObjectActive,this);this._calcBounds();this._updateObjectsCoords();return this},_setObjectActive:function(a){a.set("active",!0);a.group=this},removeWithUpdate:function(a){this._moveFlippedObject(a);this._restoreObjectsState();this.forEachObject(this._setObjectActive,this);this.remove(a);this._calcBounds();this._updateObjectsCoords();return this},_onObjectAdded:function(a){a.group=
this},_onObjectRemoved:function(a){delete a.group;a.set("active",!1)},delegatedProperties:{fill:!0,opacity:!0,fontFamily:!0,fontWeight:!0,fontSize:!0,fontStyle:!0,lineHeight:!0,textDecoration:!0,textAlign:!0,backgroundColor:!0},_set:function(a,b){if(a in this.delegatedProperties)for(var d=this._objects.length;d--;)this._objects[d].set(a,b);this.callSuper("_set",a,b)},toObject:function(a){return k(this.callSuper("toObject",a),{objects:e(this._objects,"toObject",a)})},render:function(a){if(this.visible){a.save();
this.clipTo&&b.util.clipContext(this,a);this.transform(a);for(var d=0,c=this._objects.length;d<c;d++)this._renderObject(this._objects[d],a);this.clipTo&&a.restore();a.restore()}},_renderControls:function(a,b){this.callSuper("_renderControls",a,b);b=0;for(var d=this._objects.length;b<d;b++)this._objects[b]._renderControls(a)},_renderObject:function(a,b){var d=a.hasRotatingPoint;a.visible&&(a.hasRotatingPoint=!1,a.render(b),a.hasRotatingPoint=d)},_restoreObjectsState:function(){this._objects.forEach(this._restoreObjectState,
this);return this},realizeTransform:function(a){this._moveFlippedObject(a);this._setObjectPosition(a);return a},_moveFlippedObject:function(a){var b=a.get("originX"),d=a.get("originY"),c=a.getCenterPoint();a.set({originX:"center",originY:"center",left:c.x,top:c.y});this._toggleFlipping(a);c=a.getPointByOrigin(b,d);a.set({originX:b,originY:d,left:c.x,top:c.y});return this},_toggleFlipping:function(a){this.flipX&&(a.toggle("flipX"),a.set("left",-a.get("left")),a.setAngle(-a.getAngle()));this.flipY&&
(a.toggle("flipY"),a.set("top",-a.get("top")),a.setAngle(-a.getAngle()))},_restoreObjectState:function(a){this._setObjectPosition(a);a.setCoords();a.hasControls=a.__origHasControls;delete a.__origHasControls;a.set("active",!1);a.setCoords();delete a.group;return this},_setObjectPosition:function(a){var b=this.getCenterPoint(),d=this._getRotatedLeftTop(a);a.set({angle:a.getAngle()+this.getAngle(),left:b.x+d.left,top:b.y+d.top,scaleX:a.get("scaleX")*this.get("scaleX"),scaleY:a.get("scaleY")*this.get("scaleY")})},
_getRotatedLeftTop:function(a){var b=this.getAngle()*(Math.PI/180);return{left:-Math.sin(b)*a.getTop()*this.get("scaleY")+Math.cos(b)*a.getLeft()*this.get("scaleX"),top:Math.cos(b)*a.getTop()*this.get("scaleY")+Math.sin(b)*a.getLeft()*this.get("scaleX")}},destroy:function(){this._objects.forEach(this._moveFlippedObject,this);return this._restoreObjectsState()},saveCoords:function(){this._originalLeft=this.get("left");this._originalTop=this.get("top");return this},hasMoved:function(){return this._originalLeft!==
this.get("left")||this._originalTop!==this.get("top")},setObjectsCoords:function(){this.forEachObject(function(a){a.setCoords()});return this},_calcBounds:function(a){for(var b=[],d=[],c,f,e=["tr","br","bl","tl"],g=0,h=this._objects.length;g<h;++g){c=this._objects[g];c.setCoords();for(var k=0;k<e.length;k++)f=e[k],b.push(c.oCoords[f].x),d.push(c.oCoords[f].y)}this.set(this._getBounds(b,d,a))},_getBounds:function(a,f,e){var d=b.util.invertTransform(this.getViewportTransform()),k=b.util.transformPoint(new b.Point(g(a),
g(f)),d);a=b.util.transformPoint(new b.Point(c(a),c(f)),d);a={width:a.x-k.x||0,height:a.y-k.y||0};e||(a.left=k.x||0,a.top=k.y||0,"center"===this.originX&&(a.left+=a.width/2),"right"===this.originX&&(a.left+=a.width),"center"===this.originY&&(a.top+=a.height/2),"bottom"===this.originY&&(a.top+=a.height));return a},toSVG:function(a){for(var b=["<g ",'transform="',this.getSvgTransform(),'">\n'],d=0,c=this._objects.length;d<c;d++)b.push(this._objects[d].toSVG(a));b.push("</g>\n");return a?a(b.join("")):
b.join("")},get:function(a){if(a in f){if(this[a])return this[a];for(var b=0,d=this._objects.length;b<d;b++)if(this._objects[b][a])return!0;return!1}return a in this.delegatedProperties?this._objects[0]&&this._objects[0].get(a):this[a]}});b.Group.fromObject=function(a,c){b.util.enlivenObjects(a.objects,function(d){delete a.objects;c&&c(new b.Group(d,a))})};b.Group.async=!0}})("undefined"!==typeof b?b:this);(function(b){var h=a.util.object.extend;b.fabric||(b.fabric={});b.fabric.Image?a.warn("fabric.Image is already defined."):
(a.Image=a.util.createClass(a.Object,{type:"image",crossOrigin:"",alignX:"none",alignY:"none",meetOrSlice:"meet",_lastScaleX:1,_lastScaleY:1,initialize:function(a,b){b||(b={});this.filters=[];this.resizeFilters=[];this.callSuper("initialize",b);this._initElement(a,b);this._initConfig(b);b.filters&&(this.filters=b.filters,this.applyFilters())},getElement:function(){return this._element},setElement:function(a,b,c){this._originalElement=this._element=a;this._initConfig(c);0!==this.filters.length?this.applyFilters(b):
b&&b();return this},setCrossOrigin:function(a){this.crossOrigin=a;this._element.crossOrigin=a;return this},getOriginalSize:function(){var a=this.getElement();return{width:a.width,height:a.height}},_stroke:function(a){a.save();this._setStrokeStyles(a);a.beginPath();a.strokeRect(-this.width/2,-this.height/2,this.width,this.height);a.closePath();a.restore()},_renderDashedStroke:function(b){var g=-this.width/2,c=-this.height/2,e=this.width,f=this.height;b.save();this._setStrokeStyles(b);b.beginPath();
a.util.drawDashedLine(b,g,c,g+e,c,this.strokeDashArray);a.util.drawDashedLine(b,g+e,c,g+e,c+f,this.strokeDashArray);a.util.drawDashedLine(b,g+e,c+f,g,c+f,this.strokeDashArray);a.util.drawDashedLine(b,g,c+f,g,c,this.strokeDashArray);b.closePath();b.restore()},toObject:function(a){return h(this.callSuper("toObject",a),{src:this._originalElement.src||this._originalElement._src,filters:this.filters.map(function(a){return a&&a.toObject()}),crossOrigin:this.crossOrigin,alignX:this.alignX,alignY:this.alignY,
meetOrSlice:this.meetOrSlice})},toSVG:function(a){var b=[],c=-this.width/2,e=-this.height/2,f="none";this.group&&"path-group"===this.group.type&&(c=this.left,e=this.top);"none"!==this.alignX&&"none"!==this.alignY&&(f="x"+this.alignX+"Y"+this.alignY+" "+this.meetOrSlice);b.push('<g transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'">\n','<image xlink:href="',this.getSvgSrc(),'" x="',c,'" y="',e,'" style="',this.getSvgStyles(),'" width="',this.width,'" height="',this.height,'" preserveAspectRatio="',
f,'"',"></image>\n");if(this.stroke||this.strokeDashArray)f=this.fill,this.fill=null,b.push("<rect ",'x="',c,'" y="',e,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'"/>\n'),this.fill=f;b.push("</g>\n");return a?a(b.join("")):b.join("")},getSrc:function(){if(this.getElement())return this.getElement().src||this.getElement()._src},setSrc:function(b,g,c){a.util.loadImage(b,function(a){return this.setElement(a,g,c)},this,c&&c.crossOrigin)},toString:function(){return'#<fabric.Image: { src: "'+
this.getSrc()+'" }>'},clone:function(a,b){this.constructor.fromObject(this.toObject(b),a)},applyFilters:function(b,g,c,e){g=g||this.filters;if(c=c||this._originalElement){var f=c,d=a.util.createCanvasElement(),h=a.util.createImage(),k=this;d.width=f.width;d.height=f.height;d.getContext("2d").drawImage(f,0,0,f.width,f.height);if(0===g.length)return this._element=c,b&&b(),d;g.forEach(function(a){a&&a.applyTo(d,a.scaleX||k.scaleX,a.scaleY||k.scaleY);!e&&a&&"Resize"===a.type&&(k.width*=a.scaleX,k.height*=
a.scaleY)});h.width=d.width;h.height=d.height;a.isLikelyNode?(h.src=d.toBuffer(void 0,a.Image.pngCompression),k._element=h,!e&&(k._filteredEl=h),b&&b()):(h.onload=function(){k._element=h;!e&&(k._filteredEl=h);b&&b();h.onload=d=f=null},h.src=d.toDataURL("image/png"));return d}},_render:function(a,b){var c=this._findMargins();var e=b?this.left:-this.width/2;b=b?this.top:-this.height/2;"slice"===this.meetOrSlice&&(a.beginPath(),a.rect(e,b,this.width,this.height),a.clip());if(!1===this.isMoving&&this.resizeFilters.length&&
this._needsResize()){this._lastScaleX=this.scaleX;this._lastScaleY=this.scaleY;var f=this.applyFilters(null,this.resizeFilters,this._filteredEl||this._originalElement,!0)}else f=this._element;f&&a.drawImage(f,e+c.marginX,b+c.marginY,c.width,c.height);this._renderStroke(a)},_needsResize:function(){return this.scaleX!==this._lastScaleX||this.scaleY!==this._lastScaleY},_findMargins:function(){var a=this.width,b=this.height,c=0,e=0;if("none"!==this.alignX||"none"!==this.alignY)a=[this.width/this._element.width,
this.height/this._element.height],b="meet"===this.meetOrSlice?Math.min.apply(null,a):Math.max.apply(null,a),a=this._element.width*b,b*=this._element.height,"Mid"===this.alignX&&(c=(this.width-a)/2),"Max"===this.alignX&&(c=this.width-a),"Mid"===this.alignY&&(e=(this.height-b)/2),"Max"===this.alignY&&(e=this.height-b);return{width:a,height:b,marginX:c,marginY:e}},_resetWidthHeight:function(){var a=this.getElement();this.set("width",a.width);this.set("height",a.height)},_initElement:function(b){this.setElement(a.util.getById(b));
a.util.addClass(this.getElement(),a.Image.CSS_CANVAS)},_initConfig:function(a){a||(a={});this.setOptions(a);this._setWidthHeight(a);this._element&&this.crossOrigin&&(this._element.crossOrigin=this.crossOrigin)},_initFilters:function(b,g){b.filters&&b.filters.length?a.util.enlivenObjects(b.filters,function(a){g&&g(a)},"fabric.Image.filters"):g&&g()},_setWidthHeight:function(a){this.width="width"in a?a.width:this.getElement()?this.getElement().width||0:0;this.height="height"in a?a.height:this.getElement()?
this.getElement().height||0:0},complexity:function(){return 1}}),a.Image.CSS_CANVAS="canvas-img",a.Image.prototype.getSvgSrc=a.Image.prototype.getSrc,a.Image.fromObject=function(b,g){a.util.loadImage(b.src,function(c){a.Image.prototype._initFilters.call(b,b,function(e){b.filters=e||[];e=new a.Image(c,b);g&&g(e)})},null,b.crossOrigin)},a.Image.fromURL=function(b,g,c){a.util.loadImage(b,function(b){g&&g(new a.Image(b,c))},null,c&&c.crossOrigin)},a.Image.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href".split(" ")),
a.Image.fromElement=function(b,g,c){b=a.parseAttributes(b,a.Image.ATTRIBUTE_NAMES);var e="xMidYMid",f="meet",d;b.preserveAspectRatio&&(d=b.preserveAspectRatio.split(" "));d&&d.length&&(f=d.pop(),"meet"!==f&&"slice"!==f?(e=f,f="meet"):d.length&&(e=d.pop()));d="none"!==e?e.slice(1,4):"none";e="none"!==e?e.slice(5,8):"none";b.alignX=d;b.alignY=e;b.meetOrSlice=f;a.Image.fromURL(b["xlink:href"],g,h(c?a.util.object.clone(c):{},b))},a.Image.async=!0,a.Image.pngCompression=1)})("undefined"!==typeof b?b:this);
(function(a){var b=a.fabric||(a.fabric={}),k=b.util.object.extend,g=b.util.object.clone,c=b.util.toFixed,e=b.StaticCanvas.supports("setLineDash");b.Text?b.warn("fabric.Text is already defined"):(a=b.Object.prototype.stateProperties.concat(),a.push("fontFamily","fontWeight","fontSize","text","textDecoration","textAlign","fontStyle","lineHeight","textBackgroundColor"),b.Text=b.util.createClass(b.Object,{_dimensionAffectingProps:{fontSize:!0,fontWeight:!0,fontFamily:!0,fontStyle:!0,lineHeight:!0,stroke:!0,
strokeWidth:!0,text:!0,textAlign:!0},_reNewline:/\r?\n/,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",textDecoration:"",textAlign:"left",fontStyle:"",lineHeight:1.16,textBackgroundColor:"",stateProperties:a,stroke:null,shadow:null,_fontSizeFraction:.25,_fontSizeMult:1.13,initialize:function(a,b){b=b||{};this.text=a;this.__skipDimension=!0;this.setOptions(b);this.__skipDimension=!1;this._initDimensions()},_initDimensions:function(a){if(!this.__skipDimension){a||(a=b.util.createCanvasElement().getContext("2d"),
this._setTextStyles(a));this._textLines=this.text.split(this._reNewline);this._clearCache();var d=this.textAlign;this.textAlign="left";this.width=this._getTextWidth(a);this.textAlign=d;this.height=this._getTextHeight(a)}},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_render:function(a){this.clipTo&&b.util.clipContext(this,a);this._renderTextBackground(a);this._renderText(a);this._renderTextDecoration(a);this.clipTo&&
a.restore()},_renderText:function(a){a.save();this._translateForTextAlign(a);this._setOpacity(a);this._setShadow(a);this._setupCompositeOperation(a);this._renderTextFill(a);this._renderTextStroke(a);this._restoreCompositeOperation(a);this._removeShadow(a);a.restore()},_translateForTextAlign:function(a){"left"!==this.textAlign&&"justify"!==this.textAlign&&a.translate("center"===this.textAlign?this.width/2:this.width,0)},_setTextStyles:function(a){a.textBaseline="alphabetic";this.skipTextAlign||(a.textAlign=
this.textAlign);a.font=this._getFontDeclaration()},_getTextHeight:function(){return this._textLines.length*this._getHeightOfLine()},_getTextWidth:function(a){for(var b=this._getLineWidth(a,0),c=1,f=this._textLines.length;c<f;c++){var e=this._getLineWidth(a,c);e>b&&(b=e)}return b},_renderChars:function(a,b,c,e,g){b[a](c,e,g)},_renderTextLine:function(a,b,c,e,g,h){g-=this.fontSize*this._fontSizeFraction;if("justify"!==this.textAlign)this._renderChars(a,b,c,e,g,h);else{var d=this._getLineWidth(b,h),
f=this.width;if(f>=d){d=c.split(/\s+/);c=this._getWidthOfWords(b,c,h);f=(f-c)/(d.length-1);for(var k=c=0,q=d.length;k<q;k++)this._renderChars(a,b,d[k],e+c,g,h),c+=b.measureText(d[k]).width+f}else this._renderChars(a,b,c,e,g,h)}},_getWidthOfWords:function(a,b){return a.measureText(b.replace(/\s+/g,"")).width},_getLeftOffset:function(){return-this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextFill:function(a){if(this.fill||this._skipFillStrokeCheck){for(var b=0,c=0,f=this._textLines.length;c<
f;c++){var e=this._getHeightOfLine(a,c),g=e/this.lineHeight;this._renderTextLine("fillText",a,this._textLines[c],this._getLeftOffset(),this._getTopOffset()+b+g,c);b+=e}this.shadow&&!this.shadow.affectStroke&&this._removeShadow(a)}},_renderTextStroke:function(a){if(this.stroke&&0!==this.strokeWidth||this._skipFillStrokeCheck){var b=0;a.save();this.strokeDashArray&&(1&this.strokeDashArray.length&&this.strokeDashArray.push.apply(this.strokeDashArray,this.strokeDashArray),e&&a.setLineDash(this.strokeDashArray));
a.beginPath();for(var c=0,f=this._textLines.length;c<f;c++){var g=this._getHeightOfLine(a,c),h=g/this.lineHeight;this._renderTextLine("strokeText",a,this._textLines[c],this._getLeftOffset(),this._getTopOffset()+b+h,c);b+=g}a.closePath();a.restore()}},_getHeightOfLine:function(){return this.fontSize*this._fontSizeMult*this.lineHeight},_renderTextBackground:function(a){this._renderTextBoxBackground(a);this._renderTextLinesBackground(a)},_renderTextBoxBackground:function(a){this.backgroundColor&&(a.save(),
a.fillStyle=this.backgroundColor,a.fillRect(this._getLeftOffset(),this._getTopOffset(),this.width,this.height),a.restore())},_renderTextLinesBackground:function(a){var b=0,c=this._getHeightOfLine();if(this.textBackgroundColor){a.save();a.fillStyle=this.textBackgroundColor;for(var f=0,e=this._textLines.length;f<e;f++){if(""!==this._textLines[f]){var g=this._getLineWidth(a,f),h=this._getLineLeftOffset(g);a.fillRect(this._getLeftOffset()+h,this._getTopOffset()+b,g,this.fontSize*this._fontSizeMult)}b+=
c}a.restore()}},_getLineLeftOffset:function(a){return"center"===this.textAlign?(this.width-a)/2:"right"===this.textAlign?this.width-a:0},_clearCache:function(){this.__lineWidths=[];this.__lineHeights=[];this.__lineOffsets=[]},_shouldClearCache:function(){var a=!1,b;for(b in this._dimensionAffectingProps)this["__"+b]!==this[b]&&(this["__"+b]=this[b],a=!0);return a},_getLineWidth:function(a,b){if(this.__lineWidths[b])return this.__lineWidths[b];this.__lineWidths[b]=a.measureText(this._textLines[b]).width;
return this.__lineWidths[b]},_renderTextDecoration:function(a){if(this.textDecoration){var b=this.height/2,c=[];-1<this.textDecoration.indexOf("underline")&&c.push(.85);-1<this.textDecoration.indexOf("line-through")&&c.push(.43);-1<this.textDecoration.indexOf("overline")&&c.push(-.12);if(0<c.length){var f=0,e,g;var h=0;for(e=this._textLines.length;h<e;h++){var k=this._getLineWidth(a,h),l=this._getLineLeftOffset(k),m=this._getHeightOfLine(a,h);var n=0;for(g=c.length;n<g;n++)a.fillRect(this._getLeftOffset()+
l,f+(this._fontSizeMult-1+c[n])*this.fontSize-b,k,this.fontSize/15);f+=m}}}},_getFontDeclaration:function(){return[b.isLikelyNode?this.fontWeight:this.fontStyle,b.isLikelyNode?this.fontStyle:this.fontWeight,this.fontSize+"px",b.isLikelyNode?'"'+this.fontFamily+'"':this.fontFamily].join(" ")},render:function(a,b){this.visible&&(a.save(),this._setTextStyles(a),this._shouldClearCache()&&this._initDimensions(a),b||this.transform(a),this._setStrokeStyles(a),this._setFillStyles(a),this.transformMatrix&&
a.transform.apply(a,this.transformMatrix),this.group&&"path-group"===this.group.type&&a.translate(this.left,this.top),this._render(a),a.restore())},toObject:function(a){a=k(this.callSuper("toObject",a),{text:this.text,fontSize:this.fontSize,fontWeight:this.fontWeight,fontFamily:this.fontFamily,fontStyle:this.fontStyle,lineHeight:this.lineHeight,textDecoration:this.textDecoration,textAlign:this.textAlign,textBackgroundColor:this.textBackgroundColor});this.includeDefaultValues||this._removeDefaultValues(a);
return a},toSVG:function(a){var b=this._createBaseSVGMarkup(),c=this._getSVGLeftTopOffsets(this.ctx);c=this._getSVGTextAndBg(c.textTop,c.textLeft);this._wrapSVGTextAndBg(b,c);return a?a(b.join("")):b.join("")},_getSVGLeftTopOffsets:function(a){a=this._getHeightOfLine(a,0);return{textLeft:-this.width/2+(this.group&&"path-group"===this.group.type?this.left:0),textTop:0+(this.group&&"path-group"===this.group.type?-this.top:0),lineTop:a}},_wrapSVGTextAndBg:function(a,b){a.push('\t<g transform="',this.getSvgTransform(),
this.getSvgTransformMatrix(),'">\n',b.textBgRects.join(""),"\t\t<text ",this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",this.textDecoration?'text-decoration="'+this.textDecoration+'" ':"",'style="',this.getSvgStyles(),'" >',b.textSpans.join(""),"</text>\n","\t</g>\n")},_getSVGTextAndBg:function(a,b){var c=[],d=[],f=
0;this._setSVGBg(d);for(var e=0,g=this._textLines.length;e<g;e++)this.textBackgroundColor&&this._setSVGTextLineBg(d,e,b,a,f),this._setSVGTextLineText(e,c,f,b,a,d),f+=this._getHeightOfLine(this.ctx,e);return{textSpans:c,textBgRects:d}},_setSVGTextLineText:function(a,d,e,g,h){e=this.fontSize*(this._fontSizeMult-this._fontSizeFraction)-h+e-this.height/2;d.push('<tspan x="',c(g+this._getLineLeftOffset(this.__lineWidths[a]),4),'" ','y="',c(e,4),'" ',this._getFillAttributes(this.fill),">",b.util.string.escapeXml(this._textLines[a]),
"</tspan>")},_setSVGTextLineBg:function(a,b,e,g,h){a.push("\t\t<rect ",this._getFillAttributes(this.textBackgroundColor),' x="',c(e+this._getLineLeftOffset(this.__lineWidths[b]),4),'" y="',c(h-this.height/2,4),'" width="',c(this.__lineWidths[b],4),'" height="',c(this._getHeightOfLine(this.ctx,b)/this.lineHeight,4),'"></rect>\n')},_setSVGBg:function(a){this.backgroundColor&&a.push("\t\t<rect ",this._getFillAttributes(this.backgroundColor),' x="',c(-this.width/2,4),'" y="',c(-this.height/2,4),'" width="',
c(this.width,4),'" height="',c(this.height,4),'"></rect>\n')},_getFillAttributes:function(a){var c=a&&"string"===typeof a?new b.Color(a):"";return c&&c.getSource()&&1!==c.getAlpha()?'opacity="'+c.getAlpha()+'" fill="'+c.setAlpha(1).toRgb()+'"':'fill="'+a+'"'},_set:function(a,b){this.callSuper("_set",a,b);a in this._dimensionAffectingProps&&(this._initDimensions(),this.setCoords())},complexity:function(){return 1}}),b.Text.ATTRIBUTE_NAMES=b.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size text-decoration text-anchor".split(" ")),
b.Text.DEFAULT_SVG_FONT_SIZE=16,b.Text.fromElement=function(a,c){if(!a)return null;var d=b.parseAttributes(a,b.Text.ATTRIBUTE_NAMES);c=b.util.object.extend(c?b.util.object.clone(c):{},d);c.top=c.top||0;c.left=c.left||0;"dx"in d&&(c.left+=d.dx);"dy"in d&&(c.top+=d.dy);"fontSize"in c||(c.fontSize=b.Text.DEFAULT_SVG_FONT_SIZE);c.originX||(c.originX="left");a=a.textContent.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");c=new b.Text(a,c);a=0;"left"===c.originX&&(a=c.getWidth()/2);"right"===c.originX&&
(a=-c.getWidth()/2);c.set({left:c.getLeft()+a,top:c.getTop()-c.getHeight()/2+c.fontSize*(.18+c._fontSizeFraction)});return c},b.Text.fromObject=function(a){return new b.Text(a.text,g(a))},b.util.createAccessors(b.Text))})("undefined"!==typeof b?b:this);delete window.fabric;return b}().fabric;b.__name__="com.fabricjs";b.fabric=a}}});(function(){var b=aa(n.com.fabricjs).fabric,a=B([13,27,32]),l=a[0],m=a[1],p=a[2];window.onkeydown=function(a){return a.keyCode!=p};var h=A("Attribute",[P],{__module__:"__main__",
get __init__(){return t(this,function(a,b){a.game=b;a.game.attributes.append(a);a.install();a.reset()})},get reset(){return t(this,function(a){a.commit()})},get predict(){return t(this,function(a){})},get interact(){return t(this,function(a){})},get commit(){return t(this,function(a){})}}),k=A("Sprite",[h],{__module__:"__main__",get __init__(){return t(this,function(a,b,c,e){a.width=c;a.height=e;h.__init__(a,b)})},get install(){return t(this,function(a){a.image=new b.Rect(E({width:a.game.scaleX(a.width),
height:a.game.scaleY(a.height),originX:"center",originY:"center",fill:"white"}))})},get reset(){return t(this,function(a,b,c,e,f){if("undefined"==typeof b||null!=b&&b.hasOwnProperty("__kwargtrans__"))b=0;if("undefined"==typeof c||null!=c&&c.hasOwnProperty("__kwargtrans__"))c=0;if("undefined"==typeof e||null!=e&&e.hasOwnProperty("__kwargtrans__"))e=0;if("undefined"==typeof f||null!=f&&f.hasOwnProperty("__kwargtrans__"))f=0;if(arguments.length){var d=arguments.length-1;if(arguments[d]&&arguments[d].hasOwnProperty("__kwargtrans__")){d=
arguments[d--];for(var g in d)switch(g){case "self":a=d[g];break;case "vX":b=d[g];break;case "vY":c=d[g];break;case "x":e=d[g];break;case "y":f=d[g]}}}a.vX=b;a.vY=c;a.x=e;a.y=f;h.reset(a)})},get predict(){return t(this,function(a){a.x+=a.vX*a.game.deltaT;a.y+=a.vY*a.game.deltaT})},get commit(){return t(this,function(a){a.image.left=a.game.orthoX(a.x);a.image.top=a.game.orthoY(a.y)})},get draw(){return t(this,function(a){a.game.canvas.add(a.image)})}}),g=A("Paddle",[k],{__module__:"__main__",margin:30,
width:10,height:100,speed:400,get __init__(){return t(this,function(a,b,c){a.index=c;k.__init__(a,b,a.width,a.height)})},get reset(){return t(this,function(a){k.reset(a,I({x:a.index?Math.floor(500)-a.margin:Math.floor(-500)+a.margin,y:0}))})},get predict(){return t(this,function(a){a.vY=0;a.index?a.game.keyCode==U("K")?a.vY=a.speed:a.game.keyCode==U("M")&&(a.vY=-a.speed):a.game.keyCode==U("A")?a.vY=a.speed:a.game.keyCode==U("Z")&&(a.vY=-a.speed);k.predict(a)})},get interact(){return t(this,function(a){a.y=
Math.max(Math.floor(a.height/2)-Math.floor(325),Math.min(a.y,Math.floor(325)-Math.floor(a.height/2)));a.y-Math.floor(a.height/2)<a.game.ball.y&&a.game.ball.y<a.y+Math.floor(a.height/2)&&(0==a.index&&a.game.ball.x<a.x||1==a.index&&a.game.ball.x>a.x)&&(a.game.ball.x=a.x,a.game.ball.vX=-a.game.ball.vX,a.game.ball.speedUp(a))})}}),c=A("Ball",[k],{__module__:"__main__",side:8,speed:300,get __init__(){return t(this,function(a,b){k.__init__(a,b,a.side,a.side)})},get reset(){return t(this,function(a){var b=
a.game.serviceIndex*Math.PI+(.5<Math.random()?1:-1)*Math.random()*Math.atan(.65);k.reset(a,I({vX:a.speed*Math.cos(b),vY:a.speed*Math.sin(b)}))})},get predict(){return t(this,function(a){k.predict(a);a.x<Math.floor(-500)?a.game.scored(1):a.x>Math.floor(500)&&a.game.scored(0);a.y>Math.floor(325)?(a.y=Math.floor(325),a.vY=-a.vY):a.y<Math.floor(-325)&&(a.y=Math.floor(-325),a.vY=-a.vY)})},get speedUp(){return t(this,function(a,b){b=1+.15*Math.pow(1-Math.abs(a.y-b.y)/Math.floor(b.height/2),2);Math.abs(a.vX)<
3*a.speed&&(a.vX*=b,a.vY*=b)})}}),e=A("Scoreboard",[h],{__module__:"__main__",nameShift:75,hintShift:25,get install(){return t(this,function(a){for(var c=[],d=$jscomp.makeIterator(B([B(["AZ keys:",-.4375]),B(["KM keys:",.0625])])),e=d.next();!e.done;e=d.next()){var f=$jscomp.makeIterator(e.value);e=f.next().value;f=f.next().value;c.append(new b.Text("Player {}".format(e),E({fill:"white",fontFamily:"arial",fontSize:"{}".format(a.game.canvas.width/30),left:a.game.orthoX(1E3*f),top:a.game.orthoY(Math.floor(325)+
a.nameShift)})))}a.playerLabels=c;a.hintLabel=new b.Text("[spacebar] starts game, [enter] resets score",E({fill:"white",fontFamily:"arial",fontSize:"{}".format(a.game.canvas.width/70),left:a.game.orthoX(-437.5),top:a.game.orthoY(Math.floor(325)+a.hintShift)}));a.image=new b.Line(C([a.game.orthoX(Math.floor(-500)),a.game.orthoY(Math.floor(325)),a.game.orthoX(Math.floor(500)),a.game.orthoY(Math.floor(325))]),E({stroke:"white"}))})},get increment(){return t(this,function(a,b){a.scores[b]++})},get reset(){return t(this,
function(a){a.scores=C([0,0]);h.reset(a)})},get commit(){return t(this,function(a){for(var c=[],d=$jscomp.makeIterator(da(a.scores,B([-.125,.375]))),e=d.next();!e.done;e=d.next()){var f=$jscomp.makeIterator(e.value);e=f.next().value;f=f.next().value;c.append(new b.Text("{}".format(e),E({fill:"white",fontFamily:"arial",fontSize:"{}".format(a.game.canvas.width/30),left:a.game.orthoX(1E3*f),top:a.game.orthoY(Math.floor(325)+a.nameShift)})))}a.scoreLabels=c})},get draw(){return t(this,function(a){for(var b=
$jscomp.makeIterator(da(a.playerLabels,a.scoreLabels)),c=b.next();!c.done;c=b.next()){var d=$jscomp.makeIterator(c.value);c=d.next().value;d=d.next().value;a.game.canvas.add(c);a.game.canvas.add(d);a.game.canvas.add(a.hintLabel)}a.game.canvas.add(a.image)})}});a=A("Game",[P],{__module__:"__main__",get __init__(){return t(this,function(a){a.serviceIndex=.5<Math.random()?1:0;a.pause=!0;a.keyCode=null;a.textFrame=document.getElementById("text_frame");a.canvasFrame=document.getElementById("canvas_frame");
a.buttonsFrame=document.getElementById("buttons_frame");a.canvas=new b.Canvas("canvas",E({backgroundColor:"black",originX:"center",originY:"center"}));a.canvas.onWindowDraw=a.draw;a.canvas.lineWidth=2;a.canvas.clear();a.attributes=C([]);a.paddles=function(){for(var b=[],c=0;2>c;c++)b.append(g(a,c));return b}();a.ball=c(a);a.scoreboard=e(a);window.setInterval(a.py_update,10);window.setInterval(a.draw,20);window.addEventListener("keydown",a.keydown);window.addEventListener("keyup",a.keyup);a.buttons=
C([]);for(var d=$jscomp.makeIterator(B("A Z K M space enter".split(" "))),f=d.next();!f.done;f=d.next()){f=f.value;var h=document.getElementById(f);h.addEventListener("mousedown",function(b){return function(){return a.mouseOrTouch(b,!0)}}(f));h.addEventListener("touchstart",function(b){return function(){return a.mouseOrTouch(b,!0)}}(f));h.addEventListener("mouseup",function(b){return function(){return a.mouseOrTouch(b,!1)}}(f));h.addEventListener("touchend",function(b){return function(){return a.mouseOrTouch(b,
!1)}}(f));h.style.cursor="pointer";h.style.userSelect="none";a.buttons.append(h)}a.time=+new Date;window.onresize=a.resize;a.resize()})},get install(){return t(this,function(a){a=$jscomp.makeIterator(a.attributes);for(var b=a.next();!b.done;b=a.next())b.value.install()})},get mouseOrTouch(){return t(this,function(a,b,c){a.keyCode=c?"space"==b?p:"enter"==b?l:U(b):null})},get py_update(){return t(this,function(a){var b=a.time;a.time=+new Date;a.deltaT=(a.time-b)/1E3;if(a.pause)a.keyCode==p?a.pause=
!1:a.keyCode==l&&a.scoreboard.reset();else{var c=$jscomp.makeIterator(a.attributes);for(b=c.next();!b.done;b=c.next())b=b.value,b.predict();c=$jscomp.makeIterator(a.attributes);for(b=c.next();!b.done;b=c.next())b=b.value,b.interact();a=$jscomp.makeIterator(a.attributes);for(b=a.next();!b.done;b=a.next())b=b.value,b.commit()}})},get scored(){return t(this,function(a,b){a.scoreboard.increment(b);a.serviceIndex=1-b;b=$jscomp.makeIterator(a.paddles);for(var c=b.next();!c.done;c=b.next())c.value.reset();
a.ball.reset();a.pause=!0})},get commit(){return t(this,function(a){a=$jscomp.makeIterator(a.attributes);for(var b=a.next();!b.done;b=a.next())b.value.commit()})},get draw(){return t(this,function(a){a.canvas.clear();a=$jscomp.makeIterator(a.attributes);for(var b=a.next();!b.done;b=a.next())b.value.draw()})},get resize(){return t(this,function(a){a.pageWidth=window.innerWidth;a.pageHeight=window.innerHeight;a.textTop=0;a.pageHeight>1.2*a.pageWidth?(a.canvasWidth=a.pageWidth,a.canvasTop=a.textTop+
300):(a.canvasWidth=.6*a.pageWidth,a.canvasTop=a.textTop+200);a.canvasLeft=.5*(a.pageWidth-a.canvasWidth);a.canvasHeight=.6*a.canvasWidth;a.buttonsTop=a.canvasTop+a.canvasHeight+50;a.buttonsWidth=500;a.textFrame.style.top=a.textTop;a.textFrame.style.left=a.canvasLeft+.05*a.canvasWidth;a.textFrame.style.width=.9*a.canvasWidth;a.canvasFrame.style.top=a.canvasTop;a.canvasFrame.style.left=a.canvasLeft;a.canvas.setDimensions(E({width:a.canvasWidth,height:a.canvasHeight}));a.buttonsFrame.style.top=a.buttonsTop;
a.buttonsFrame.style.left=.5*(a.pageWidth-a.buttonsWidth);a.buttonsFrame.style.width=a.canvasWidth;a.install();a.commit();a.draw()})},get scaleX(){return t(this,function(a,b){return a.canvas.width/1E3*b})},get scaleY(){return t(this,function(a,b){return a.canvas.height/750*b})},get orthoX(){return t(this,function(a,b){return a.scaleX(b+Math.floor(500))})},get orthoY(){return t(this,function(a,b){return a.scaleY(750-Math.floor(325)-b)})},get keydown(){return t(this,function(a,b){a.keyCode=b.keyCode})},
get keyup(){return t(this,function(a,b){a.keyCode=null})}});var f=a();n.Attribute=h;n.Ball=c;n.Game=a;n.Paddle=g;n.Scoreboard=e;n.Sprite=k;n.__name__="__main__";n.enter=l;n.esc=m;n.fabric=b;n.fieldHeight=650;n.game=f;n.orthoHeight=750;n.orthoWidth=1E3;n.space=p})();return n}window.pong=pong();

//# sourceMappingURL=extra/sourcemap/pong.min.js.map
